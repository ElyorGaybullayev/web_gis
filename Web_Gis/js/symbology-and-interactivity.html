<!DOCTYPE html>
<html lang="" xml:lang="">

<!-- Mirrored from 132.72.155.230:3838/js/symbology-and-interactivity.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jan 2022 06:37:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Symbology and Interactivity | Introduction to Web Mapping</title>
  <meta name="description" content="Chapter 8 Symbology and Interactivity | Introduction to Web Mapping" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Symbology and Interactivity | Introduction to Web Mapping" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 8 Symbology and Interactivity | Introduction to Web Mapping" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Symbology and Interactivity | Introduction to Web Mapping" />
  
  <meta name="twitter:description" content="Chapter 8 Symbology and Interactivity | Introduction to Web Mapping" />
  

<meta name="author" content="Michael Dorman" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="geojson-1.html"/>
<link rel="next" href="databases.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134641614-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134641614-1');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="index.html"><img width="90%" style="margin: 5% 5% 0% 5%" src="images/BGUsig3E.svg"></a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#what-is-web-mapping"><i class="fa fa-check"></i><b>0.1</b> What is web mapping?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#what-is-javascript"><i class="fa fa-check"></i><b>0.2</b> What is JavaScript?</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#why-use-javascript-for-web-mapping"><i class="fa fa-check"></i><b>0.3</b> Why use JavaScript for web mapping?</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>0.4</b> Learning objectives</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>0.5</b> Software</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#background-knowledge"><i class="fa fa-check"></i><b>0.6</b> Background knowledge</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#online-version"><i class="fa fa-check"></i><b>0.7</b> Online version</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>0.8</b> Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to Web Technologies</b></span></li>
<li class="chapter" data-level="1" data-path="html.html"><a href="html.html"><i class="fa fa-check"></i><b>1</b> HTML</a>
<ul>
<li class="chapter" data-level="1.1" data-path="html.html"><a href="html.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="html.html"><a href="html.html#how-do-people-access-the-web"><i class="fa fa-check"></i><b>1.2</b> How do people access the web?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="html.html"><a href="html.html#web-browsers"><i class="fa fa-check"></i><b>1.2.1</b> Web browsers</a></li>
<li class="chapter" data-level="1.2.2" data-path="html.html"><a href="html.html#web-servers"><i class="fa fa-check"></i><b>1.2.2</b> Web servers</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="html.html"><a href="html.html#web-pages"><i class="fa fa-check"></i><b>1.3</b> Web pages</a></li>
<li class="chapter" data-level="1.4" data-path="html.html"><a href="html.html#text-editors"><i class="fa fa-check"></i><b>1.4</b> Text editors</a></li>
<li class="chapter" data-level="1.5" data-path="html.html"><a href="html.html#what-is-html"><i class="fa fa-check"></i><b>1.5</b> What is HTML?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="html.html"><a href="html.html#overview-html"><i class="fa fa-check"></i><b>1.5.1</b> Overview</a></li>
<li class="chapter" data-level="1.5.2" data-path="html.html"><a href="html.html#html-comments"><i class="fa fa-check"></i><b>1.5.2</b> HTML comments</a></li>
<li class="chapter" data-level="1.5.3" data-path="html.html"><a href="html.html#block-vs-inline"><i class="fa fa-check"></i><b>1.5.3</b> Block vs. inline</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="html.html"><a href="html.html#common-html-elements"><i class="fa fa-check"></i><b>1.6</b> Common HTML elements</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="html.html"><a href="html.html#html-element-types"><i class="fa fa-check"></i><b>1.6.1</b> HTML element types</a></li>
<li class="chapter" data-level="1.6.2" data-path="html.html"><a href="html.html#html-structure"><i class="fa fa-check"></i><b>1.6.2</b> Structure</a></li>
<li class="chapter" data-level="1.6.3" data-path="html.html"><a href="html.html#title-and-metadata"><i class="fa fa-check"></i><b>1.6.3</b> Title and metadata</a></li>
<li class="chapter" data-level="1.6.4" data-path="html.html"><a href="html.html#styling-and-scripts"><i class="fa fa-check"></i><b>1.6.4</b> Styling and scripts</a></li>
<li class="chapter" data-level="1.6.5" data-path="html.html"><a href="html.html#headings-and-paragraphs"><i class="fa fa-check"></i><b>1.6.5</b> Headings and paragraphs</a></li>
<li class="chapter" data-level="1.6.6" data-path="html.html"><a href="html.html#font-formatting"><i class="fa fa-check"></i><b>1.6.6</b> Font formatting</a></li>
<li class="chapter" data-level="1.6.7" data-path="html.html"><a href="html.html#spacing"><i class="fa fa-check"></i><b>1.6.7</b> Spacing</a></li>
<li class="chapter" data-level="1.6.8" data-path="html.html"><a href="html.html#html-lists"><i class="fa fa-check"></i><b>1.6.8</b> Lists</a></li>
<li class="chapter" data-level="1.6.9" data-path="html.html"><a href="html.html#html-links"><i class="fa fa-check"></i><b>1.6.9</b> Links</a></li>
<li class="chapter" data-level="1.6.10" data-path="html.html"><a href="html.html#images"><i class="fa fa-check"></i><b>1.6.10</b> Images</a></li>
<li class="chapter" data-level="1.6.11" data-path="html.html"><a href="html.html#tables"><i class="fa fa-check"></i><b>1.6.11</b> Tables</a></li>
<li class="chapter" data-level="1.6.12" data-path="html.html"><a href="html.html#grouping"><i class="fa fa-check"></i><b>1.6.12</b> Grouping</a></li>
<li class="chapter" data-level="1.6.13" data-path="html.html"><a href="html.html#input-elements"><i class="fa fa-check"></i><b>1.6.13</b> Input elements</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="html.html"><a href="html.html#id-class-and-style-attributes"><i class="fa fa-check"></i><b>1.7</b> <code>id</code>, <code>class</code>, and <code>style</code> attributes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="html.html"><a href="html.html#overview-id-class-and-style-attributes"><i class="fa fa-check"></i><b>1.7.1</b> Overview</a></li>
<li class="chapter" data-level="1.7.2" data-path="html.html"><a href="html.html#id"><i class="fa fa-check"></i><b>1.7.2</b> <code>id</code></a></li>
<li class="chapter" data-level="1.7.3" data-path="html.html"><a href="html.html#html-class"><i class="fa fa-check"></i><b>1.7.3</b> <code>class</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="html.html"><a href="html.html#style-2"><i class="fa fa-check"></i><b>1.7.4</b> <code>style</code></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="html.html"><a href="html.html#code-layout"><i class="fa fa-check"></i><b>1.8</b> Code layout</a></li>
<li class="chapter" data-level="1.9" data-path="html.html"><a href="html.html#inspecting-elements"><i class="fa fa-check"></i><b>1.9</b> Inspecting elements</a></li>
<li class="chapter" data-level="1.10" data-path="html.html"><a href="html.html#exercise"><i class="fa fa-check"></i><b>1.10</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>2</b> CSS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="css.html"><a href="css.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="css.html"><a href="css.html#what-is-css"><i class="fa fa-check"></i><b>2.2</b> What is CSS?</a></li>
<li class="chapter" data-level="2.3" data-path="css.html"><a href="css.html#css-rules"><i class="fa fa-check"></i><b>2.3</b> CSS rules</a></li>
<li class="chapter" data-level="2.4" data-path="css.html"><a href="css.html#css-selectors"><i class="fa fa-check"></i><b>2.4</b> CSS selectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="css.html"><a href="css.html#overview-css-selectors"><i class="fa fa-check"></i><b>2.4.1</b> Overview</a></li>
<li class="chapter" data-level="2.4.2" data-path="css.html"><a href="css.html#type-selector"><i class="fa fa-check"></i><b>2.4.2</b> Type selector</a></li>
<li class="chapter" data-level="2.4.3" data-path="css.html"><a href="css.html#class-selector"><i class="fa fa-check"></i><b>2.4.3</b> Class selector</a></li>
<li class="chapter" data-level="2.4.4" data-path="css.html"><a href="css.html#id-selector"><i class="fa fa-check"></i><b>2.4.4</b> ID selector</a></li>
<li class="chapter" data-level="2.4.5" data-path="css.html"><a href="css.html#descendant-selector"><i class="fa fa-check"></i><b>2.4.5</b> Descendant selector</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="css.html"><a href="css.html#css-conflicts"><i class="fa fa-check"></i><b>2.5</b> CSS conflicts</a></li>
<li class="chapter" data-level="2.6" data-path="css.html"><a href="css.html#css-inheritance"><i class="fa fa-check"></i><b>2.6</b> CSS inheritance</a></li>
<li class="chapter" data-level="2.7" data-path="css.html"><a href="css.html#linking-css-to-html"><i class="fa fa-check"></i><b>2.7</b> Linking CSS to HTML</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="css.html"><a href="css.html#methods-for-linking-css"><i class="fa fa-check"></i><b>2.7.1</b> Methods for linking CSS</a></li>
<li class="chapter" data-level="2.7.2" data-path="css.html"><a href="css.html#inline-css"><i class="fa fa-check"></i><b>2.7.2</b> Inline CSS</a></li>
<li class="chapter" data-level="2.7.3" data-path="css.html"><a href="css.html#embedded-css"><i class="fa fa-check"></i><b>2.7.3</b> Embedded CSS</a></li>
<li class="chapter" data-level="2.7.4" data-path="css.html"><a href="css.html#external-css"><i class="fa fa-check"></i><b>2.7.4</b> External CSS</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="css.html"><a href="css.html#css-properties"><i class="fa fa-check"></i><b>2.8</b> CSS properties</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="css.html"><a href="css.html#overview-css-properties"><i class="fa fa-check"></i><b>2.8.1</b> Overview</a></li>
<li class="chapter" data-level="2.8.2" data-path="css.html"><a href="css.html#color"><i class="fa fa-check"></i><b>2.8.2</b> Color</a></li>
<li class="chapter" data-level="2.8.3" data-path="css.html"><a href="css.html#text"><i class="fa fa-check"></i><b>2.8.3</b> Text</a></li>
<li class="chapter" data-level="2.8.4" data-path="css.html"><a href="css.html#boxes"><i class="fa fa-check"></i><b>2.8.4</b> Boxes</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="css.html"><a href="css.html#hurricane-scale"><i class="fa fa-check"></i><b>2.9</b> Hurricane scale example</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="css.html"><a href="css.html#html-contents"><i class="fa fa-check"></i><b>2.9.1</b> HTML contents</a></li>
<li class="chapter" data-level="2.9.2" data-path="css.html"><a href="css.html#css-styling"><i class="fa fa-check"></i><b>2.9.2</b> CSS styling</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="css.html"><a href="css.html#example-map-description"><i class="fa fa-check"></i><b>2.10</b> Map description example</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="css.html"><a href="css.html#html-contents-1"><i class="fa fa-check"></i><b>2.10.1</b> HTML contents</a></li>
<li class="chapter" data-level="2.10.2" data-path="css.html"><a href="css.html#example-map-description-box-position"><i class="fa fa-check"></i><b>2.10.2</b> CSS styling: box position</a></li>
<li class="chapter" data-level="2.10.3" data-path="css.html"><a href="css.html#css-styling-final-touches"><i class="fa fa-check"></i><b>2.10.3</b> CSS styling: final touches</a></li>
<li class="chapter" data-level="2.10.4" data-path="css.html"><a href="css.html#adding-map-in-the-background"><i class="fa fa-check"></i><b>2.10.4</b> Adding map in the background</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="css.html"><a href="css.html#exercise-1"><i class="fa fa-check"></i><b>2.11</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="javascript-basics.html"><a href="javascript-basics.html"><i class="fa fa-check"></i><b>3</b> JavaScript Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="javascript-basics.html"><a href="javascript-basics.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="javascript-basics.html"><a href="javascript-basics.html#what-is-javascript-1"><i class="fa fa-check"></i><b>3.2</b> What is JavaScript?</a></li>
<li class="chapter" data-level="3.3" data-path="javascript-basics.html"><a href="javascript-basics.html#client-side-vs.-server-side"><i class="fa fa-check"></i><b>3.3</b> Client-side vs. server-side</a></li>
<li class="chapter" data-level="3.4" data-path="javascript-basics.html"><a href="javascript-basics.html#the-javascript-console"><i class="fa fa-check"></i><b>3.4</b> The JavaScript console</a></li>
<li class="chapter" data-level="3.5" data-path="javascript-basics.html"><a href="javascript-basics.html#assignment"><i class="fa fa-check"></i><b>3.5</b> Assignment</a></li>
<li class="chapter" data-level="3.6" data-path="javascript-basics.html"><a href="javascript-basics.html#data-types"><i class="fa fa-check"></i><b>3.6</b> Data types</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="javascript-basics.html"><a href="javascript-basics.html#overview-data-types"><i class="fa fa-check"></i><b>3.6.1</b> Overview</a></li>
<li class="chapter" data-level="3.6.2" data-path="javascript-basics.html"><a href="javascript-basics.html#primitive-data-types"><i class="fa fa-check"></i><b>3.6.2</b> Primitive data types</a></li>
<li class="chapter" data-level="3.6.3" data-path="javascript-basics.html"><a href="javascript-basics.html#objects-data-type"><i class="fa fa-check"></i><b>3.6.3</b> Objects</a></li>
<li class="chapter" data-level="3.6.4" data-path="javascript-basics.html"><a href="javascript-basics.html#checking-type-of-variables"><i class="fa fa-check"></i><b>3.6.4</b> Checking type of variables</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="javascript-basics.html"><a href="javascript-basics.html#functions"><i class="fa fa-check"></i><b>3.7</b> Functions</a></li>
<li class="chapter" data-level="3.8" data-path="javascript-basics.html"><a href="javascript-basics.html#methods"><i class="fa fa-check"></i><b>3.8</b> Methods</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="javascript-basics.html"><a href="javascript-basics.html#what-are-methods"><i class="fa fa-check"></i><b>3.8.1</b> What are methods?</a></li>
<li class="chapter" data-level="3.8.2" data-path="javascript-basics.html"><a href="javascript-basics.html#array-methods"><i class="fa fa-check"></i><b>3.8.2</b> Array methods</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="javascript-basics.html"><a href="javascript-basics.html#scope"><i class="fa fa-check"></i><b>3.9</b> Scope</a></li>
<li class="chapter" data-level="3.10" data-path="javascript-basics.html"><a href="javascript-basics.html#flow-control"><i class="fa fa-check"></i><b>3.10</b> Flow control</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="javascript-basics.html"><a href="javascript-basics.html#what-is-flow-control"><i class="fa fa-check"></i><b>3.10.1</b> What is flow control?</a></li>
<li class="chapter" data-level="3.10.2" data-path="javascript-basics.html"><a href="javascript-basics.html#conditionals"><i class="fa fa-check"></i><b>3.10.2</b> Conditionals</a></li>
<li class="chapter" data-level="3.10.3" data-path="javascript-basics.html"><a href="javascript-basics.html#loops"><i class="fa fa-check"></i><b>3.10.3</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="javascript-basics.html"><a href="javascript-basics.html#javascript-object-notation-json"><i class="fa fa-check"></i><b>3.11</b> JavaScript Object Notation (JSON)</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="javascript-basics.html"><a href="javascript-basics.html#javascript-json"><i class="fa fa-check"></i><b>3.11.1</b> JSON</a></li>
<li class="chapter" data-level="3.11.2" data-path="javascript-basics.html"><a href="javascript-basics.html#geojson"><i class="fa fa-check"></i><b>3.11.2</b> GeoJSON</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="javascript-basics.html"><a href="javascript-basics.html#exercise-2"><i class="fa fa-check"></i><b>3.12</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html"><i class="fa fa-check"></i><b>4</b> JavaScript Interactivity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#the-document-object-model"><i class="fa fa-check"></i><b>4.2</b> The Document Object Model (DOM)</a></li>
<li class="chapter" data-level="4.3" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#accessing-and-modifying-elements"><i class="fa fa-check"></i><b>4.3</b> Accessing and modifying elements</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#overview-accessing-and_modifying"><i class="fa fa-check"></i><b>4.3.1</b> Overview</a></li>
<li class="chapter" data-level="4.3.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#accessing-elements"><i class="fa fa-check"></i><b>4.3.2</b> Accessing elements</a></li>
<li class="chapter" data-level="4.3.3" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#getting-element-properties"><i class="fa fa-check"></i><b>4.3.3</b> Getting element properties</a></li>
<li class="chapter" data-level="4.3.4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#modifying-elements"><i class="fa fa-check"></i><b>4.3.4</b> Modifying elements</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-listeners"><i class="fa fa-check"></i><b>4.4</b> Event listeners</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-types"><i class="fa fa-check"></i><b>4.4.1</b> Event types</a></li>
<li class="chapter" data-level="4.4.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#binding-event-listeners"><i class="fa fa-check"></i><b>4.4.2</b> Binding event listeners</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#hello-example"><i class="fa fa-check"></i><b>4.5</b> Hello example</a></li>
<li class="chapter" data-level="4.6" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#poles-example"><i class="fa fa-check"></i><b>4.6</b> Poles example</a></li>
<li class="chapter" data-level="4.7" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#operating-on-selection"><i class="fa fa-check"></i><b>4.7</b> Operating on multiple selections</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#example-page"><i class="fa fa-check"></i><b>4.7.1</b> Example page</a></li>
<li class="chapter" data-level="4.7.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#making-multiple-selections"><i class="fa fa-check"></i><b>4.7.2</b> Making multiple selections</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#getting-and-setting-input-values"><i class="fa fa-check"></i><b>4.8</b> Getting and setting input values</a></li>
<li class="chapter" data-level="4.9" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#multiple-event-listeners"><i class="fa fa-check"></i><b>4.9</b> Multiple event listeners</a></li>
<li class="chapter" data-level="4.10" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#the-event-object"><i class="fa fa-check"></i><b>4.10</b> The event object</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-object-properties"><i class="fa fa-check"></i><b>4.10.1</b> Event object properties</a></li>
<li class="chapter" data-level="4.10.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-target"><i class="fa fa-check"></i><b>4.10.2</b> The <code>.target</code> property</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#modifying-page-based-on-data"><i class="fa fa-check"></i><b>4.11</b> Modifying page based on data</a></li>
<li class="chapter" data-level="4.12" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#working-with-user-input"><i class="fa fa-check"></i><b>4.12</b> Calculator example</a></li>
<li class="chapter" data-level="4.13" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#exercise-3"><i class="fa fa-check"></i><b>4.13</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-servers-1.html"><a href="web-servers-1.html"><i class="fa fa-check"></i><b>5</b> Web Servers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="web-servers-1.html"><a href="web-servers-1.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="web-servers-1.html"><a href="web-servers-1.html#web-servers-2"><i class="fa fa-check"></i><b>5.2</b> Web servers</a></li>
<li class="chapter" data-level="5.3" data-path="web-servers-1.html"><a href="web-servers-1.html#communicating-through-http"><i class="fa fa-check"></i><b>5.3</b> Communicating through HTTP</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="web-servers-1.html"><a href="web-servers-1.html#web-protocols-and-http"><i class="fa fa-check"></i><b>5.3.1</b> Web protocols and HTTP</a></li>
<li class="chapter" data-level="5.3.2" data-path="web-servers-1.html"><a href="web-servers-1.html#http-methods"><i class="fa fa-check"></i><b>5.3.2</b> HTTP methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="web-servers-1.html"><a href="web-servers-1.html#static-vs-dynamic-servers"><i class="fa fa-check"></i><b>5.4</b> Static vs. dynamic servers</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="web-servers-1.html"><a href="web-servers-1.html#overview"><i class="fa fa-check"></i><b>5.4.1</b> Overview</a></li>
<li class="chapter" data-level="5.4.2" data-path="web-servers-1.html"><a href="web-servers-1.html#static-servers"><i class="fa fa-check"></i><b>5.4.2</b> Static servers</a></li>
<li class="chapter" data-level="5.4.3" data-path="web-servers-1.html"><a href="web-servers-1.html#dynamic-servers"><i class="fa fa-check"></i><b>5.4.3</b> Dynamic servers</a></li>
<li class="chapter" data-level="5.4.4" data-path="web-servers-1.html"><a href="web-servers-1.html#software-1"><i class="fa fa-check"></i><b>5.4.4</b> Software</a></li>
<li class="chapter" data-level="5.4.5" data-path="web-servers-1.html"><a href="web-servers-1.html#practical-considerations"><i class="fa fa-check"></i><b>5.4.5</b> Practical considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="web-servers-1.html"><a href="web-servers-1.html#urls-and-file-structure"><i class="fa fa-check"></i><b>5.5</b> URLs and file structure</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="web-servers-1.html"><a href="web-servers-1.html#urls-and-index-html"><i class="fa fa-check"></i><b>5.5.1</b> URLs and <code>index.html</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="web-servers-1.html"><a href="web-servers-1.html#file-structure"><i class="fa fa-check"></i><b>5.5.2</b> File structure</a></li>
<li class="chapter" data-level="5.5.3" data-path="web-servers-1.html"><a href="web-servers-1.html#relative-paths"><i class="fa fa-check"></i><b>5.5.3</b> Relative paths</a></li>
<li class="chapter" data-level="5.5.4" data-path="web-servers-1.html"><a href="web-servers-1.html#css-and-javasccript"><i class="fa fa-check"></i><b>5.5.4</b> CSS and JavaScript</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="web-servers-1.html"><a href="web-servers-1.html#running-a-static-server"><i class="fa fa-check"></i><b>5.6</b> Running a static server</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="web-servers-1.html"><a href="web-servers-1.html#overview-running-static-server"><i class="fa fa-check"></i><b>5.6.1</b> Overview</a></li>
<li class="chapter" data-level="5.6.2" data-path="web-servers-1.html"><a href="web-servers-1.html#local-with-python"><i class="fa fa-check"></i><b>5.6.2</b> Local with Python</a></li>
<li class="chapter" data-level="5.6.3" data-path="web-servers-1.html"><a href="web-servers-1.html#remote-with-github-pages"><i class="fa fa-check"></i><b>5.6.3</b> Remote with GitHub Pages</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Web Mapping with Leaflet</b></span></li>
<li class="chapter" data-level="6" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>6</b> Leaflet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="leaflet.html"><a href="leaflet.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="leaflet.html"><a href="leaflet.html#what-is-web-map"><i class="fa fa-check"></i><b>6.2</b> What is a web map?</a></li>
<li class="chapter" data-level="6.3" data-path="leaflet.html"><a href="leaflet.html#what-is-leaflet"><i class="fa fa-check"></i><b>6.3</b> What is Leaflet?</a></li>
<li class="chapter" data-level="6.4" data-path="leaflet.html"><a href="leaflet.html#alternatives-to-leaflet"><i class="fa fa-check"></i><b>6.4</b> Alternatives to Leaflet</a></li>
<li class="chapter" data-level="6.5" data-path="leaflet.html"><a href="leaflet.html#creating-a-basic-web-map"><i class="fa fa-check"></i><b>6.5</b> Creating a basic web map</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="leaflet.html"><a href="leaflet.html#overview-creating-a-basic-web-map"><i class="fa fa-check"></i><b>6.5.1</b> Overview</a></li>
<li class="chapter" data-level="6.5.2" data-path="leaflet.html"><a href="leaflet.html#web-page-setup"><i class="fa fa-check"></i><b>6.5.2</b> Web page setup</a></li>
<li class="chapter" data-level="6.5.3" data-path="leaflet.html"><a href="leaflet.html#javascript-libraries"><i class="fa fa-check"></i><b>6.5.3</b> JavaScript libraries</a></li>
<li class="chapter" data-level="6.5.4" data-path="leaflet.html"><a href="leaflet.html#including-a-library"><i class="fa fa-check"></i><b>6.5.4</b> Including a library</a></li>
<li class="chapter" data-level="6.5.5" data-path="leaflet.html"><a href="leaflet.html#loading-a-local-script"><i class="fa fa-check"></i><b>6.5.5</b> Loading a local script</a></li>
<li class="chapter" data-level="6.5.6" data-path="leaflet.html"><a href="leaflet.html#loading-a-remote-script"><i class="fa fa-check"></i><b>6.5.6</b> Loading a remote script</a></li>
<li class="chapter" data-level="6.5.7" data-path="leaflet.html"><a href="leaflet.html#including-leaflet-css-js"><i class="fa fa-check"></i><b>6.5.7</b> Including Leaflet CSS and JavaScript</a></li>
<li class="chapter" data-level="6.5.8" data-path="leaflet.html"><a href="leaflet.html#adding-map-div"><i class="fa fa-check"></i><b>6.5.8</b> Adding map <code>&lt;div&gt;</code></a></li>
<li class="chapter" data-level="6.5.9" data-path="leaflet.html"><a href="leaflet.html#creating-map-object"><i class="fa fa-check"></i><b>6.5.9</b> Creating a map object</a></li>
<li class="chapter" data-level="6.5.10" data-path="leaflet.html"><a href="leaflet.html#what-are-tile-layers"><i class="fa fa-check"></i><b>6.5.10</b> What are tile layers?</a></li>
<li class="chapter" data-level="6.5.11" data-path="leaflet.html"><a href="leaflet.html#adding-a-tile-layer"><i class="fa fa-check"></i><b>6.5.11</b> Adding a tile layer</a></li>
<li class="chapter" data-level="6.5.12" data-path="leaflet.html"><a href="leaflet.html#tile-layer-providers"><i class="fa fa-check"></i><b>6.5.12</b> Tile layer providers</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="leaflet.html"><a href="leaflet.html#adding-vector-layers"><i class="fa fa-check"></i><b>6.6</b> Adding vector layers</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="leaflet.html"><a href="leaflet.html#overview-adding-vector-layers"><i class="fa fa-check"></i><b>6.6.1</b> Overview</a></li>
<li class="chapter" data-level="6.6.2" data-path="leaflet.html"><a href="leaflet.html#adding-markers"><i class="fa fa-check"></i><b>6.6.2</b> Adding markers</a></li>
<li class="chapter" data-level="6.6.3" data-path="leaflet.html"><a href="leaflet.html#adding-lines"><i class="fa fa-check"></i><b>6.6.3</b> Adding lines</a></li>
<li class="chapter" data-level="6.6.4" data-path="leaflet.html"><a href="leaflet.html#adding-polygons"><i class="fa fa-check"></i><b>6.6.4</b> Adding polygons</a></li>
<li class="chapter" data-level="6.6.5" data-path="leaflet.html"><a href="leaflet.html#other-layer-types"><i class="fa fa-check"></i><b>6.6.5</b> Other layer types</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="leaflet.html"><a href="leaflet.html#adding-popups"><i class="fa fa-check"></i><b>6.7</b> Adding popups</a></li>
<li class="chapter" data-level="6.8" data-path="leaflet.html"><a href="leaflet.html#adding-a-description"><i class="fa fa-check"></i><b>6.8</b> Adding a description</a></li>
<li class="chapter" data-level="6.9" data-path="leaflet.html"><a href="leaflet.html#introducing-map-events"><i class="fa fa-check"></i><b>6.9</b> Introducing map events</a></li>
<li class="chapter" data-level="6.10" data-path="leaflet.html"><a href="leaflet.html#exercise-06"><i class="fa fa-check"></i><b>6.10</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geojson-1.html"><a href="geojson-1.html"><i class="fa fa-check"></i><b>7</b> GeoJSON</a>
<ul>
<li class="chapter" data-level="7.1" data-path="geojson-1.html"><a href="geojson-1.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="geojson-1.html"><a href="geojson-1.html#what-is-geojson"><i class="fa fa-check"></i><b>7.2</b> What is GeoJSON?</a></li>
<li class="chapter" data-level="7.3" data-path="geojson-1.html"><a href="geojson-1.html#geojson-structure"><i class="fa fa-check"></i><b>7.3</b> GeoJSON structure</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="geojson-1.html"><a href="geojson-1.html#overview-geojson"><i class="fa fa-check"></i><b>7.3.1</b> Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="geojson-1.html"><a href="geojson-1.html#geometries"><i class="fa fa-check"></i><b>7.3.2</b> Geometries</a></li>
<li class="chapter" data-level="7.3.3" data-path="geojson-1.html"><a href="geojson-1.html#features"><i class="fa fa-check"></i><b>7.3.3</b> Features</a></li>
<li class="chapter" data-level="7.3.4" data-path="geojson-1.html"><a href="geojson-1.html#feature-collections"><i class="fa fa-check"></i><b>7.3.4</b> Feature collections</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="geojson-1.html"><a href="geojson-1.html#editing-geojson"><i class="fa fa-check"></i><b>7.4</b> Editing GeoJSON</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="geojson-1.html"><a href="geojson-1.html#geojson-io"><i class="fa fa-check"></i><b>7.4.1</b> geojson.io</a></li>
<li class="chapter" data-level="7.4.2" data-path="geojson-1.html"><a href="geojson-1.html#mapshaper"><i class="fa fa-check"></i><b>7.4.2</b> mapshaper</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="geojson-1.html"><a href="geojson-1.html#adding-geojson-to-leaflet-map"><i class="fa fa-check"></i><b>7.5</b> Adding GeoJSON to Leaflet map</a></li>
<li class="chapter" data-level="7.6" data-path="geojson-1.html"><a href="geojson-1.html#geojson-viewer"><i class="fa fa-check"></i><b>7.6</b> GeoJSON viewer example</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="geojson-1.html"><a href="geojson-1.html#viewer-structure"><i class="fa fa-check"></i><b>7.6.1</b> Viewer structure</a></li>
<li class="chapter" data-level="7.6.2" data-path="geojson-1.html"><a href="geojson-1.html#viewer-html-and-css"><i class="fa fa-check"></i><b>7.6.2</b> HTML and CSS</a></li>
<li class="chapter" data-level="7.6.3" data-path="geojson-1.html"><a href="geojson-1.html#base-map"><i class="fa fa-check"></i><b>7.6.3</b> Base map</a></li>
<li class="chapter" data-level="7.6.4" data-path="geojson-1.html"><a href="geojson-1.html#adding-an-event-listener"><i class="fa fa-check"></i><b>7.6.4</b> Adding an event listener</a></li>
<li class="chapter" data-level="7.6.5" data-path="geojson-1.html"><a href="geojson-1.html#using-layer-groups"><i class="fa fa-check"></i><b>7.6.5</b> Using layer groups</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="geojson-1.html"><a href="geojson-1.html#ajax"><i class="fa fa-check"></i><b>7.7</b> Ajax and the <code>fetch</code> API</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="geojson-1.html"><a href="geojson-1.html#overview-ajax"><i class="fa fa-check"></i><b>7.7.1</b> What is Ajax?</a></li>
<li class="chapter" data-level="7.7.2" data-path="geojson-1.html"><a href="geojson-1.html#ajax-examples"><i class="fa fa-check"></i><b>7.7.2</b> Ajax examples</a></li>
<li class="chapter" data-level="7.7.3" data-path="geojson-1.html"><a href="geojson-1.html#making-ajax-requests-with-fetch"><i class="fa fa-check"></i><b>7.7.3</b> The <code>fetch</code> API</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="geojson-1.html"><a href="geojson-1.html#loading-geojson-files"><i class="fa fa-check"></i><b>7.8</b> Loading GeoJSON files</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="geojson-1.html"><a href="geojson-1.html#loading-local-files"><i class="fa fa-check"></i><b>7.8.1</b> Loading local files</a></li>
<li class="chapter" data-level="7.8.2" data-path="geojson-1.html"><a href="geojson-1.html#loading-remote-files"><i class="fa fa-check"></i><b>7.8.2</b> Loading remote files</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="geojson-1.html"><a href="geojson-1.html#exercise-4"><i class="fa fa-check"></i><b>7.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html"><i class="fa fa-check"></i><b>8</b> Symbology and Interactivity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#l-geojson-options"><i class="fa fa-check"></i><b>8.2</b> <code>L.geoJSON</code> options</a></li>
<li class="chapter" data-level="8.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#constant-style"><i class="fa fa-check"></i><b>8.3</b> Constant style</a></li>
<li class="chapter" data-level="8.4" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#varying-style"><i class="fa fa-check"></i><b>8.4</b> Varying style</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#setting-varying-style"><i class="fa fa-check"></i><b>8.4.1</b> Setting varying style</a></li>
<li class="chapter" data-level="8.4.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#states-example"><i class="fa fa-check"></i><b>8.4.2</b> States example</a></li>
<li class="chapter" data-level="8.4.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#towns-example"><i class="fa fa-check"></i><b>8.4.3</b> Towns example</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#constructing-popups-from-data"><i class="fa fa-check"></i><b>8.5</b> Constructing popups from data</a></li>
<li class="chapter" data-level="8.6" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#adding-a-legend"><i class="fa fa-check"></i><b>8.6</b> Adding a legend</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#setting-legend-contents-with-l.control"><i class="fa fa-check"></i><b>8.6.1</b> Setting legend contents with <code>L.control</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#using-css-to-style-the-legend"><i class="fa fa-check"></i><b>8.6.2</b> Using CSS to style the legend</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#dynamic-style"><i class="fa fa-check"></i><b>8.7</b> Dynamic style</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#styling-in-response-to-events"><i class="fa fa-check"></i><b>8.7.1</b> Styling in response to events</a></li>
<li class="chapter" data-level="8.7.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#dynamic-control-contents"><i class="fa fa-check"></i><b>8.7.2</b> Dynamic control contents</a></li>
<li class="chapter" data-level="8.7.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#linked-views"><i class="fa fa-check"></i><b>8.7.3</b> Linked views</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#exercise-08"><i class="fa fa-check"></i><b>8.8</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>III Databases</b></span></li>
<li class="chapter" data-level="9" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>9</b> Databases</a>
<ul>
<li class="chapter" data-level="9.1" data-path="databases.html"><a href="databases.html#introduction-databases"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="databases.html"><a href="databases.html#what-is-carto"><i class="fa fa-check"></i><b>9.2</b> What is CARTO?</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="databases.html"><a href="databases.html#the-carto-platform"><i class="fa fa-check"></i><b>9.2.1</b> The CARTO platform</a></li>
<li class="chapter" data-level="9.2.2" data-path="databases.html"><a href="databases.html#alternatives-to-carto"><i class="fa fa-check"></i><b>9.2.2</b> Alternatives to CARTO</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="databases.html"><a href="databases.html#databases-1"><i class="fa fa-check"></i><b>9.3</b> Databases</a></li>
<li class="chapter" data-level="9.4" data-path="databases.html"><a href="databases.html#spatial-databases"><i class="fa fa-check"></i><b>9.4</b> Spatial databases</a></li>
<li class="chapter" data-level="9.5" data-path="databases.html"><a href="databases.html#what-is-postgis"><i class="fa fa-check"></i><b>9.5</b> What is PostGIS?</a></li>
<li class="chapter" data-level="9.6" data-path="databases.html"><a href="databases.html#what-is-sql"><i class="fa fa-check"></i><b>9.6</b> What is SQL?</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="databases.html"><a href="databases.html#overview-sql"><i class="fa fa-check"></i><b>9.6.1</b> Overview</a></li>
<li class="chapter" data-level="9.6.2" data-path="databases.html"><a href="databases.html#non-spatial-queries"><i class="fa fa-check"></i><b>9.6.2</b> Non-spatial queries</a></li>
<li class="chapter" data-level="9.6.3" data-path="databases.html"><a href="databases.html#the-geometry-column"><i class="fa fa-check"></i><b>9.6.3</b> The geometry column</a></li>
<li class="chapter" data-level="9.6.4" data-path="databases.html"><a href="databases.html#spatial-queries"><i class="fa fa-check"></i><b>9.6.4</b> Spatial queries</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="databases.html"><a href="databases.html#the-carto-sql-api"><i class="fa fa-check"></i><b>9.7</b> The CARTO SQL API</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="databases.html"><a href="databases.html#api-usage"><i class="fa fa-check"></i><b>9.7.1</b> API usage</a></li>
<li class="chapter" data-level="9.7.2" data-path="databases.html"><a href="databases.html#query-example"><i class="fa fa-check"></i><b>9.7.2</b> Query example</a></li>
<li class="chapter" data-level="9.7.3" data-path="databases.html"><a href="databases.html#uploading-your-data"><i class="fa fa-check"></i><b>9.7.3</b> Uploading your data</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="databases.html"><a href="databases.html#carto-and-leaflet"><i class="fa fa-check"></i><b>9.8</b> CARTO and Leaflet</a></li>
<li class="chapter" data-level="9.9" data-path="databases.html"><a href="databases.html#exercise-09"><i class="fa fa-check"></i><b>9.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html"><i class="fa fa-check"></i><b>10</b> Non-spatial Queries</a>
<ul>
<li class="chapter" data-level="10.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#subsetting-with-sql"><i class="fa fa-check"></i><b>10.2</b> Subsetting with SQL</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#filtering-based-on-attributes"><i class="fa fa-check"></i><b>10.2.1</b> Filtering based on attributes</a></li>
<li class="chapter" data-level="10.2.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#displaying-on-a-map"><i class="fa fa-check"></i><b>10.2.2</b> Displaying on a map</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#creating-a-dropdown-menu"><i class="fa fa-check"></i><b>10.3</b> Creating a dropdown menu</a></li>
<li class="chapter" data-level="10.4" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#populating-dropdown-options"><i class="fa fa-check"></i><b>10.4</b> Populating dropdown options</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#how-many-species-do-we-have"><i class="fa fa-check"></i><b>10.4.1</b> How many species do we have?</a></li>
<li class="chapter" data-level="10.4.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#dropdown-menu-placeholder"><i class="fa fa-check"></i><b>10.4.2</b> Dropdown menu placeholder</a></li>
<li class="chapter" data-level="10.4.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#finding-unique-values"><i class="fa fa-check"></i><b>10.4.3</b> Finding unique values</a></li>
<li class="chapter" data-level="10.4.4" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#adding-options"><i class="fa fa-check"></i><b>10.4.4</b> Adding the options</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#updating-the-map"><i class="fa fa-check"></i><b>10.5</b> Updating the map</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#overview-updating-map"><i class="fa fa-check"></i><b>10.5.1</b> Overview</a></li>
<li class="chapter" data-level="10.5.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#manual-example"><i class="fa fa-check"></i><b>10.5.2</b> Manual example</a></li>
<li class="chapter" data-level="10.5.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#automatic-updating"><i class="fa fa-check"></i><b>10.5.3</b> Automatic updating</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#rearranging-the-code"><i class="fa fa-check"></i><b>10.6</b> Refactoring the code</a></li>
<li class="chapter" data-level="10.7" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#exercise-10"><i class="fa fa-check"></i><b>10.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html"><i class="fa fa-check"></i><b>11</b> Spatial Queries</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-marker-on-click"><i class="fa fa-check"></i><b>11.2</b> Adding markers on click</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#getting-click-coordinates"><i class="fa fa-check"></i><b>11.2.1</b> Getting click coordinates</a></li>
<li class="chapter" data-level="11.2.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-custom-marker"><i class="fa fa-check"></i><b>11.2.2</b> Adding a custom marker</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#spatial-postgis-operators"><i class="fa fa-check"></i><b>11.3</b> Spatial PostGIS operators</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#overview-postgis-operators"><i class="fa fa-check"></i><b>11.3.1</b> Overview</a></li>
<li class="chapter" data-level="11.3.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#geographical-distance"><i class="fa fa-check"></i><b>11.3.2</b> Geographical distance</a></li>
<li class="chapter" data-level="11.3.3" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#sphere-vs-spheroid"><i class="fa fa-check"></i><b>11.3.3</b> Sphere vs. spheroid</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-nearest-points-to-map"><i class="fa fa-check"></i><b>11.4</b> Adding nearest points to map</a></li>
<li class="chapter" data-level="11.5" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#drawing-line-connectors"><i class="fa fa-check"></i><b>11.5</b> Drawing line connectors</a></li>
<li class="chapter" data-level="11.6" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#exercise-5"><i class="fa fa-check"></i><b>11.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>IV Advanced Topics</b></span></li>
<li class="chapter" data-level="12" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html"><i class="fa fa-check"></i><b>12</b> Client-side Geoprocessing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#geoprocessing-with-turfjs"><i class="fa fa-check"></i><b>12.2</b> Geoprocessing with Turf.js</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-turfjs"><i class="fa fa-check"></i><b>12.2.1</b> Overview</a></li>
<li class="chapter" data-level="12.2.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#including-the-turf-js-library"><i class="fa fa-check"></i><b>12.2.2</b> Including the Turf.js library</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#great-circle-line"><i class="fa fa-check"></i><b>12.3</b> Great Circle line</a></li>
<li class="chapter" data-level="12.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#continuously-updated-tin"><i class="fa fa-check"></i><b>12.4</b> Continuously updated TIN</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-continuous-tin"><i class="fa fa-check"></i><b>12.4.1</b> Overview</a></li>
<li class="chapter" data-level="12.4.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#generating-random-points"><i class="fa fa-check"></i><b>12.4.2</b> Generating random points</a></li>
<li class="chapter" data-level="12.4.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#adding-a-tin-layer"><i class="fa fa-check"></i><b>12.4.3</b> Adding a TIN layer</a></li>
<li class="chapter" data-level="12.4.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#draggable-circle-markers"><i class="fa fa-check"></i><b>12.4.4</b> Draggable circle markers</a></li>
<li class="chapter" data-level="12.4.5" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#continuous-updating"><i class="fa fa-check"></i><b>12.4.5</b> Continuous updating</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#clustering"><i class="fa fa-check"></i><b>12.5</b> Clustering</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-clustering"><i class="fa fa-check"></i><b>12.5.1</b> Overview</a></li>
<li class="chapter" data-level="12.5.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#processing-sets-of-features"><i class="fa fa-check"></i><b>12.5.2</b> Processing sets of features</a></li>
<li class="chapter" data-level="12.5.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#adding-a-convex-hull"><i class="fa fa-check"></i><b>12.5.3</b> Adding a Convex Hull</a></li>
<li class="chapter" data-level="12.5.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#dbscan-clustering"><i class="fa fa-check"></i><b>12.5.4</b> DBSCAN clustering</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#heatmaps-with-leafletheat"><i class="fa fa-check"></i><b>12.6</b> Heatmaps with Leaflet.heat</a></li>
<li class="chapter" data-level="12.7" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#exercise-6"><i class="fa fa-check"></i><b>12.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html"><i class="fa fa-check"></i><b>13</b> Collaborative Mapping</a>
<ul>
<li class="chapter" data-level="13.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#crowdsourcing"><i class="fa fa-check"></i><b>13.2</b> Crowdsourcing</a></li>
<li class="chapter" data-level="13.3" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#the-drawing-control"><i class="fa fa-check"></i><b>13.3</b> The drawing control</a></li>
<li class="chapter" data-level="13.4" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#working-with-drawn-items"><i class="fa fa-check"></i><b>13.4</b> Working with drawn items</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#printing-drawn-items-geojson"><i class="fa fa-check"></i><b>13.4.1</b> Printing drawn items GeoJSON</a></li>
<li class="chapter" data-level="13.4.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#expanded-geojson-viewer"><i class="fa fa-check"></i><b>13.4.2</b> Expanded GeoJSON viewer</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#submission-form"><i class="fa fa-check"></i><b>13.5</b> Submission form</a></li>
<li class="chapter" data-level="13.6" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#sending-features-to-the-database"><i class="fa fa-check"></i><b>13.6</b> Sending features to the database</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#setting-database-permissions"><i class="fa fa-check"></i><b>13.6.1</b> Setting database permissions</a></li>
<li class="chapter" data-level="13.6.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#adding-draw-control"><i class="fa fa-check"></i><b>13.6.2</b> Adding the drawing control</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#exercise-7"><i class="fa fa-check"></i><b>13.7</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>V Appendices</b></span></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="associated-files.html"><a href="associated-files.html"><i class="fa fa-check"></i><b>A</b> Associated Files</a></li>
<li class="chapter" data-level="B" data-path="list-of-examples.html"><a href="list-of-examples.html"><i class="fa fa-check"></i><b>B</b> List of Examples</a>
<ul>
<li class="chapter" data-level="B.1" data-path="list-of-examples.html"><a href="list-of-examples.html#main"><i class="fa fa-check"></i><b>B.1</b> Main</a></li>
<li class="chapter" data-level="B.2" data-path="list-of-examples.html"><a href="list-of-examples.html#additional"><i class="fa fa-check"></i><b>B.2</b> Additional</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="list-of-examples.html"><a href="list-of-examples.html#html-and-css"><i class="fa fa-check"></i><b>B.2.1</b> HTML and CSS</a></li>
<li class="chapter" data-level="B.2.2" data-path="list-of-examples.html"><a href="list-of-examples.html#javascript"><i class="fa fa-check"></i><b>B.2.2</b> JavaScript</a></li>
<li class="chapter" data-level="B.2.3" data-path="list-of-examples.html"><a href="list-of-examples.html#leaflet-1"><i class="fa fa-check"></i><b>B.2.3</b> Leaflet</a></li>
<li class="chapter" data-level="B.2.4" data-path="list-of-examples.html"><a href="list-of-examples.html#geo-processing"><i class="fa fa-check"></i><b>B.2.4</b> Geo-processing</a></li>
<li class="chapter" data-level="B.2.5" data-path="list-of-examples.html"><a href="list-of-examples.html#d-maps"><i class="fa fa-check"></i><b>B.2.5</b> 2.5D Maps</a></li>
<li class="chapter" data-level="B.2.6" data-path="list-of-examples.html"><a href="list-of-examples.html#d-maps-1"><i class="fa fa-check"></i><b>B.2.6</b> 3D maps</a></li>
<li class="chapter" data-level="B.2.7" data-path="list-of-examples.html"><a href="list-of-examples.html#animation"><i class="fa fa-check"></i><b>B.2.7</b> Animation</a></li>
<li class="chapter" data-level="B.2.8" data-path="list-of-examples.html"><a href="list-of-examples.html#real-time-data"><i class="fa fa-check"></i><b>B.2.8</b> Real-time data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="list-of-exercise-solutions.html"><a href="list-of-exercise-solutions.html"><i class="fa fa-check"></i><b>C</b> List of Exercise Solutions</a></li>
<li class="chapter" data-level="D" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html"><i class="fa fa-check"></i><b>D</b> BGU course 2021</a>
<ul>
<li class="chapter" data-level="D.1" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#place-and-time"><i class="fa fa-check"></i><b>D.1</b> Place and Time</a></li>
<li class="chapter" data-level="D.2" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#lecture-plan"><i class="fa fa-check"></i><b>D.2</b> Lecture plan</a></li>
<li class="chapter" data-level="D.3" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#project-submission-dates"><i class="fa fa-check"></i><b>D.3</b> Project submission dates</a></li>
<li class="chapter" data-level="D.4" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#additional-resources"><i class="fa fa-check"></i><b>D.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#html-css"><i class="fa fa-check"></i><b>D.4.1</b> HTML &amp; CSS</a></li>
<li class="chapter" data-level="D.4.2" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#javascript-1"><i class="fa fa-check"></i><b>D.4.2</b> JavaScript</a></li>
<li class="chapter" data-level="D.4.3" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#web-mapping"><i class="fa fa-check"></i><b>D.4.3</b> Web mapping</a></li>
<li class="chapter" data-level="D.4.4" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#postgis"><i class="fa fa-check"></i><b>D.4.4</b> PostGIS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>E</b> Projects</a>
<ul>
<li class="chapter" data-level="E.1" data-path="projects.html"><a href="projects.html#overview-3"><i class="fa fa-check"></i><b>E.1</b> Overview</a></li>
<li class="chapter" data-level="E.2" data-path="projects.html"><a href="projects.html#carto-account"><i class="fa fa-check"></i><b>E.2</b> CARTO Account</a></li>
<li class="chapter" data-level="E.3" data-path="projects.html"><a href="projects.html#data"><i class="fa fa-check"></i><b>E.3</b> Data</a></li>
<li class="chapter" data-level="E.4" data-path="projects.html"><a href="projects.html#project-requirements"><i class="fa fa-check"></i><b>E.4</b> Project requirements</a>
<ul>
<li class="chapter" data-level="E.4.1" data-path="projects.html"><a href="projects.html#project-01"><i class="fa fa-check"></i><b>E.4.1</b> Project 01</a></li>
<li class="chapter" data-level="E.4.2" data-path="projects.html"><a href="projects.html#project-02"><i class="fa fa-check"></i><b>E.4.2</b> Project 02</a></li>
<li class="chapter" data-level="E.4.3" data-path="projects.html"><a href="projects.html#project-03"><i class="fa fa-check"></i><b>E.4.3</b> Project 03</a></li>
</ul></li>
<li class="chapter" data-level="E.5" data-path="projects.html"><a href="projects.html#submission"><i class="fa fa-check"></i><b>E.5</b> Submission</a></li>
<li class="chapter" data-level="E.6" data-path="projects.html"><a href="projects.html#grading"><i class="fa fa-check"></i><b>E.6</b> Grading</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="exam.html"><a href="exam.html"><i class="fa fa-check"></i><b>F</b> Exam</a>
<ul>
<li class="chapter" data-level="F.1" data-path="exam.html"><a href="exam.html#topics"><i class="fa fa-check"></i><b>F.1</b> Topics</a></li>
<li class="chapter" data-level="F.2" data-path="exam.html"><a href="exam.html#sample-questions"><i class="fa fa-check"></i><b>F.2</b> Sample questions</a>
<ul>
<li class="chapter" data-level="F.2.1" data-path="exam.html"><a href="exam.html#question-1"><i class="fa fa-check"></i><b>F.2.1</b> Question 1</a></li>
<li class="chapter" data-level="F.2.3" data-path="exam.html"><a href="exam.html#question-3"><i class="fa fa-check"></i><b>F.2.3</b> Question 3</a></li>
<li class="chapter" data-level="F.2.4" data-path="exam.html"><a href="exam.html#question-4"><i class="fa fa-check"></i><b>F.2.4</b> Question 4</a></li>
<li class="chapter" data-level="F.2.5" data-path="exam.html"><a href="exam.html#question-5"><i class="fa fa-check"></i><b>F.2.5</b> Question 5</a></li>
<li class="chapter" data-level="F.2.6" data-path="exam.html"><a href="exam.html#question-6"><i class="fa fa-check"></i><b>F.2.6</b> Question 6</a></li>
<li class="chapter" data-level="F.2.7" data-path="exam.html"><a href="exam.html#question-7"><i class="fa fa-check"></i><b>F.2.7</b> Question 7</a></li>
<li class="chapter" data-level="F.2.8" data-path="exam.html"><a href="exam.html#question-8"><i class="fa fa-check"></i><b>F.2.8</b> Question 8</a></li>
<li class="chapter" data-level="F.2.9" data-path="exam.html"><a href="exam.html#question-9"><i class="fa fa-check"></i><b>F.2.9</b> Question 9</a></li>
<li class="chapter" data-level="F.2.10" data-path="exam.html"><a href="exam.html#question-10"><i class="fa fa-check"></i><b>F.2.10</b> Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="additional-questions.html"><a href="additional-questions.html"><i class="fa fa-check"></i><b>G</b> Additional Questions</a>
<ul>
<li class="chapter" data-level="G.1" data-path="additional-questions.html"><a href="additional-questions.html#chapter-3"><i class="fa fa-check"></i><b>G.1</b> Chapter 3</a>
<ul>
<li class="chapter" data-level="G.1.1" data-path="additional-questions.html"><a href="additional-questions.html#modifying-global-variable"><i class="fa fa-check"></i><b>G.1.1</b> Modifying global variable</a></li>
<li class="chapter" data-level="G.1.2" data-path="additional-questions.html"><a href="additional-questions.html#insertingremoving-array-element"><i class="fa fa-check"></i><b>G.1.2</b> Inserting/removing array element</a></li>
<li class="chapter" data-level="G.1.3" data-path="additional-questions.html"><a href="additional-questions.html#object-oriented-language"><i class="fa fa-check"></i><b>G.1.3</b> Object Oriented language</a></li>
</ul></li>
<li class="chapter" data-level="G.2" data-path="additional-questions.html"><a href="additional-questions.html#chapter-4"><i class="fa fa-check"></i><b>G.2</b> Chapter 4</a>
<ul>
<li class="chapter" data-level="G.2.1" data-path="additional-questions.html"><a href="additional-questions.html#removing-collection-of-html-elements"><i class="fa fa-check"></i><b>G.2.1</b> Removing collection of HTML elements</a></li>
<li class="chapter" data-level="G.2.2" data-path="additional-questions.html"><a href="additional-questions.html#constraining-event-listener-frequency"><i class="fa fa-check"></i><b>G.2.2</b> Constraining event listener frequency</a></li>
<li class="chapter" data-level="G.2.3" data-path="additional-questions.html"><a href="additional-questions.html#saving-.getelementbyid-method-in-variable"><i class="fa fa-check"></i><b>G.2.3</b> Saving <code>.getElementById</code> method in variable</a></li>
</ul></li>
<li class="chapter" data-level="G.3" data-path="additional-questions.html"><a href="additional-questions.html#chapter-6"><i class="fa fa-check"></i><b>G.3</b> Chapter 6</a>
<ul>
<li class="chapter" data-level="G.3.1" data-path="additional-questions.html"><a href="additional-questions.html#routing"><i class="fa fa-check"></i><b>G.3.1</b> Routing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="H" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html"><i class="fa fa-check"></i><b>H</b> Setting up an SQL API</a>
<ul>
<li class="chapter" data-level="H.1" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#introduction-12"><i class="fa fa-check"></i><b>H.1</b> Introduction</a></li>
<li class="chapter" data-level="H.2" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#computer-with-fixed-ip-address"><i class="fa fa-check"></i><b>H.2</b> Computer with fixed IP address</a></li>
<li class="chapter" data-level="H.3" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#installing-postgresql-postgis"><i class="fa fa-check"></i><b>H.3</b> Installing PostgreSQL and PostGIS</a></li>
<li class="chapter" data-level="H.4" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#loading-data-into-the-database"><i class="fa fa-check"></i><b>H.4</b> Loading data into the database</a></li>
<li class="chapter" data-level="H.5" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#adding-read-only-database-user"><i class="fa fa-check"></i><b>H.5</b> Adding a read-only database user</a></li>
<li class="chapter" data-level="H.6" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#installing-nodejs-and-required-modules"><i class="fa fa-check"></i><b>H.6</b> Installing Node.js and required modules</a></li>
<li class="chapter" data-level="H.7" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#creating-a-service"><i class="fa fa-check"></i><b>H.7</b> Creating a service</a></li>
<li class="chapter" data-level="H.8" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#testing-the-sql-api"><i class="fa fa-check"></i><b>H.8</b> Testing the SQL API</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html"><i class="fa fa-check"></i><b>I</b> Setting up a static server using R</a>
<ul>
<li class="chapter" data-level="I.1" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#introduction-13"><i class="fa fa-check"></i><b>I.1</b> Introduction</a></li>
<li class="chapter" data-level="I.2" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#installing-r"><i class="fa fa-check"></i><b>I.2</b> Installing R</a></li>
<li class="chapter" data-level="I.3" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#installing-the-servr-package"><i class="fa fa-check"></i><b>I.3</b> Installing the <code>servr</code> package</a></li>
<li class="chapter" data-level="I.4" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#starting-the-server"><i class="fa fa-check"></i><b>I.4</b> Starting the server</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="index-2.html">Introduction to Web Mapping</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="symbology-and-interactivity" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Symbology and Interactivity</h1>
<p><i>Last updated: 2021-08-24 14:54:59 </i></p>
<div id="introduction-7" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>Styling of map features lets us convey quantitative or qualitative <em>information</em> (how many residents are in that polygon?) or <em>emphasis</em> for drawing viewer attention (where is the border of the particular polygon of interest?). The way that aesthetic properties of map features are associated with underlying data or meaning is collectively known as map <strong>symbology</strong>, an essential concept of mapping in general, and web mapping in particular.</p>
<p>In Chapter <a href="geojson-1.html#geojson-1">7</a>, we learned about how GeoJSON layers can be added on a web map, whether from an object defined in the JavaScript environment (Section <a href="geojson-1.html#adding-geojson-to-leaflet-map">7.5</a>), a local file (Section <a href="geojson-1.html#loading-local-files">7.8.1</a>), or a remote file (Section <a href="geojson-1.html#loading-remote-files">7.8.2</a>). As for style, however, all of the layers’ features were drawn the same way. That is, because all features were set with the same default settings for their various aesthetic properties, such as fill color, line width, etc.</p>
<p>In addition to map symbology, web maps usually also express <strong>interactive</strong> behavior to further enhance user experience and convey even more information. Interactive behavior is what really sets interactive maps apart from static maps, such as those printed on paper or contained in image files and PDF documents. For example, an interactive map may have controls for turning overlaid layers on or off, switching between different base maps, displaying popups with textual or multimedia content for each clicked feature, highlighting elements on mouse hover, and so on.</p>
<p>In this chapter, we concentrate on defining map symbology (Sections <a href="symbology-and-interactivity.html#constant-style">8.3</a>–<a href="symbology-and-interactivity.html#varying-style">8.4</a>) along with a corresponding legend (Section <a href="symbology-and-interactivity.html#adding-a-legend">8.6</a>–<a href="symbology-and-interactivity.html#using-css-to-style-the-legend">8.6.2</a>), by setting the style of our GeoJSON layers displayed on the map, and interactive behavior, by setting custom popups (Section <a href="symbology-and-interactivity.html#constructing-popups-from-data">8.5</a>), dynamic styling (Section <a href="symbology-and-interactivity.html#styling-in-response-to-events">8.7.1</a>), and dynamic information boxes (Section <a href="symbology-and-interactivity.html#dynamic-control-contents">8.7.2</a>).</p>
</div>
<div id="l-geojson-options" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> <code>L.geoJSON</code> options</h2>
<p>As shown in Section <a href="geojson-1.html#adding-geojson-to-leaflet-map">7.5</a>, the <code>L.geoJSON</code> function accepts a GeoJSON object and turns it into a GeoJSON layer, which can be displayed on a Leaflet map. Additionally, the <code>L.geoJSON</code> function can also accept a number of options that we have not used yet. These options may be used to specify styling, filtering, attaching event listeners or popups, and otherwise controlling the display and functionality of the individual features comprising the GeoJSON layer. In this chapter, we use the following two options to enhance our GeoJSON layers: </p>
<ul>
<li><code>style</code>—Determines layer <strong>style</strong>. The <code>style</code> can be either an <em>object</em> to style all features the same way (Section <a href="symbology-and-interactivity.html#constant-style">8.3</a>), or a <em>function</em> to style features based on their properties (Section <a href="symbology-and-interactivity.html#varying-style">8.4</a>).</li>
<li><code>onEachFeature</code>—A function that gets called on <strong>each feature</strong> before adding it to the GeoJSON layer. The <code>onEachFeature</code> function can be used to add specific popups (Section <a href="symbology-and-interactivity.html#constructing-popups-from-data">8.5</a>) or event listeners (Section <a href="symbology-and-interactivity.html#styling-in-response-to-events">8.7.1</a>) to each feature.</li>
</ul>
<p>When using both options, the <code>L.geoJSON</code> function call may look like this: </p>
<div class="sourceCode" id="cb268"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb268-1"><a href="symbology-and-interactivity.html#cb268-1" aria-hidden="true" tabindex="-1"></a>L<span class="op">.</span><span class="fu">geoJSON</span>(geojson<span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> <span class="op">...,</span> <span class="dt">onEachFeature</span><span class="op">:</span> <span class="op">...</span>})<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>where: </p>
<ul>
<li><code>geojson</code> is the <strong>GeoJSON</strong> object; and</li>
<li><code>{style: ..., onEachFeature: ...}</code> is the <strong>options</strong> object, in this case including both <code>style</code> and <code>onEachFeature</code> options.</li>
</ul>
<p>The <code>...</code> parts in the above expression are to be replaced with an object or a function (see below), depending on how we want to define the appearance and behavior of the GeoJSON layer. </p>
<p>In addition to <code>style</code> and <code>onEachFeature</code>, in Chapter <a href="client-side-geoprocessing.html#client-side-geoprocessing">12</a> we will use a third option of <code>L.geoJSON</code> called <code>pointToLayer</code> (Sections <a href="client-side-geoprocessing.html#continuous-updating">12.4.5</a> and <a href="client-side-geoprocessing.html#processing-sets-of-features">12.5.2</a>). The <code>pointToLayer</code> option determines the way that GeoJSON point geometries are translated to visual layers. For example the <code>pointToLayer</code> option can be used to determine whether a GeoJSON <code>"Point"</code> feature should be displayed using a marker (Figure <a href="geojson-1.html#fig:example-07-04">7.10</a>; the default), a circle marker (Figures <a href="client-side-geoprocessing.html#fig:example-12-05">12.6</a>–<a href="client-side-geoprocessing.html#fig:example-12-07">12.8</a>), or a circle. </p>
</div>
<div id="constant-style" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Constant style</h2>
<p>The simplest way to style our GeoJSON layer is to set <em>constant</em> aesthetic properties for all of the features it contains. Just like in styling of line (Sections <a href="leaflet.html#adding-lines">6.6.3</a>) and polygon (Section <a href="leaflet.html#adding-polygons">6.6.4</a>) layers, we only need to set those specific properties where we would like to override the default appearance. For example, let’s start with <code>example-07-01.html</code> from Section <a href="geojson-1.html#adding-geojson-to-leaflet-map">7.5</a>. In that example, we used the following expression to add the GeoJSON object named <code>states</code> to our map: </p>
<div class="sourceCode" id="cb269"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb269-1"><a href="symbology-and-interactivity.html#cb269-1" aria-hidden="true" tabindex="-1"></a>L<span class="op">.</span><span class="fu">geoJSON</span>(states)<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>This sets the default Leaflet style for all polygons—blue border and semi-transparent blue fill (Figure <a href="geojson-1.html#fig:example-07-01">7.4</a>). To override some of the default settings, the above expression can be replaced with the following one: </p>
<div class="sourceCode" id="cb270"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb270-1"><a href="symbology-and-interactivity.html#cb270-1" aria-hidden="true" tabindex="-1"></a>L<span class="op">.</span><span class="fu">geoJSON</span>(states<span class="op">,</span> {</span>
<span id="cb270-2"><a href="symbology-and-interactivity.html#cb270-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb270-3"><a href="symbology-and-interactivity.html#cb270-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;red&quot;</span><span class="op">,</span> </span>
<span id="cb270-4"><a href="symbology-and-interactivity.html#cb270-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> </span>
<span id="cb270-5"><a href="symbology-and-interactivity.html#cb270-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillColor</span><span class="op">:</span> <span class="st">&quot;yellow&quot;</span><span class="op">,</span> </span>
<span id="cb270-6"><a href="symbology-and-interactivity.html#cb270-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.2</span></span>
<span id="cb270-7"><a href="symbology-and-interactivity.html#cb270-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb270-8"><a href="symbology-and-interactivity.html#cb270-8" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>In the new version, we are passing an object of options to the <code>L.geoJSON</code> function. The object contains one property named <code>style</code>, for which the value is also an object, containing the style specifications. In this example, we use four specifications: </p>
<ul>
<li><code>color: "red"</code>—Border color = red</li>
<li><code>weight: 5</code>—Border width = 5px</li>
<li><code>fillColor: "yellow"</code>—Fill color = yellow</li>
<li><code>fillOpacity: 0.2</code>—Fill opacity = 20% opaque</li>
</ul>
<p>The resulting map <code>example-08-01.html</code> is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-01">8.1</a>. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-01"></span>
<iframe src="examples/example-08-01.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.1: <code>example-08-01.html</code> <a href="examples/example-08-01.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
<p>The options being set in this example—border width, border color, fill color, and opacity levels—are the most commonly used ones. Other options include line cap and join styles (<code>lineCap</code>, <code>lineJoin</code>) and line dash types (<code>dashArray</code>, <code>dashOffset</code>)<a href="#fn80" class="footnote-ref" id="fnref80"><sup>80</sup></a>. </p>
</div>
<div id="varying-style" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Varying style</h2>
<div id="setting-varying-style" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Setting varying style</h3>
<p>In case we want the style to <em>vary</em> according to the properties of each feature, we need to pass a <em>function</em> instead of an <em>object</em> (Section <a href="symbology-and-interactivity.html#constant-style">8.3</a>), to the <code>style</code> option of <code>L.geoJSON</code>. We will demonstrate varying GeoJSON style through two examples: using the <code>states</code> GeoJSON object (Section <a href="symbology-and-interactivity.html#states-example">8.4.2</a>) and the <code>towns.geojson</code> file (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>). </p>
</div>
<div id="states-example" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> States example</h3>
<p>The GeoJSON object named <code>states</code>, which we used in the last example (Section <a href="symbology-and-interactivity.html#constant-style">8.3</a>), has an attribute named <code>party</code> with two possible values: <code>"Republican"</code> and <code>"Democrat"</code>. To color the state polygons according to <code>party</code>, we need to write a function that sets feature style according to its properties. The function takes an argument <code>feature</code>, which refers the current GeoJSON feature, and returns the <code>style</code> object for that particular feature. </p>
<p>In the following example, the styling function, named <code>states_style</code>, returns an object with four properties. Three out of the four properties are set to constant values (<code>color</code>, <code>weight</code>, <code>fillOpacity</code>). The fourth property (<code>fillColor</code>) is variable. The <code>fillColor</code> property is dependent on the <code>party</code> attribute of the current feature (<code>feature.properties.party</code>): </p>
<div class="sourceCode" id="cb271"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb271-1"><a href="symbology-and-interactivity.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">states_style</span>(feature) {</span>
<span id="cb271-2"><a href="symbology-and-interactivity.html#cb271-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb271-3"><a href="symbology-and-interactivity.html#cb271-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;black&quot;</span><span class="op">,</span></span>
<span id="cb271-4"><a href="symbology-and-interactivity.html#cb271-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb271-5"><a href="symbology-and-interactivity.html#cb271-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillColor</span><span class="op">:</span> <span class="fu">states_color</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">party</span>)<span class="op">,</span></span>
<span id="cb271-6"><a href="symbology-and-interactivity.html#cb271-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.7</span></span>
<span id="cb271-7"><a href="symbology-and-interactivity.html#cb271-7" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb271-8"><a href="symbology-and-interactivity.html#cb271-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The association between the <code>party</code> attribute and the fill color is made through the <code>states_color</code> function, separately defined below. The <code>states_color</code> function takes a party name <code>p</code> and returns a color name. The function uses <code>if</code>/<code>else</code> conditionals (Section <a href="javascript-basics.html#conditionals">3.10.2</a>): </p>
<div class="sourceCode" id="cb272"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb272-1"><a href="symbology-and-interactivity.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">states_color</span>(p) {</span>
<span id="cb272-2"><a href="symbology-and-interactivity.html#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p <span class="op">===</span> <span class="st">&quot;Republican&quot;</span>) <span class="cf">return</span> <span class="st">&quot;red&quot;</span><span class="op">;</span></span>
<span id="cb272-3"><a href="symbology-and-interactivity.html#cb272-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p <span class="op">===</span> <span class="st">&quot;Democrat&quot;</span>) <span class="cf">return</span> <span class="st">&quot;blue&quot;</span><span class="op">;</span></span>
<span id="cb272-4"><a href="symbology-and-interactivity.html#cb272-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;grey&quot;</span><span class="op">;</span></span>
<span id="cb272-5"><a href="symbology-and-interactivity.html#cb272-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The code of the <code>states_color</code> function specifies that if the value of <code>p</code> is <code>"Republican"</code> the function returns <code>"red"</code>, and if the value of <code>p</code> is <code>"Democrat"</code>, the function returns <code>"blue"</code>. If any other value is encountered, the function returns the default color <code>"grey"</code>. </p>
<p>Finally, we can use the <code>states_style</code> function as the <code>style</code> option when creating the <code>states</code> layer and adding it on the map: </p>
<div class="sourceCode" id="cb273"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb273-1"><a href="symbology-and-interactivity.html#cb273-1" aria-hidden="true" tabindex="-1"></a>L<span class="op">.</span><span class="fu">geoJSON</span>(states<span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> states_style})<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>The resulting map <code>example-08-02.html</code> is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-02">8.2</a>. Note that polygon fill color is now varying: one of the polygons is red while the other one is blue. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-02"></span>
<iframe src="examples/example-08-02.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.2: <code>example-08-02.html</code> <a href="examples/example-08-02.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
</div>
<div id="towns-example" class="section level3" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Towns example</h3>
<p>As another example, we will modify the style of polygons in the Israel towns map, which we prepared in <code>example-07-03.html</code> (Figure <a href="geojson-1.html#fig:example-07-03">7.9</a>). The towns layer in the <code>towns.geojson</code> file contains an attribute named <code>pop_2015</code>, which gives the population size estimate per town in 2015. We will use the <code>pop_2015</code> attribute to set polygon fill color reflecting the population size of each town (Figure <a href="symbology-and-interactivity.html#fig:example-08-03">8.5</a>). </p>
<p>First, we need to define a function that can accept an attribute value and return a color, just like the <code>states_color</code> function from the states example (Section <a href="symbology-and-interactivity.html#states-example">8.4.2</a>). Since the <code>pop_2015</code> attribute is a continuous variable, our function will operate using <strong>breaks</strong> to divide the continuous distribution into categories. Each of the categories will be associated with a different color. The break points, along with the respective colors, comprise the layer <em>symbology</em>. </p>
<p>How can we choose the appropriate breaks when classifying a continuous distribution into a set of discrete categories? There are several commonly used methods for doing that. The simplest method, appropriate when the distribution is roughly uniform, is a <strong>linear scale</strong>. In a linear scale, break points are evenly distributed. For example, in case our values are between 0 and 1000, break points for a linear scale with five colors may be defined using the following array: </p>
<div class="sourceCode" id="cb274"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb274-1"><a href="symbology-and-interactivity.html#cb274-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">200</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">600</span><span class="op">,</span> <span class="dv">800</span>]</span></code></pre></div>
<p>Note that there are just three intervals between these values (200–400, 400–600, and 600–800), with the &lt;200 and &gt;800 ranges contributing the remaining two intervals. To emphasize this fact, we could explicitly specify the minimum and maximum values of the distribution (such as 0 and 1000), or just specify <code>-Infinity</code> and <code>Infinity</code>: </p>
<div class="sourceCode" id="cb275"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb275-1"><a href="symbology-and-interactivity.html#cb275-1" aria-hidden="true" tabindex="-1"></a>[<span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">600</span><span class="op">,</span> <span class="dv">800</span><span class="op">,</span> <span class="kw">Infinity</span>]</span></code></pre></div>
<p>When the distribution of the variable of interest is skewed, a linear scale may be inappropriate, as it would lead to some of the colors being much more common than others. As a result, the map may have little color diversity and appear uniformly colored. One solution is to use a <strong>logarithmic scale</strong>, such as: </p>
<div class="sourceCode" id="cb276"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb276-1"><a href="symbology-and-interactivity.html#cb276-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">1000</span>]</span></code></pre></div>
<p>The logarithmic scale gives increasingly detailed emphasis on one side of the distribution—the smaller values—by inducing increasingly wider categories. For example, the first category (1–10) is much narrower than the last category (100–1000). </p>
<p>A more flexible way of dealing with non-uniform distributions, which we are going to demonstrate in the present example, is using <a href="https://en.wikipedia.org/wiki/Quantile"><strong>quantiles</strong></a>. Quantiles are break points that distribute our set of observations into groups with equal counts of cases. For example, using quantiles we may divide our distribution into four equal groups, each containing a quarter of all values (0%–25%–50%–75%–100%)<a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a>. There are <a href="http://wiki.gis.com/wiki/index.php/Quantile">advantages and disadvantages</a> to using quantile breaks in mapping. The major advantage is that all colors are equally represented, which makes it easy to detect ordinal spatial patterns in our data. The downside is that category ranges can be widely different, in a non-systematic manner, which means that different color “steps” on the map are not consistently related to quantitative differences. </p>
<p>How can we calculate the quantile breaks for a given variable? There are many ways to calculate the break points in various software and programming languages, including in <a href="https://simplestatistics.org/docs/#quantile">JavaScript</a>. One example of an external software to calculate quantiles is QGIS <span class="citation">(<a href="#ref-qgis_software" role="doc-biblioref">QGIS Development Team 2018</a>)</span>. Once the layer of interest (such as <code>towns.geojson</code>) is loaded in QGIS, we need to set its symbology choosing the <strong>Quantile (Equal Count)</strong> for <strong>Mode</strong>, as shown in Figure <a href="symbology-and-interactivity.html#fig:qgis-towns-style-quantiles">8.3</a>. We also need to choose how many quantiles we want. For example, choosing 5 means that our values are divided into 5 equally sized groups, each containing 20% of the observations (i.e., 0%–20%–40%–60%–80%–100%). The breaks will be automatically calculated and displayed (Figure <a href="symbology-and-interactivity.html#fig:qgis-towns-style-quantiles">8.3</a>). </p>
<div class="figure" style="text-align: center"><span id="fig:qgis-towns-style-quantiles"></span>
<img src="images/qgis_towns_style_quantiles.png" alt="Setting symbology in QGIS, with automatically determined color scale breaks" width="90%" />
<p class="caption">
FIGURE 8.3: Setting symbology in QGIS, with automatically determined color scale breaks
</p>
</div>
<p>The four break points to split the <code>pop_2015</code> variable into five quantiles are given in the following array (Figure <a href="symbology-and-interactivity.html#fig:qgis-towns-style-quantiles">8.3</a>): </p>
<div class="sourceCode" id="cb277"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb277-1"><a href="symbology-and-interactivity.html#cb277-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">399</span><span class="op">,</span> <span class="dv">642</span><span class="op">,</span> <span class="fl">933.2</span><span class="op">,</span> <span class="fl">2089.8</span>]</span></code></pre></div>
<p>Once we figured out the break points, we can write a color-selection function, such as the one hereby named <code>towns_color</code>. The function accepts a value <code>d</code> (population size) and determines the appropriate color for that value. Since we have five different categories, the function uses a hierarchical set of four conditionals, as follows: </p>
<div class="sourceCode" id="cb278"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb278-1"><a href="symbology-and-interactivity.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">towns_color</span>(d) {</span>
<span id="cb278-2"><a href="symbology-and-interactivity.html#cb278-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="fl">2089.8</span>) <span class="cf">return</span> <span class="st">&quot;...&quot;</span><span class="op">;</span></span>
<span id="cb278-3"><a href="symbology-and-interactivity.html#cb278-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="fl">933.2</span>) <span class="cf">return</span> <span class="st">&quot;...&quot;</span><span class="op">;</span></span>
<span id="cb278-4"><a href="symbology-and-interactivity.html#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="dv">642</span>) <span class="cf">return</span> <span class="st">&quot;...&quot;</span><span class="op">;</span></span>
<span id="cb278-5"><a href="symbology-and-interactivity.html#cb278-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="dv">399</span>) <span class="cf">return</span> <span class="st">&quot;...&quot;</span><span class="op">;</span> </span>
<span id="cb278-6"><a href="symbology-and-interactivity.html#cb278-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;...&quot;</span><span class="op">;</span></span>
<span id="cb278-7"><a href="symbology-and-interactivity.html#cb278-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>What’s missing in the body of the above function (<code>"..."</code>) are the color definitions. As discussed in Section <a href="css.html#color">2.8.2</a>, there are several ways to specify colors with CSS. We can use <strong>RBG</strong> or <strong>RGBA</strong> values, <strong>HEX</strong> codes, or color <strong>names</strong> to specify colors in Leaflet. All of these methods are supported in Leaflet, too. </p>
<p>How can we pick the right set of five colors for our color scale? It may be tempting to pick the colors manually, but this may lead to an inconsistent color gradient. It is therefore best to use automatic tools and resources rather than try to pick the colors ourselves. There are many resources on the web and in software packages available for the job. One of the best and most well-known ones is <a href="http://colorbrewer2.org/"><strong>ColorBrewer</strong></a>. The ColorBrewer website provides a collection of carefully selected color scales, specifically designed for cartography by <a href="https://en.wikipedia.org/wiki/Cynthia_Brewer">Cynthia Brewer</a> (Figure <a href="symbology-and-interactivity.html#fig:colorbrewer-colors-edited">8.4</a>). Conveniently, you can choose the color palette, and how many colors to pick from it, then export the HEX codes of all colors in several formats, including a JavaScript array. ColorBrewer provides three types of scales: </p>
<ul>
<li><strong>Sequential</strong> scales</li>
<li><strong>Diverging</strong> scales</li>
<li><strong>Qualitative</strong> scales</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:colorbrewer-colors-edited"></span>
<img src="images/colorbrewer_colors_edited.png" alt="Sequential, diverging, and qualitative ColorBrewer scales, using the maximal number of colors available in each scale" width="75%" />
<p class="caption">
FIGURE 8.4: Sequential, diverging, and qualitative ColorBrewer scales, using the maximal number of colors available in each scale
</p>
</div>
<p>For our population size data, we will use a <strong>sequential</strong> scale (Figure <a href="symbology-and-interactivity.html#fig:colorbrewer-colors-edited">8.4</a>), which is appropriate when the data are continuous and have a single direction (low-high). <strong>Diverging</strong> scales are appropriate for continuous variables that diverge in two directions around some kind of “middle” (low-mid-high). For example, rate of population growth can be mapped with a diverging scale, where positive and negative growth rates are shown with different increasingly dark colors (e.g., red and blue), while values around zero are shown with a light color (e.g., white). <strong>Qualitative</strong> scales are appropriate for categorical variables that have no inherent order, mapped to an easily distinguishable set of colors. For instance, land cover categories (e.g., built area, forests, water bodies, etc.) can be mapped to a qualitative scale<a href="#fn82" class="footnote-ref" id="fnref82"><sup>82</sup></a>. </p>
<p>To export a JavaScript array of HEX color codes from ColorBrewer: </p>
<ul>
<li>Go to <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org</a>.</li>
<li>Select the <strong>Number of data classes</strong> (e.g., 5).</li>
<li>Pick the <strong>Nature of your data</strong>, i.e., the scale type (e.g., “sequential”).</li>
<li>Select the scale in the <strong>Pick a color scheme</strong> menu (e.g., “OrRd” for an Orange-Red scale).</li>
<li>Click <strong>Export</strong> and copy the contents of the text box named <strong>JavaScript</strong>.</li>
</ul>
<p>For example, choosing five colors from the sequential color scheme called “OrRd” (Orange-Red), the ColorBrewer website gives us the following set of HEX color codes: </p>
<div class="sourceCode" id="cb279"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb279-1"><a href="symbology-and-interactivity.html#cb279-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">&quot;#fef0d9&quot;</span><span class="op">,</span> <span class="st">&quot;#fdcc8a&quot;</span><span class="op">,</span> <span class="st">&quot;#fc8d59&quot;</span><span class="op">,</span> <span class="st">&quot;#e34a33&quot;</span><span class="op">,</span> <span class="st">&quot;#b30000&quot;</span>]</span></code></pre></div>
<p>This is an expression for creating a JavaScript array, which we can copy and paste directly into our JavaScript code. The ColorBrewer website also contains a JavaScript code file named <a href="../../colorbrewer2.org/export/colorbrewer.js"><code>colorbrewer.js</code></a>, with the complete set of color palette definitions as JavaScript arrays. If you use many different scales in a particular web map, it may be a good idea to include the file in your web page and then refer to the various color scale arrays by name in your JavaScript code. </p>
<p>Now that we have the five color codes, let’s insert them into the <code>towns_color</code> function definition. The function accepts a population size <code>d</code>, and returns the corresponding color code: </p>
<div class="sourceCode" id="cb280"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb280-1"><a href="symbology-and-interactivity.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">towns_color</span>(d) {</span>
<span id="cb280-2"><a href="symbology-and-interactivity.html#cb280-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="fl">2089.8</span>) <span class="cf">return</span> <span class="st">&quot;#b30000&quot;</span><span class="op">;</span></span>
<span id="cb280-3"><a href="symbology-and-interactivity.html#cb280-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="fl">933.2</span>) <span class="cf">return</span> <span class="st">&quot;#e34a33&quot;</span><span class="op">;</span></span>
<span id="cb280-4"><a href="symbology-and-interactivity.html#cb280-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="dv">642</span>) <span class="cf">return</span> <span class="st">&quot;#fc8d59&quot;</span><span class="op">;</span></span>
<span id="cb280-5"><a href="symbology-and-interactivity.html#cb280-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(d <span class="op">&gt;</span> <span class="dv">399</span>) <span class="cf">return</span> <span class="st">&quot;#fdcc8a&quot;</span><span class="op">;</span> </span>
<span id="cb280-6"><a href="symbology-and-interactivity.html#cb280-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;#fef0d9&quot;</span><span class="op">;</span></span>
<span id="cb280-7"><a href="symbology-and-interactivity.html#cb280-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>One disadvantage of the above <code>towns_color</code> function definition is that it uses a rigid set of <code>if</code>/<code>else</code> conditionals, which will be inconvenient to modify in case we decide to change the <em>number</em> of break points and colors. A more general version of the function could operate on an array of break points and a corresponding array of colors. Then, instead of <code>if</code>/<code>else</code> conditionals the function could use a <code>for</code> loop (Section <a href="javascript-basics.html#standard-for-loop-syntax">3.10.3.1</a>). The loop goes over the breaks array, detects between which pair of breaks our value is situated, and returns the appropriate color. Here is an alternative version of the <code>towns_color</code> function, using a <code>for</code> loop instead of <code>if</code>/<code>else</code> conditionals: </p>
<div class="sourceCode" id="cb281"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb281-1"><a href="symbology-and-interactivity.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> breaks <span class="op">=</span> [<span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span> <span class="dv">399</span><span class="op">,</span> <span class="dv">642</span><span class="op">,</span> <span class="fl">933.2</span><span class="op">,</span> <span class="fl">2089.8</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">;</span></span>
<span id="cb281-2"><a href="symbology-and-interactivity.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> colors <span class="op">=</span> [<span class="st">&quot;#fef0d9&quot;</span><span class="op">,</span> <span class="st">&quot;#fdcc8a&quot;</span><span class="op">,</span> <span class="st">&quot;#fc8d59&quot;</span><span class="op">,</span> <span class="st">&quot;#e34a33&quot;</span><span class="op">,</span> <span class="st">&quot;#b30000&quot;</span>]<span class="op">;</span></span>
<span id="cb281-3"><a href="symbology-and-interactivity.html#cb281-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-4"><a href="symbology-and-interactivity.html#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">towns_color</span>(d) {</span>
<span id="cb281-5"><a href="symbology-and-interactivity.html#cb281-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> breaks<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb281-6"><a href="symbology-and-interactivity.html#cb281-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(d <span class="op">&gt;</span> breaks[i] <span class="op">&amp;&amp;</span> d <span class="op">&lt;=</span> breaks[i<span class="op">+</span><span class="dv">1</span>]) {</span>
<span id="cb281-7"><a href="symbology-and-interactivity.html#cb281-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> colors[i]<span class="op">;</span></span>
<span id="cb281-8"><a href="symbology-and-interactivity.html#cb281-8" aria-hidden="true" tabindex="-1"></a>        }        </span>
<span id="cb281-9"><a href="symbology-and-interactivity.html#cb281-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb281-10"><a href="symbology-and-interactivity.html#cb281-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With this version, it is easier to replace the color scale whenever necessary. All we need to do is modify the <code>breaks</code> and <code>colors</code> arrays. </p>
<p>Like in the states example (<code>example-08-02.html</code>), our next step is to wrap the <code>towns_color</code> function into another function, hereby named <code>towns_style</code>, which is responsible for setting all of the styling options where we override the defaults: </p>
<div class="sourceCode" id="cb282"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb282-1"><a href="symbology-and-interactivity.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">towns_style</span>(feature) {</span>
<span id="cb282-2"><a href="symbology-and-interactivity.html#cb282-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb282-3"><a href="symbology-and-interactivity.html#cb282-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillColor</span><span class="op">:</span> <span class="fu">towns_color</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">pop_2015</span>)<span class="op">,</span></span>
<span id="cb282-4"><a href="symbology-and-interactivity.html#cb282-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb282-5"><a href="symbology-and-interactivity.html#cb282-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb282-6"><a href="symbology-and-interactivity.html#cb282-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;black&quot;</span><span class="op">,</span></span>
<span id="cb282-7"><a href="symbology-and-interactivity.html#cb282-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.7</span></span>
<span id="cb282-8"><a href="symbology-and-interactivity.html#cb282-8" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb282-9"><a href="symbology-and-interactivity.html#cb282-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This time, we have four <em>constant</em> properties (<code>weight</code>, <code>opacity</code>, <code>color</code>, and <code>fillOpacity</code>) and one <em>variable</em> property (<code>fillColor</code>). Finally, we need to pass the <code>towns_style</code> function to the GeoJSON <code>style</code> option when loading the towns layer (Section <a href="geojson-1.html#loading-local-files">7.8.1</a>) and adding it on the map: </p>
<div class="sourceCode" id="cb283"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb283-1"><a href="symbology-and-interactivity.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fetch</span>(<span class="st">&quot;data/towns.geojson&quot;</span>)</span>
<span id="cb283-2"><a href="symbology-and-interactivity.html#cb283-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(response) {</span>
<span id="cb283-3"><a href="symbology-and-interactivity.html#cb283-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb283-4"><a href="symbology-and-interactivity.html#cb283-4" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb283-5"><a href="symbology-and-interactivity.html#cb283-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(data) {</span>
<span id="cb283-6"><a href="symbology-and-interactivity.html#cb283-6" aria-hidden="true" tabindex="-1"></a>        L<span class="op">.</span><span class="fu">geoJSON</span>(data<span class="op">,</span> {<span class="dt">style</span><span class="op">:</span> towns_style})<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb283-7"><a href="symbology-and-interactivity.html#cb283-7" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span></code></pre></div>
<p>The resulting map <code>example-08-03.html</code> is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-03">8.5</a>. The towns polygons are now filled with one of the five colors from the Orange-Red ColorBrewer scale, according to the town popupation size, as defined in the <code>towns_color</code> function. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-03"></span>
<iframe src="examples/example-08-03.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.5: <code>example-08-03.html</code> <a href="examples/example-08-03.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
<p>There is a lot of theory and considerations behind choosing the type of symbology and color scale for a map, which we barely scratched the surface of. While we mainly focused on the technical process of defining and applying a color scale in a web map, the reader is referred to textbooks on cartography <span class="citation">(<a href="#ref-dent2008cartography" role="doc-biblioref">Dent, Torguson, and Hodler 2008</a>)</span> and data visualization <span class="citation">(<a href="#ref-tufte2001quantitative" role="doc-biblioref">Tufte 2001</a>; <a href="#ref-wilke2019fundamentals" role="doc-biblioref">Wilke 2019</a>)</span> for more information on the theoretical considerations of choosing a color scale for particular types of data and display purposes. For example, visualizing raw counts per polygon—when polygons are not of the same size—is considered misleading, since it draws the attention to larger polygons and minimizes the significance of smaller polygons with high magnitudes. The recommendation is, therefore, to normalize counts by polygon area, i.e., to map <em>densities</em> (counts per area) rather than raw counts (see Section <a href="symbology-and-interactivity.html#exercise-08">8.8</a>). </p>
</div>
</div>
<div id="constructing-popups-from-data" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Constructing popups from data</h2>
<p>In Section <a href="leaflet.html#adding-popups">6.7</a>, we introduced the <code>.bindPopup</code> method for adding popups to simple shapes, such as the popup for the line between the Aranne Library and the Geography Department in <code>example-06-06.html</code> (Figure <a href="leaflet.html#fig:example-06-06">6.11</a>). We could do the same with a with a GeoJSON layer to bind the same popup to all features. However, it usually doesn’t make much sense for all features (e.g., town polygons) to share the same popup. Instead, we usually want to add <em>specific</em> popups per feature, where each popup conveys information about the respective feature where it is binded. For example, it makes sense for the popup of each town polygon to display the name and population size of that specific town. </p>
<p>To bind specific popups, we use another option of the <code>L.geoJSON</code> options object, called <code>onEachFeature</code>. The <code>onEachFeature</code> option applies a function on each feature when that feature is added to the map. We can use the function to add a popup with specific content, based on the feature properties. The function we supply to <code>onEachFeature</code> has two parameters: </p>
<ul>
<li><code>feature</code>—Referring to the current <strong>feature</strong> of the GeoJSON object being processed</li>
<li><code>layer</code>—Referring to the <strong>layer</strong> being added on the map</li>
</ul>
<p>For example, the <code>onEachFeature</code> function can utilize <code>feature.properties</code> to access the properties of the currently processed feature, then run the <code>layer.bindPopup</code> method to add a corresponding popup for that specific feature on the map. The code below uses the <code>onEachFeature</code> option when loading the <code>towns.geojson</code> file, executing a function that binds a specific popup to each GeoJSON feature: </p>
<div class="sourceCode" id="cb284"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb284-1"><a href="symbology-and-interactivity.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fetch</span>(<span class="st">&quot;data/towns.geojson&quot;</span>)</span>
<span id="cb284-2"><a href="symbology-and-interactivity.html#cb284-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(response) {</span>
<span id="cb284-3"><a href="symbology-and-interactivity.html#cb284-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb284-4"><a href="symbology-and-interactivity.html#cb284-4" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb284-5"><a href="symbology-and-interactivity.html#cb284-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(data) {</span>
<span id="cb284-6"><a href="symbology-and-interactivity.html#cb284-6" aria-hidden="true" tabindex="-1"></a>        L<span class="op">.</span><span class="fu">geoJSON</span>(data<span class="op">,</span> {</span>
<span id="cb284-7"><a href="symbology-and-interactivity.html#cb284-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">style</span><span class="op">:</span> towns_style<span class="op">,</span></span>
<span id="cb284-8"><a href="symbology-and-interactivity.html#cb284-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">onEachFeature</span><span class="op">:</span> <span class="kw">function</span>(feature<span class="op">,</span> layer) {</span>
<span id="cb284-9"><a href="symbology-and-interactivity.html#cb284-9" aria-hidden="true" tabindex="-1"></a>                layer<span class="op">.</span><span class="fu">bindPopup</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">name_eng</span>)<span class="op">;</span></span>
<span id="cb284-10"><a href="symbology-and-interactivity.html#cb284-10" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb284-11"><a href="symbology-and-interactivity.html#cb284-11" aria-hidden="true" tabindex="-1"></a>        })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb284-12"><a href="symbology-and-interactivity.html#cb284-12" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span></code></pre></div>
<p>Note how the <code>L.geoJSON</code> function now gets an options object with two properties:</p>
<ul>
<li>The <code>style</code> property contains the named function <code>towns_style</code> which was defined above (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>). </li>
<li>The <code>onEachFeature</code> property contains an anonymous function defined inside the object.</li>
</ul>
<p>Also note that the previous code section binds a simple popup, with just the town name, using the contents of the <code>name_eng</code> property. However, as we have seen in Section <a href="leaflet.html#adding-popups">6.7</a>, we can construct more complicated popup contents by concatenating several strings along with HTML tags. We can also combine several feature properties in the popup contents, rather than just one. For example, we can put both the town name and the town population size inside the popup of each town, and place them in two separate lines. To do that, we replace the expression shown previously: </p>
<div class="sourceCode" id="cb285"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb285-1"><a href="symbology-and-interactivity.html#cb285-1" aria-hidden="true" tabindex="-1"></a>layer<span class="op">.</span><span class="fu">bindPopup</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">name_eng</span>)<span class="op">;</span></span></code></pre></div>
<p>with this expanded one: </p>
<div class="sourceCode" id="cb286"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb286-1"><a href="symbology-and-interactivity.html#cb286-1" aria-hidden="true" tabindex="-1"></a>layer<span class="op">.</span><span class="fu">bindPopup</span>(</span>
<span id="cb286-2"><a href="symbology-and-interactivity.html#cb286-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;div class=&quot;popup&quot;&gt;&#39;</span> <span class="op">+</span> </span>
<span id="cb286-3"><a href="symbology-and-interactivity.html#cb286-3" aria-hidden="true" tabindex="-1"></a>    feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">name_eng</span> <span class="op">+</span> <span class="st">&#39;&lt;br&gt;&#39;</span> <span class="op">+</span> </span>
<span id="cb286-4"><a href="symbology-and-interactivity.html#cb286-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;b&gt;&#39;</span> <span class="op">+</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">pop_2015</span> <span class="op">+</span> <span class="st">&#39;&lt;/b&gt;&#39;</span> <span class="op">+</span> </span>
<span id="cb286-5"><a href="symbology-and-interactivity.html#cb286-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;/div&gt;&#39;</span></span>
<span id="cb286-6"><a href="symbology-and-interactivity.html#cb286-6" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div>
<p>Now the popups will show both the town name (<code>name_eng</code>) and the town population size (<code>pop_2015</code>). The latter is shown in bold font using the <code>&lt;b&gt;</code> element. Additionally, the entire popup contents are encompassed in a <code>&lt;div&gt;</code> element with <code>class="popup"</code>. The reason we do that is so that we can apply CSS rules for styling the popup contents. In this example, we just use the <code>text-align</code> property (Section <a href="css.html#css-text-align">2.8.3.4</a>) to make the popup text centered: </p>
<div class="sourceCode" id="cb287"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb287-1"><a href="symbology-and-interactivity.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.popup</span> {</span>
<span id="cb287-2"><a href="symbology-and-interactivity.html#cb287-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb287-3"><a href="symbology-and-interactivity.html#cb287-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The resulting map <code>example-08-04.html</code>, now with both variable styling and specific popups per feature, is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-04">8.6</a>. The popup for the Tel-Aviv polygon was opened for demonstration. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-04"></span>
<iframe src="examples/example-08-04.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.6: <code>example-08-04.html</code> <a href="examples/example-08-04.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
<blockquote>
<ul>
<li>It is more convenient to read long numbers when they are formatted with commas. For example, <code>432,892</code> is easier to read than <code>432892</code>.</li>
<li>Use a JavaScript function, such as the following one taken from a <a href="https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript"><strong>StackOverflow</strong></a> question, to format the <code>pop_2015</code> values before including them in the popup.</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb288"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb288-1"><a href="symbology-and-interactivity.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatNumber</span>(num) {</span>
<span id="cb288-2"><a href="symbology-and-interactivity.html#cb288-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num</span>
<span id="cb288-3"><a href="symbology-and-interactivity.html#cb288-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">toString</span>()</span>
<span id="cb288-4"><a href="symbology-and-interactivity.html#cb288-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">(\d)(?</span><span class="ss">=</span><span class="sc">(\d{3})+(?</span><span class="ss">!</span><span class="sc">\d))</span><span class="ss">/g</span><span class="op">,</span> <span class="st">&quot;$1,&quot;</span>)<span class="op">;</span></span>
<span id="cb288-5"><a href="symbology-and-interactivity.html#cb288-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="adding-a-legend" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Adding a legend</h2>
<div id="setting-legend-contents-with-l.control" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Setting legend contents with <code>L.control</code></h3>
<p>A map <em>legend</em> summarizes the meaning of all of the displayed categories in the map symbology. In Section <a href="leaflet.html#adding-a-description">6.8</a>, we used the <code>L.control</code> function to add a map description. In this section, we use the same technique to create a legend for our map. The workflow for creating a legend involves creating a <em>custom control</em> with <code>L.control</code>, populating it with HTML that represents the legend components, then styling it with CSS so that the contents appear properly on screen. The following code section does all that, adding a legend to the towns population map from the last example (<code>example-08-04.html</code>): </p>
<div class="sourceCode" id="cb289"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb289-1"><a href="symbology-and-interactivity.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> legend <span class="op">=</span> L<span class="op">.</span><span class="fu">control</span>({<span class="dt">position</span><span class="op">:</span> <span class="st">&quot;topright&quot;</span>})<span class="op">;</span></span>
<span id="cb289-2"><a href="symbology-and-interactivity.html#cb289-2" aria-hidden="true" tabindex="-1"></a>legend<span class="op">.</span><span class="at">onAdd</span> <span class="op">=</span> <span class="kw">function</span>() {</span>
<span id="cb289-3"><a href="symbology-and-interactivity.html#cb289-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> div <span class="op">=</span> L<span class="op">.</span><span class="at">DomUtil</span><span class="op">.</span><span class="fu">create</span>(<span class="st">&quot;div&quot;</span><span class="op">,</span> <span class="st">&quot;legend&quot;</span>)<span class="op">;</span> </span>
<span id="cb289-4"><a href="symbology-and-interactivity.html#cb289-4" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> </span>
<span id="cb289-5"><a href="symbology-and-interactivity.html#cb289-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;b&gt;Population in 2015&lt;/b&gt;&lt;br&gt;by Town&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-6"><a href="symbology-and-interactivity.html#cb289-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;small&gt;Persons/Town&lt;/small&gt;&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-7"><a href="symbology-and-interactivity.html#cb289-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;div style=&quot;background-color: #b30000&quot;&gt;&lt;/div&gt;2090+&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-8"><a href="symbology-and-interactivity.html#cb289-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;div style=&quot;background-color: #e34a33&quot;&gt;&lt;/div&gt;933 - 2090&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-9"><a href="symbology-and-interactivity.html#cb289-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;div style=&quot;background-color: #fc8d59&quot;&gt;&lt;/div&gt;642 - 933&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-10"><a href="symbology-and-interactivity.html#cb289-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;div style=&quot;background-color: #fdcc8a&quot;&gt;&lt;/div&gt;399 - 642&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb289-11"><a href="symbology-and-interactivity.html#cb289-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;div style=&quot;background-color: #fef0d9&quot;&gt;&lt;/div&gt;0 - 399&lt;br&gt;&#39;</span><span class="op">;</span></span>
<span id="cb289-12"><a href="symbology-and-interactivity.html#cb289-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb289-13"><a href="symbology-and-interactivity.html#cb289-13" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb289-14"><a href="symbology-and-interactivity.html#cb289-14" aria-hidden="true" tabindex="-1"></a>legend<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>So, what did we do here? First, we created an instance of a custom control object, naming it <code>legend</code>. We used the <code>position</code> option to locate the control in the top-right corner of our map. Next, we used the <code>.onAdd</code> method of the <code>legend</code> control to run a function when the legend is added. The function creates a new <code>&lt;div&gt;</code> in the DOM, giving it a class of <code>"legend"</code>. This will let us use CSS to style the entire legend using the <code>.legend</code> selector (Section <a href="symbology-and-interactivity.html#using-css-to-style-the-legend">8.6.2</a>). We then populate the newly created <code>&lt;div&gt;</code> with HTML by using the <code>.innerHTML</code> method, like we already did in Section <a href="leaflet.html#adding-a-description">6.8</a>. </p>
<p>Most of the HTML code should be familiar from Chapter <a href="html.html#html">1</a>. One element type which we have not seen yet is <code>&lt;small&gt;</code>, used to create relatively smaller text, which is convenient for displaying the units of measurement (Figure <a href="symbology-and-interactivity.html#fig:example-08-05">8.7</a>): </p>
<div class="sourceCode" id="cb290"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb290-1"><a href="symbology-and-interactivity.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span>Persons/Town<span class="kw">&lt;/small&gt;</span></span></code></pre></div>
<p>The HTML code of the legend entries uses <code>&lt;div&gt;</code> elements to draw the legend <strong>symbols</strong>, which are <code>18px</code> square rectangles. Each symbol is followed by a textual description of the respective category, such as <code>2090+</code>. The <code>&lt;div&gt;</code> elements are useful in this context thanks to the fact they are colored using inline CSS (Section <a href="css.html#inline-css">2.7.2</a>) and the <code>background-color</code> property (Section <a href="css.html#color-background-color">2.8.2.1</a>). The five <code>&lt;div&gt;</code> elements thus reflect the colors corresponding to the layer symbology (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>). For example, here is the HTML code that creates the first colored icon (dark red) in our legend: </p>
<div class="sourceCode" id="cb291"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb291-1"><a href="symbology-and-interactivity.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span><span class="ot"> style=</span><span class="st">&quot;background-color: #b30000&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span></code></pre></div>
<p>After the HTML is appended, the <code>&lt;div&gt;</code> element of the entire legend is returned with <code>return div;</code>. Lastly, the legend is added on the map using the <code>.addTo</code> method. </p>
<p>It is important to note that, in the above code, the legend is generated <em>manually</em>. In other words, the breaks and colors in the legend and in the map symbology (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>) are specified in two separate places in our code. It is up to us to make sure the labels and colors in the map legend indeed correspond to the ones we styled the layer with. A more general approach is to generate the legend <em>programmatically</em>, e.g., using a <code>for</code> loop going through the same <code>breaks</code> and <code>colors</code> arrays which we used when setting map symbology (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a> above). Here is an alternative version of the legend definition using a <code>for</code> loop, and the <code>breaks</code> and <code>colors</code> arrays<a href="#fn83" class="footnote-ref" id="fnref83"><sup>83</sup></a> we defined in Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>: </p>
<div class="sourceCode" id="cb292"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb292-1"><a href="symbology-and-interactivity.html#cb292-1" aria-hidden="true" tabindex="-1"></a>legend<span class="op">.</span><span class="at">onAdd</span> <span class="op">=</span> <span class="kw">function</span>() {</span>
<span id="cb292-2"><a href="symbology-and-interactivity.html#cb292-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> div <span class="op">=</span> L<span class="op">.</span><span class="at">DomUtil</span><span class="op">.</span><span class="fu">create</span>(<span class="st">&quot;div&quot;</span><span class="op">,</span> <span class="st">&quot;legend&quot;</span>)<span class="op">;</span> </span>
<span id="cb292-3"><a href="symbology-and-interactivity.html#cb292-3" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> </span>
<span id="cb292-4"><a href="symbology-and-interactivity.html#cb292-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;b&gt;Population in 2015&lt;/b&gt;&lt;br&gt;by Town&lt;br&gt;&#39;</span> <span class="op">+</span></span>
<span id="cb292-5"><a href="symbology-and-interactivity.html#cb292-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;small&gt;Persons/Town&lt;/small&gt;&lt;br&gt;&#39;</span><span class="op">;</span></span>
<span id="cb292-6"><a href="symbology-and-interactivity.html#cb292-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> breaks<span class="op">.</span><span class="at">length</span><span class="dv">-1</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--</span>) {</span>
<span id="cb292-7"><a href="symbology-and-interactivity.html#cb292-7" aria-hidden="true" tabindex="-1"></a>        div<span class="op">.</span><span class="at">innerHTML</span> <span class="op">+=</span> </span>
<span id="cb292-8"><a href="symbology-and-interactivity.html#cb292-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&#39;&lt;div style=&quot;background-color: &#39;</span> <span class="op">+</span> colors[i<span class="dv">-1</span>] <span class="op">+</span> <span class="st">&#39;&quot;&gt;&lt;/div&gt;&#39;</span> <span class="op">+</span> </span>
<span id="cb292-9"><a href="symbology-and-interactivity.html#cb292-9" aria-hidden="true" tabindex="-1"></a>          breaks[i<span class="dv">-1</span>] <span class="op">+</span> <span class="st">&#39; - &#39;</span> <span class="op">+</span> breaks[i] <span class="op">+</span> <span class="st">&#39;&lt;br&gt;&#39;</span><span class="op">;</span></span>
<span id="cb292-10"><a href="symbology-and-interactivity.html#cb292-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb292-11"><a href="symbology-and-interactivity.html#cb292-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb292-12"><a href="symbology-and-interactivity.html#cb292-12" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>With this alternative definition, the layer symbology and the legend are always in sync, since they are dependent on the same <code>breaks</code> and <code>colors</code> arrays. That way, changing the symbology (adding more breaks, changing the colors, etc.) will be automatically reflected both in town polygon colors and legend icon colors. </p>
</div>
<div id="using-css-to-style-the-legend" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Using CSS to style the legend</h3>
<p>One more thing we need to do regarding our legend is to give it the right placement and appearance, using CSS. The following CSS code is used to style our legend: </p>
<div class="sourceCode" id="cb293"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb293-1"><a href="symbology-and-interactivity.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.legend</span> {</span>
<span id="cb293-2"><a href="symbology-and-interactivity.html#cb293-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">6</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb293-3"><a href="symbology-and-interactivity.html#cb293-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span>: <span class="fu">rgba(</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">0.8</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb293-4"><a href="symbology-and-interactivity.html#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">box-shadow</span>: <span class="dv">0</span> <span class="dv">0</span> <span class="dv">15</span><span class="dt">px</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0.2</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb293-5"><a href="symbology-and-interactivity.html#cb293-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb293-6"><a href="symbology-and-interactivity.html#cb293-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb293-7"><a href="symbology-and-interactivity.html#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="fu">.legend</span> div {</span>
<span id="cb293-8"><a href="symbology-and-interactivity.html#cb293-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">18</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb293-9"><a href="symbology-and-interactivity.html#cb293-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">18</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb293-10"><a href="symbology-and-interactivity.html#cb293-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">float</span>: <span class="dv">left</span><span class="op">;</span></span>
<span id="cb293-11"><a href="symbology-and-interactivity.html#cb293-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin-right</span>: <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb293-12"><a href="symbology-and-interactivity.html#cb293-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">opacity</span>: <span class="dv">0.7</span><span class="op">;</span></span>
<span id="cb293-13"><a href="symbology-and-interactivity.html#cb293-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb293-14"><a href="symbology-and-interactivity.html#cb293-14" aria-hidden="true" tabindex="-1"></a>div<span class="fu">.legend.leaflet-control</span> br {</span>
<span id="cb293-15"><a href="symbology-and-interactivity.html#cb293-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">clear</span>: <span class="dv">both</span><span class="op">;</span></span>
<span id="cb293-16"><a href="symbology-and-interactivity.html#cb293-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In the first CSS rule, we set properties for the legend as a whole, referring to <code>.legend</code>. We are setting padding, background color, box shadow, and border radius. In the second rule, we set our legend symbols (<code>&lt;div&gt;</code> elements) dimensions and also set <code>float: left;</code> so that the the symbols will be aligned into columns. The <code>float: left;</code> property (Section <a href="geojson-1.html#viewer-html-and-css">7.6.2</a>) ensures that the symbols and the text descriptions for each legend entry are placed together, side by side, on the same line. Finally, the third rule makes sure the legend items are correctly <a href="https://stackoverflow.com/questions/43793238/weird-leaflet-map-legend-display#answer-48345365">aligned</a> regardless of browser zoom level. </p>
<p>The towns map <code>example-08-05.html</code>, now with a map legend, is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-05">8.7</a>. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-05"></span>
<iframe src="examples/example-08-05.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.7: <code>example-08-05.html</code> <a href="examples/example-08-05.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
<blockquote>
<ul>
<li>Make a local copy of <code>example-08-05.html</code>.</li>
<li>Replace the code section for defining the <code>towns_color</code> function, to use a <code>for</code> loop instead of <code>if</code>/<code>else</code> conditionals. The alternative code section is given in Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>. Don’t forget to add the <code>breaks</code> and <code>colors</code> array definitions, in addition to the <code>for</code> loop!</li>
<li>Replace the code section for generating HTML contents for the legend, to use a <code>for</code> loop instead of the fixed HTML string. The alternative code section is given in Section <a href="symbology-and-interactivity.html#adding-a-legend">8.6</a>.</li>
<li>You should see few small differences between the <em>labels</em> of each color category in the legends of <code>example-08-05.html</code> (Figure <a href="symbology-and-interactivity.html#fig:example-08-05">8.7</a>) and your modified version. Can you figure out which parts of the code are responsible for those differences? </li>
</ul>
</blockquote>
</div>
</div>
<div id="dynamic-style" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Dynamic style</h2>
<div id="styling-in-response-to-events" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Styling in response to events</h3>
<p>In the previous examples, we learned how to set a <em>constant</em> style, which is the same for all GeoJSON features (Section <a href="symbology-and-interactivity.html#constant-style">8.3</a>), and a <em>variable</em> style, which is dependent on feature properties, such as political party (Section <a href="symbology-and-interactivity.html#states-example">8.4.2</a>) or population size (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>). In both cases, however, the style was determined on page load and remained the same, regardless of subsequent user interaction with the map. In this section, we will see how styling can also be made <em>dynamic</em>. This means the style can change while the user interacts with the page. For example, a specific feature can be highlighted when the user places the mouse cursor above it (Figure <a href="symbology-and-interactivity.html#fig:example-08-06">8.8</a>). Dynamic styling can greatly enhance user experience and is one of the distinctive features of interactive web maps. </p>
<p>To achieve dynamic styling, we need to add event listeners to modify layer style in response to particular events. In the next example, we will add event listeners for changing any feature hovered with the mouse to “highlighted” style. Our event listeners are going to have to respond to <code>"mouseover"</code> and <code>"mouseout"</code> events (Section <a href="javascript-interactivity.html#event-listeners">4.4</a>), and change the respective feature style to “highlighted” or “normal” state, respectively. </p>
<p>Specific event listeners per feature can be binded when loading the GeoJSON layer using the <code>onEachFeature</code> option, similarly to the way we used it to bind specific popups (Section <a href="symbology-and-interactivity.html#constructing-popups-from-data">8.5</a>). Inside the <code>onEachFeature</code> function, we can use the <code>.addEventListener</code> method of <code>layer</code> to add the event listeners. Our code for loading the GeoJSON layer then takes the following form, where <code>highlightFeature</code> and <code>resetHighlight</code>, as their name suggests, are functions for highlighting and resetting feature style: </p>
<div class="sourceCode" id="cb294"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb294-1"><a href="symbology-and-interactivity.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fetch</span>(<span class="st">&quot;data/towns.geojson&quot;</span>)</span>
<span id="cb294-2"><a href="symbology-and-interactivity.html#cb294-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(response) {</span>
<span id="cb294-3"><a href="symbology-and-interactivity.html#cb294-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb294-4"><a href="symbology-and-interactivity.html#cb294-4" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb294-5"><a href="symbology-and-interactivity.html#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(data) {</span>
<span id="cb294-6"><a href="symbology-and-interactivity.html#cb294-6" aria-hidden="true" tabindex="-1"></a>        geojson <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJSON</span>(data<span class="op">,</span> {</span>
<span id="cb294-7"><a href="symbology-and-interactivity.html#cb294-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">style</span><span class="op">:</span> towns_style<span class="op">,</span></span>
<span id="cb294-8"><a href="symbology-and-interactivity.html#cb294-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">onEachFeature</span><span class="op">:</span> <span class="kw">function</span>(feature<span class="op">,</span> layer) {</span>
<span id="cb294-9"><a href="symbology-and-interactivity.html#cb294-9" aria-hidden="true" tabindex="-1"></a>                layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseover&quot;</span><span class="op">,</span> highlightFeature)<span class="op">;</span></span>
<span id="cb294-10"><a href="symbology-and-interactivity.html#cb294-10" aria-hidden="true" tabindex="-1"></a>                layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseout&quot;</span><span class="op">,</span> resetHighlight)<span class="op">;</span></span>
<span id="cb294-11"><a href="symbology-and-interactivity.html#cb294-11" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb294-12"><a href="symbology-and-interactivity.html#cb294-12" aria-hidden="true" tabindex="-1"></a>        })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb294-13"><a href="symbology-and-interactivity.html#cb294-13" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span></code></pre></div>
<p>The above code means that whenever we enter or leave a GeoJSON feature with the mouse, the <code>highlightFeature</code> or <code>resetHighlight</code> function will be executed, respectively. These functions (defined below) will be responsible for changing the feature style to “highlighted” or “normal,” respectively. </p>
<p>One more thing introduced in this code section is that the <em>reference</em> to the GeoJSON layer is assigned to a variable, hereby named <code>geojson</code>. This will be useful shortly, when we will use the reference to the GeoJSON layer to execute its methods. Since we are assigning a value to the <code>geojson</code> variable, we should define it with an expression such as the following one, at the beginning of our script: </p>
<div class="sourceCode" id="cb295"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb295-1"><a href="symbology-and-interactivity.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> geojson<span class="op">;</span></span></code></pre></div>
<p>How can we make sure we highlight the <em>specific</em> feature which triggered the event, i.e., the one we enter with the mouse, rather than any other feature? This brings us back to the <strong>event object</strong>, introduced in Section <a href="javascript-interactivity.html#the-event-object">4.10</a> and further discussed in Section <a href="leaflet.html#introducing-map-events">6.9</a>. For example, in Section <a href="leaflet.html#introducing-map-events">6.9</a> we used the event object property named <code>.latlng</code> to obtain and display the clicked map coordinates within a popup (Section <a href="leaflet.html#fig:example-06-08">6.15</a>). In the present case, we use <code>.target</code> event object property (Section <a href="javascript-interactivity.html#event-target">4.10.2</a>) to get the reference to the page element which <em>triggered</em> the event, i.e., a reference to the hovered feature. </p>
<p>To understand what exactly the <code>.target</code> property contains when referring to a GeoJSON layer, we can manually create a reference to an individual feature in our GeoJSON layer <code>geojson</code> using the following expression, where <code>100</code> is the ID of a specific feature: </p>
<div class="sourceCode" id="cb296"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb296-1"><a href="symbology-and-interactivity.html#cb296-1" aria-hidden="true" tabindex="-1"></a>geojson<span class="op">.</span><span class="at">_layers</span>[<span class="dv">100</span>]<span class="op">;</span></span></code></pre></div>
<p>The ID values are arbitrary numbers, automatically generated by Leaflet. When necessary, however, we can always set our own IDs when the layer is created, again using the <code>onEachFeature</code> option (Section <a href="symbology-and-interactivity.html#linked-views">8.7.3</a>). The reference to a specific GeoJSON feature, such as <code>geojson._layers[100]</code>, contains numerous useful methods. Importantly, it has the following two methods that are useful for dynamic styling: </p>
<ul>
<li><code>.setStyle</code>—Changes the style of the respective feature</li>
<li><code>.bringToFront</code>—Moves the feature to the front, in terms of display order</li>
</ul>
<p>In addition, the entire GeoJSON layer object (such as <code>geojson</code>, in our example) has a method named <code>.resetStyle</code>. The <code>.resetStyle</code> method accepts a feature reference and resets the feature style back to the original GeoJSON style. Using these three methods, together with the <code>.target</code> property of the event object, our <code>highlightFeature</code> and <code>resetHighlight</code> functions can be defined as follows: </p>
<div class="sourceCode" id="cb297"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb297-1"><a href="symbology-and-interactivity.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">highlightFeature</span>(e) {</span>
<span id="cb297-2"><a href="symbology-and-interactivity.html#cb297-2" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">setStyle</span>({<span class="dt">weight</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;yellow&quot;</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">;</span></span>
<span id="cb297-3"><a href="symbology-and-interactivity.html#cb297-3" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb297-4"><a href="symbology-and-interactivity.html#cb297-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb297-5"><a href="symbology-and-interactivity.html#cb297-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-6"><a href="symbology-and-interactivity.html#cb297-6" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">resetHighlight</span>(e) {</span>
<span id="cb297-7"><a href="symbology-and-interactivity.html#cb297-7" aria-hidden="true" tabindex="-1"></a>    geojson<span class="op">.</span><span class="fu">resetStyle</span>(e<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb297-8"><a href="symbology-and-interactivity.html#cb297-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The object passed to the <code>.setStyle</code> method contains the “highlighted” style definition, namely:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb298-1"><a href="symbology-and-interactivity.html#cb298-1" aria-hidden="true" tabindex="-1"></a>{<span class="dt">weight</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;yellow&quot;</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>}</span></code></pre></div>
<p>This style defnition object specifies that the highlighted feature border becomes wider and its border color becomes yellow. The fill color of the highlighted feature also becomes more transparent, since in the default town polygon style we used an opacity of <code>0.7</code> (Section <a href="symbology-and-interactivity.html#towns-example">8.4.3</a>), whereas in the highlighted style we set fill opacity to <code>0.5</code>. </p>
<p>How do the <code>highlightFeature</code> and <code>resetHighlight</code> functions work in conjugation with the style object? First of all, both functions accept the event object parameter <code>e</code>, which means the executed code can be customized to the particular properties of the event. Indeed, both functions use the <code>.target</code> property of the event object (<code>e.target</code>), which is a reference to the particular feature that triggered the event, i.e., the feature we are <em>entering</em> or <em>leaving</em> with the mouse cursor. Determining the specific feature we wish to highlight or to “reset,” hereby achieved with <code>e.target</code>, is crucial for dynamic styling. </p>
<p>On <strong>mouse enter</strong>, once the hovered feature was identified using <code>e.target</code>, the <code>highlightFeature</code> function uses the <code>.setStyle</code> method to set highlighted style (defined in the style object) on the target feature. Then, the referenced feature is brought to front using the <code>.bringToFront</code> method, so that its borders—which are now highlighted—will not be obstructed by neighboring features on the map. On <strong>mouse leave</strong>, the <code>resetHighlight</code> function resets the styling using the <code>.resetStyle</code> method of the <code>geojson</code> layer, accepting the specific feature being “left” as its argument. This reverts the feature style back to the default one. </p>
<p>The resulting map <code>example-08-06.html</code> is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-06">8.8</a>. The town polygon being hovered with the mouse (e.g., Tel-Aviv) is highlighted in yellow. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-06"></span>
<iframe src="examples/example-08-06.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.8: <code>example-08-06.html</code> <a href="examples/example-08-06.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
</div>
<div id="dynamic-control-contents" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Dynamic control contents</h3>
<p>In addition to visually emphasizing the hovered feature, we may also want some other things to happen on our web page, reflecting the identity of the hovered feature in other ways. For example, we can have a dynamically updated <strong>information box</strong>, where relevant textual information about the feature is being displayed. This can be considered as an alternative to popups. The advantage of an information box over a popup<a href="#fn84" class="footnote-ref" id="fnref84"><sup>84</sup></a> is that the user does not need to <em>click</em> on each feature they want to get information on but just to <em>hover</em> with the mouse (Figure <a href="symbology-and-interactivity.html#fig:example-08-07">8.9</a>). </p>
<p>In the following <code>example-08-07.html</code>, we are going to add an information box displaying the name and population size of the currently hovered town, similarly to the information that was shown in the popups in <code>example-08-04.html</code> (Figure <a href="symbology-and-interactivity.html#fig:example-08-04">8.6</a>). The same <code>L.control</code> technique used above to add a legend (Section <a href="symbology-and-interactivity.html#adding-a-legend">8.6</a>) can be used to initialize the information box: </p>
<div class="sourceCode" id="cb299"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb299-1"><a href="symbology-and-interactivity.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> info <span class="op">=</span> L<span class="op">.</span><span class="fu">control</span>({<span class="dt">position</span><span class="op">:</span> <span class="st">&quot;topright&quot;</span>})<span class="op">;</span></span>
<span id="cb299-2"><a href="symbology-and-interactivity.html#cb299-2" aria-hidden="true" tabindex="-1"></a>info<span class="op">.</span><span class="at">onAdd</span> <span class="op">=</span> <span class="kw">function</span>() {</span>
<span id="cb299-3"><a href="symbology-and-interactivity.html#cb299-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> div <span class="op">=</span> L<span class="op">.</span><span class="at">DomUtil</span><span class="op">.</span><span class="fu">create</span>(<span class="st">&quot;div&quot;</span><span class="op">,</span> <span class="st">&quot;info&quot;</span>)<span class="op">;</span></span>
<span id="cb299-4"><a href="symbology-and-interactivity.html#cb299-4" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&lt;h4&gt;Towns in Israel&lt;/h4&gt;&lt;p id=&quot;currentTown&quot;&gt;&lt;/p&gt;&#39;</span><span class="op">;</span></span>
<span id="cb299-5"><a href="symbology-and-interactivity.html#cb299-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb299-6"><a href="symbology-and-interactivity.html#cb299-6" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb299-7"><a href="symbology-and-interactivity.html#cb299-7" aria-hidden="true" tabindex="-1"></a>info<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span></code></pre></div>
<p>Initially, the information box contains just a heading (“Towns in Israel”) and an <em>empty</em> paragraph with <code>id="currentTown"</code>. The paragraph will not always remain empty; it will be dynamically updated, using an event listener, every time the mouse cursor hovers over the towns layer. Before we go into the definition of the event listener, we will add some CSS code to make the information box look nicer, just like we did with the legend (Section <a href="symbology-and-interactivity.html#adding-a-legend">8.6</a>): </p>
<div class="sourceCode" id="cb300"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb300-1"><a href="symbology-and-interactivity.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.info</span> {</span>
<span id="cb300-2"><a href="symbology-and-interactivity.html#cb300-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">6</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb300-3"><a href="symbology-and-interactivity.html#cb300-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font</span>: <span class="dv">14</span><span class="dt">px</span>/<span class="dv">16</span><span class="dt">px</span> Arial<span class="op">,</span> Helvetica<span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb300-4"><a href="symbology-and-interactivity.html#cb300-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="fu">rgba(</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">0.8</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb300-5"><a href="symbology-and-interactivity.html#cb300-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">box-shadow</span>: <span class="dv">0</span> <span class="dv">0</span> <span class="dv">15</span><span class="dt">px</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0.2</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb300-6"><a href="symbology-and-interactivity.html#cb300-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb300-7"><a href="symbology-and-interactivity.html#cb300-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">10</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb300-8"><a href="symbology-and-interactivity.html#cb300-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb300-9"><a href="symbology-and-interactivity.html#cb300-9" aria-hidden="true" tabindex="-1"></a><span class="fu">.info</span> h4 {</span>
<span id="cb300-10"><a href="symbology-and-interactivity.html#cb300-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">0</span> <span class="dv">0</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb300-11"><a href="symbology-and-interactivity.html#cb300-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#777777</span><span class="op">;</span></span>
<span id="cb300-12"><a href="symbology-and-interactivity.html#cb300-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb300-13"><a href="symbology-and-interactivity.html#cb300-13" aria-hidden="true" tabindex="-1"></a><span class="fu">.info</span> <span class="pp">#currentTown</span> {</span>
<span id="cb300-14"><a href="symbology-and-interactivity.html#cb300-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">6</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb300-15"><a href="symbology-and-interactivity.html#cb300-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>As discussed in Section <a href="symbology-and-interactivity.html#styling-in-response-to-events">8.7.1</a>, the <code>.target</code> property of the event object—considering an event fired by a GeoJSON layer—is a reference to the specific feature being hovered with the mouse cursor. For instance, in <code>example-08-06.html</code> we used the <code>.setStyle</code> and the <code>.bringToFront</code> methods of the currently hovered feature to highlight it on mouse hover (Figure <a href="symbology-and-interactivity.html#fig:example-08-06">8.8</a>). The <code>.target</code> property of the event object also contains an internal property called <code>.feature</code>, which contains the specific GeoJSON <em>feature</em> (Section <a href="geojson-1.html#features">7.3.3</a>) the mouse pointer intersects, along with all of its properties.</p>
<p>The expanded <code>highlightFeature</code> function (below) uses the <code>properties</code> of the GeoJSON feature to capture the name <code>name_eng</code> and population size value <code>pop_2015</code> of the currently hovered town. These two values are used to update the paragraph in the information box, using the <code>.innerHTML</code> property: </p>
<div class="sourceCode" id="cb301"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb301-1"><a href="symbology-and-interactivity.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> info_p <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;currentTown&quot;</span>)<span class="op">;</span></span>
<span id="cb301-2"><a href="symbology-and-interactivity.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">highlightFeature</span>(e) {</span>
<span id="cb301-3"><a href="symbology-and-interactivity.html#cb301-3" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">setStyle</span>(highlightStyle)<span class="op">;</span></span>
<span id="cb301-4"><a href="symbology-and-interactivity.html#cb301-4" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb301-5"><a href="symbology-and-interactivity.html#cb301-5" aria-hidden="true" tabindex="-1"></a>    info_p<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span></span>
<span id="cb301-6"><a href="symbology-and-interactivity.html#cb301-6" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">name_eng</span> <span class="op">+</span> <span class="st">&quot;&lt;br&gt;&quot;</span> <span class="op">+</span> </span>
<span id="cb301-7"><a href="symbology-and-interactivity.html#cb301-7" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">pop_2015</span> <span class="op">+</span> <span class="st">&quot; people&quot;</span><span class="op">;</span></span>
<span id="cb301-8"><a href="symbology-and-interactivity.html#cb301-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Accordingly, in the expanded version of the <code>resetHighlight</code> function, we now need to <em>clear</em> the text message when the mouse cursor leaves the feature. This can be done by setting the paragraph contents back to an empty string (<code>""</code>): </p>
<div class="sourceCode" id="cb302"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb302-1"><a href="symbology-and-interactivity.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">resetHighlight</span>(e) {</span>
<span id="cb302-2"><a href="symbology-and-interactivity.html#cb302-2" aria-hidden="true" tabindex="-1"></a>    geojson<span class="op">.</span><span class="fu">resetStyle</span>(e<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb302-3"><a href="symbology-and-interactivity.html#cb302-3" aria-hidden="true" tabindex="-1"></a>    info_p<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb302-4"><a href="symbology-and-interactivity.html#cb302-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The resulting map <code>example-08-07.html</code>, now with both the dynamic styling and the information box<a href="#fn85" class="footnote-ref" id="fnref85"><sup>85</sup></a>, is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-07">8.9</a>. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-07"></span>
<iframe src="examples/example-08-07.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.9: <code>example-08-07.html</code> <a href="examples/example-08-07.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
</div>
<div id="linked-views" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> Linked views</h3>
<p>There is an infinite amount of interactive behaviors that can be incorporated into web maps, the ones we covered in Sections <a href="symbology-and-interactivity.html#styling-in-response-to-events">8.7.1</a>–<a href="symbology-and-interactivity.html#dynamic-control-contents">8.7.2</a> being just one example. The important take-home message from the example is that, using JavaScript, the spatial entities displayed on our web map can be linked with other elements so that the map responds to user interaction in various ways. Moreover, the interaction is not necessarily limited to the map itself: we can associate the map with other elements on our page outside of the map <code>&lt;div&gt;</code>. This leads us to the idea of <strong>linked views</strong>. </p>
<p>Linked views are one of the most important concepts in interactive data visualization. The term refers to the situation when the same data are shown from different <em>points of view</em>, or different ways, while synchronizing user actions across all of those views. With web mapping, this usually means that in addition to a web map, our page contains one or more other panels, displaying information about the same spatial features in different ways: tables, graphs, lists, and so on. User selection on the map is reflected on the other panels, such as filtering the tables, highlighting data points on graphs, etc., and the other way around. </p>
<p>The following <code>example-08-08.html</code> (Figure <a href="symbology-and-interactivity.html#fig:example-08-08">8.10</a>) implements a link between a web map and a <em>list</em>. Whenever a polygon of a given town is hovered on the map, the polygon itself as well as the corresponding entry in the towns list are highlighted. Similarly, whenever a town name is hovered on the list, the list item itself as well as the corresponding polygon are highlighted. This is mostly accomplished with methods we already covered in previous Chapters <a href="javascript-interactivity.html#javascript-interactivity">4</a>–<a href="geojson-1.html#geojson-1">7</a>, except for several techniques<a href="#fn86" class="footnote-ref" id="fnref86"><sup>86</sup></a>. The key to the association between the list and the GeoJSON layer is that both the list items and the GeoJSON features are assigned with matching IDs when loading the GeoJSON layer: </p>
<div class="sourceCode" id="cb303"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb303-1"><a href="symbology-and-interactivity.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">onEachFeature</span>(feature<span class="op">,</span> layer) {</span>
<span id="cb303-2"><a href="symbology-and-interactivity.html#cb303-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> town <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">town</span><span class="op">;</span></span>
<span id="cb303-3"><a href="symbology-and-interactivity.html#cb303-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> name_eng <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">name_eng</span><span class="op">;</span></span>
<span id="cb303-4"><a href="symbology-and-interactivity.html#cb303-4" aria-hidden="true" tabindex="-1"></a>    html <span class="op">+=</span> <span class="st">&#39;&lt;li id=&quot;&#39;</span> <span class="op">+</span> town <span class="op">+</span> <span class="st">&#39;&quot;&gt;&#39;</span> <span class="op">+</span> name_eng <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="cb303-5"><a href="symbology-and-interactivity.html#cb303-5" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="at">_leaflet_id</span> <span class="op">=</span> town<span class="op">;</span></span>
<span id="cb303-6"><a href="symbology-and-interactivity.html#cb303-6" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseover&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb303-7"><a href="symbology-and-interactivity.html#cb303-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_feature <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb303-8"><a href="symbology-and-interactivity.html#cb303-8" aria-hidden="true" tabindex="-1"></a>        hovered_feature<span class="op">.</span><span class="fu">setStyle</span>(highlightStyle)<span class="op">;</span></span>
<span id="cb303-9"><a href="symbology-and-interactivity.html#cb303-9" aria-hidden="true" tabindex="-1"></a>        hovered_feature<span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb303-10"><a href="symbology-and-interactivity.html#cb303-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(hovered_feature<span class="op">.</span><span class="at">_leaflet_id</span>)<span class="op">;</span></span>
<span id="cb303-11"><a href="symbology-and-interactivity.html#cb303-11" aria-hidden="true" tabindex="-1"></a>        el<span class="op">.</span><span class="fu">scrollIntoView</span>({</span>
<span id="cb303-12"><a href="symbology-and-interactivity.html#cb303-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">behavior</span><span class="op">:</span> <span class="st">&quot;auto&quot;</span><span class="op">,</span></span>
<span id="cb303-13"><a href="symbology-and-interactivity.html#cb303-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">block</span><span class="op">:</span> <span class="st">&quot;center&quot;</span><span class="op">,</span></span>
<span id="cb303-14"><a href="symbology-and-interactivity.html#cb303-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">inline</span><span class="op">:</span> <span class="st">&quot;center&quot;</span></span>
<span id="cb303-15"><a href="symbology-and-interactivity.html#cb303-15" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb303-16"><a href="symbology-and-interactivity.html#cb303-16" aria-hidden="true" tabindex="-1"></a>        el<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb303-17"><a href="symbology-and-interactivity.html#cb303-17" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb303-18"><a href="symbology-and-interactivity.html#cb303-18" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseout&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb303-19"><a href="symbology-and-interactivity.html#cb303-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_feature <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb303-20"><a href="symbology-and-interactivity.html#cb303-20" aria-hidden="true" tabindex="-1"></a>        geojson<span class="op">.</span><span class="fu">resetStyle</span>(hovered_feature)<span class="op">;</span></span>
<span id="cb303-21"><a href="symbology-and-interactivity.html#cb303-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(hovered_feature<span class="op">.</span><span class="at">_leaflet_id</span>)<span class="op">;</span></span>
<span id="cb303-22"><a href="symbology-and-interactivity.html#cb303-22" aria-hidden="true" tabindex="-1"></a>        el<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb303-23"><a href="symbology-and-interactivity.html#cb303-23" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb303-24"><a href="symbology-and-interactivity.html#cb303-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In the above function, passed to the <code>onEachFeature</code> option and thus executed on each GeoJSON feature, the current town ID is captured in a variable called <code>town</code>. We use numeric town codes, which are stored in the <code>towns.geojson</code> file, in a GeoJSON property also named <code>town</code>: </p>
<div class="sourceCode" id="cb304"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb304-1"><a href="symbology-and-interactivity.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> town <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">town</span><span class="op">;</span></span></code></pre></div>
<p>Then, the following expression assigns the town ID as the <code>id</code> attribute of each list item when preparing the <code>&lt;ul&gt;</code> HTML code: </p>
<div class="sourceCode" id="cb305"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb305-1"><a href="symbology-and-interactivity.html#cb305-1" aria-hidden="true" tabindex="-1"></a>html <span class="op">+=</span> <span class="st">&#39;&lt;li id=&quot;&#39;</span> <span class="op">+</span> town <span class="op">+</span> <span class="st">&#39;&quot;&gt;&#39;</span> <span class="op">+</span> name_eng <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span></code></pre></div>
<p>Correspondingly, the following expression assigns the town ID to the <code>_leaflet_id</code> property of the corresponding Leaflet layer feature: </p>
<div class="sourceCode" id="cb306"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb306-1"><a href="symbology-and-interactivity.html#cb306-1" aria-hidden="true" tabindex="-1"></a>layer<span class="op">.</span><span class="at">_leaflet_id</span> <span class="op">=</span> town<span class="op">;</span></span></code></pre></div>
<p>While the GeoJSON layer is being loaded, the following code section attaches event listeners for <code>"mouseover"</code> and <code>"mouseout"</code> on each feature: </p>
<div class="sourceCode" id="cb307"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb307-1"><a href="symbology-and-interactivity.html#cb307-1" aria-hidden="true" tabindex="-1"></a>layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseover&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb307-2"><a href="symbology-and-interactivity.html#cb307-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> hovered_feature <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb307-3"><a href="symbology-and-interactivity.html#cb307-3" aria-hidden="true" tabindex="-1"></a>    hovered_feature<span class="op">.</span><span class="fu">setStyle</span>(highlightStyle)<span class="op">;</span></span>
<span id="cb307-4"><a href="symbology-and-interactivity.html#cb307-4" aria-hidden="true" tabindex="-1"></a>    hovered_feature<span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb307-5"><a href="symbology-and-interactivity.html#cb307-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(hovered_feature<span class="op">.</span><span class="at">_leaflet_id</span>)<span class="op">;</span></span>
<span id="cb307-6"><a href="symbology-and-interactivity.html#cb307-6" aria-hidden="true" tabindex="-1"></a>    el<span class="op">.</span><span class="fu">scrollIntoView</span>({</span>
<span id="cb307-7"><a href="symbology-and-interactivity.html#cb307-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">behavior</span><span class="op">:</span> <span class="st">&quot;auto&quot;</span><span class="op">,</span></span>
<span id="cb307-8"><a href="symbology-and-interactivity.html#cb307-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">block</span><span class="op">:</span> <span class="st">&quot;center&quot;</span><span class="op">,</span></span>
<span id="cb307-9"><a href="symbology-and-interactivity.html#cb307-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">inline</span><span class="op">:</span> <span class="st">&quot;center&quot;</span></span>
<span id="cb307-10"><a href="symbology-and-interactivity.html#cb307-10" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb307-11"><a href="symbology-and-interactivity.html#cb307-11" aria-hidden="true" tabindex="-1"></a>    el<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb307-12"><a href="symbology-and-interactivity.html#cb307-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb307-13"><a href="symbology-and-interactivity.html#cb307-13" aria-hidden="true" tabindex="-1"></a>layer<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseout&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb307-14"><a href="symbology-and-interactivity.html#cb307-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> hovered_feature <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb307-15"><a href="symbology-and-interactivity.html#cb307-15" aria-hidden="true" tabindex="-1"></a>    geojson<span class="op">.</span><span class="fu">resetStyle</span>(hovered_feature)<span class="op">;</span></span>
<span id="cb307-16"><a href="symbology-and-interactivity.html#cb307-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(hovered_feature<span class="op">.</span><span class="at">_leaflet_id</span>)<span class="op">;</span></span>
<span id="cb307-17"><a href="symbology-and-interactivity.html#cb307-17" aria-hidden="true" tabindex="-1"></a>    el<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb307-18"><a href="symbology-and-interactivity.html#cb307-18" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>The event listeners take care of setting or resetting the polygon style, like we did in <code>example-08-06.html</code> (Section <a href="symbology-and-interactivity.html#fig:example-08-06">8.8</a>), and the <code>&lt;li&gt;</code> list item style, which is new to us. Note how the targeted <code>&lt;li&gt;</code> element corresponding to the hovered polygon is detected using the <code>hovered_feature._leaflet_id</code> property—this is the town ID which was assigned on GeoJSON layer load as shown above. </p>
<p>Once the layer is loaded, event listeners are binded to the list items too using iteration (Section <a href="javascript-interactivity.html#making-multiple-selections">4.7.2</a>), with the following code section where <code>"#townslist li"</code> selector targets all <code>&lt;li&gt;</code> elements: </p>
<div class="sourceCode" id="cb308"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb308-1"><a href="symbology-and-interactivity.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&quot;#townslist li&quot;</span>)<span class="op">;</span></span>
<span id="cb308-2"><a href="symbology-and-interactivity.html#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> el<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb308-3"><a href="symbology-and-interactivity.html#cb308-3" aria-hidden="true" tabindex="-1"></a>    el[i]<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseover&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb308-4"><a href="symbology-and-interactivity.html#cb308-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_item <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb308-5"><a href="symbology-and-interactivity.html#cb308-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_id <span class="op">=</span> hovered_item<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb308-6"><a href="symbology-and-interactivity.html#cb308-6" aria-hidden="true" tabindex="-1"></a>        hovered_item<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb308-7"><a href="symbology-and-interactivity.html#cb308-7" aria-hidden="true" tabindex="-1"></a>        geojson<span class="op">.</span><span class="fu">getLayer</span>(hovered_id)<span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">.</span><span class="fu">setStyle</span>(highlightStyle)<span class="op">;</span></span>
<span id="cb308-8"><a href="symbology-and-interactivity.html#cb308-8" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb308-9"><a href="symbology-and-interactivity.html#cb308-9" aria-hidden="true" tabindex="-1"></a>    el[i]<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;mouseout&quot;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb308-10"><a href="symbology-and-interactivity.html#cb308-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_item <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb308-11"><a href="symbology-and-interactivity.html#cb308-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> hovered_id <span class="op">=</span> hovered_item<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb308-12"><a href="symbology-and-interactivity.html#cb308-12" aria-hidden="true" tabindex="-1"></a>        geojson<span class="op">.</span><span class="fu">resetStyle</span>(geojson<span class="op">.</span><span class="fu">getLayer</span>(hovered_id))<span class="op">;</span></span>
<span id="cb308-13"><a href="symbology-and-interactivity.html#cb308-13" aria-hidden="true" tabindex="-1"></a>        hovered_item<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&quot;highlight&quot;</span>)<span class="op">;</span></span>
<span id="cb308-14"><a href="symbology-and-interactivity.html#cb308-14" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb308-15"><a href="symbology-and-interactivity.html#cb308-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>These event listeners mirror the previous ones, meaning that now hovering on the list, rather than the layer, is the triggering event.</p>
<p>The final result <code>example-08-08.html</code> is shown in Figure <a href="symbology-and-interactivity.html#fig:example-08-08">8.10</a>. All of the above may seem like a lot of work for a fairly simple effect, as we had to explicitly define each and every detail of the interactive behavior in our web map. However, consider the fact that using the presented methods there is complete freedom to build any type of innovative interactive behavior. </p>
<div class="figure" style="text-align: center"><span id="fig:example-08-08"></span>
<iframe src="examples/example-08-08.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.10: <code>example-08-08.html</code> <a href="examples/example-08-08.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>
</div>
</div>
<div id="exercise-08" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Exercise</h2>
<ul>
<li>Adapt the code of <code>example-08-05.html</code> (Figure <a href="symbology-and-interactivity.html#fig:example-08-05">8.7</a>) so that the map displays population <em>density</em> instead of count, i.e., number of people per km<sup>2</sup>, rather then number of people in each polygon.</li>
<li>To do that, follow these steps:
<ul>
<li>Replace the argument of the <code>towns_color</code> function with the expression <code>feature.properties.pop_2015/feature.properties.area_km2</code>, so that polygon fill color is a function of population per area, i.e., density.</li>
<li>Replace the color breaks with the quantiles of population density: <code>[-Infinity, 89, 224, 698, 2734, Infinity]</code>.</li>
<li>Adapt the code for building the popups (Section <a href="symbology-and-interactivity.html#constructing-popups-from-data">8.5</a>) and the map legend (Section <a href="symbology-and-interactivity.html#adding-a-legend">8.6</a>) to reflect the new scale (Figure <a href="symbology-and-interactivity.html#fig:solution-08">8.11</a>).</li>
</ul></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:solution-08"></span>
<iframe src="examples/solution-08.html" width="100%" height="400px">
</iframe>
<p class="caption">
FIGURE 8.11: <code>solution-08.html</code> <a href="examples/solution-08.html" title="View the Example" target="_blank">(Click to view this example on its own)</a>
</p>
</div>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-dent2008cartography" class="csl-entry">
Dent, Borden D, Jeffrey S Torguson, and Thomas W Hodler. 2008. <em>Cartography: Thematic Map Design</em>. 6th ed. New York, NY, USA: WCB/McGraw-Hill Boston.
</div>
<div id="ref-qgis_software" class="csl-entry">
QGIS Development Team. 2018. <em>QGIS Geographic Information System</em>. Open Source Geospatial Foundation. <a href="http://qgis.osgeo.org/">http://qgis.osgeo.org</a>.
</div>
<div id="ref-tufte2001quantitative" class="csl-entry">
Tufte, Edward. 2001. <em>The Quantitative Display of Information</em>. 2nd ed. Cheshire, CT, USA: Graphics Press.
</div>
<div id="ref-wilke2019fundamentals" class="csl-entry">
Wilke, Claus O. 2019. <em>Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures</em>. Sebastopol, CA, USA: O’Reilly Media, Inc.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="80">
<li id="fn80"><p>The full list of styling options can be found in the <em>Path Options</em> (<a href="https://leafletjs.com/reference-1.7.1.html#path-option" class="uri">https://leafletjs.com/reference-1.7.1.html#path-option</a>) section in the Leaflet documentation.<a href="symbology-and-interactivity.html#fnref80" class="footnote-back">↩︎</a></p></li>
<li id="fn81"><p>This specific case is called <em>quartiles</em> (<a href="https://en.wikipedia.org/wiki/Quartile" class="uri">https://en.wikipedia.org/wiki/Quartile</a>).<a href="symbology-and-interactivity.html#fnref81" class="footnote-back">↩︎</a></p></li>
<li id="fn82"><p>In a qualitative scale, it makes sense to choose intuitively interpretable colors whenever possible, e.g., built area = grey, water body = blue, forest = green, etc.<a href="symbology-and-interactivity.html#fnref82" class="footnote-back">↩︎</a></p></li>
<li id="fn83"><p>Note that the loop goes over the <code>breaks</code> and <code>colors</code> arrays in reverse order, so that the legend entries are ordered from highest (on top) to lowest (at the bottom).<a href="symbology-and-interactivity.html#fnref83" class="footnote-back">↩︎</a></p></li>
<li id="fn84"><p>Another option way of displaying information about a feature without requiring the user to click on it is to use a <em>tooltip</em>. A tooltip is similar to a popup, but opens and closes on mouse hover instead of mouse click. See the Leaflet documentation (<a href="https://leafletjs.com/reference-1.7.1.html#tooltip" class="uri">https://leafletjs.com/reference-1.7.1.html#tooltip</a>) for details and usage.<a href="symbology-and-interactivity.html#fnref84" class="footnote-back">↩︎</a></p></li>
<li id="fn85"><p>Check out the <em>Leaflet Interactive Choropleth Map</em> tutorial (<a href="https://leafletjs.com/examples/choropleth/" class="uri">https://leafletjs.com/examples/choropleth/</a>) for a walk-through of another example for setting symbology and interactive behavior in a Leaflet map.<a href="symbology-and-interactivity.html#fnref85" class="footnote-back">↩︎</a></p></li>
<li id="fn86"><p>This example is slightly more complex than other examples in the book, and we do not cover its code in as much detail as elsewhere in the book. It is provided mainly to demonstrate the idea of linked views and the principles of implementing it. Readers who are interested in using this approach in their work should carefully go over the code of <code>example-08-08.html</code> after reading this section.<a href="symbology-and-interactivity.html#fnref86" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geojson-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="databases.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 2,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "../../mathjax.rstudio.com/2.7.2/MathJaxb198.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>


<!-- Mirrored from 132.72.155.230:3838/js/symbology-and-interactivity.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jan 2022 06:38:02 GMT -->
</html>
