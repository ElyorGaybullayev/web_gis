<!DOCTYPE html>
<html lang="" xml:lang="">

<!-- Mirrored from 132.72.155.230:3838/js/setting-up-an-sql-api.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jan 2022 07:00:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>H Setting up an SQL API | Introduction to Web Mapping</title>
  <meta name="description" content="H Setting up an SQL API | Introduction to Web Mapping" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="H Setting up an SQL API | Introduction to Web Mapping" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="H Setting up an SQL API | Introduction to Web Mapping" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="H Setting up an SQL API | Introduction to Web Mapping" />
  
  <meta name="twitter:description" content="H Setting up an SQL API | Introduction to Web Mapping" />
  

<meta name="author" content="Michael Dorman" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="additional-questions.html"/>
<link rel="next" href="setting-up-a-static-server-using-r.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134641614-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134641614-1');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="index.html"><img width="90%" style="margin: 5% 5% 0% 5%" src="images/BGUsig3E.svg"></a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#what-is-web-mapping"><i class="fa fa-check"></i><b>0.1</b> What is web mapping?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#what-is-javascript"><i class="fa fa-check"></i><b>0.2</b> What is JavaScript?</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#why-use-javascript-for-web-mapping"><i class="fa fa-check"></i><b>0.3</b> Why use JavaScript for web mapping?</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>0.4</b> Learning objectives</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>0.5</b> Software</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#background-knowledge"><i class="fa fa-check"></i><b>0.6</b> Background knowledge</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#online-version"><i class="fa fa-check"></i><b>0.7</b> Online version</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>0.8</b> Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to Web Technologies</b></span></li>
<li class="chapter" data-level="1" data-path="html.html"><a href="html.html"><i class="fa fa-check"></i><b>1</b> HTML</a>
<ul>
<li class="chapter" data-level="1.1" data-path="html.html"><a href="html.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="html.html"><a href="html.html#how-do-people-access-the-web"><i class="fa fa-check"></i><b>1.2</b> How do people access the web?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="html.html"><a href="html.html#web-browsers"><i class="fa fa-check"></i><b>1.2.1</b> Web browsers</a></li>
<li class="chapter" data-level="1.2.2" data-path="html.html"><a href="html.html#web-servers"><i class="fa fa-check"></i><b>1.2.2</b> Web servers</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="html.html"><a href="html.html#web-pages"><i class="fa fa-check"></i><b>1.3</b> Web pages</a></li>
<li class="chapter" data-level="1.4" data-path="html.html"><a href="html.html#text-editors"><i class="fa fa-check"></i><b>1.4</b> Text editors</a></li>
<li class="chapter" data-level="1.5" data-path="html.html"><a href="html.html#what-is-html"><i class="fa fa-check"></i><b>1.5</b> What is HTML?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="html.html"><a href="html.html#overview-html"><i class="fa fa-check"></i><b>1.5.1</b> Overview</a></li>
<li class="chapter" data-level="1.5.2" data-path="html.html"><a href="html.html#html-comments"><i class="fa fa-check"></i><b>1.5.2</b> HTML comments</a></li>
<li class="chapter" data-level="1.5.3" data-path="html.html"><a href="html.html#block-vs-inline"><i class="fa fa-check"></i><b>1.5.3</b> Block vs. inline</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="html.html"><a href="html.html#common-html-elements"><i class="fa fa-check"></i><b>1.6</b> Common HTML elements</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="html.html"><a href="html.html#html-element-types"><i class="fa fa-check"></i><b>1.6.1</b> HTML element types</a></li>
<li class="chapter" data-level="1.6.2" data-path="html.html"><a href="html.html#html-structure"><i class="fa fa-check"></i><b>1.6.2</b> Structure</a></li>
<li class="chapter" data-level="1.6.3" data-path="html.html"><a href="html.html#title-and-metadata"><i class="fa fa-check"></i><b>1.6.3</b> Title and metadata</a></li>
<li class="chapter" data-level="1.6.4" data-path="html.html"><a href="html.html#styling-and-scripts"><i class="fa fa-check"></i><b>1.6.4</b> Styling and scripts</a></li>
<li class="chapter" data-level="1.6.5" data-path="html.html"><a href="html.html#headings-and-paragraphs"><i class="fa fa-check"></i><b>1.6.5</b> Headings and paragraphs</a></li>
<li class="chapter" data-level="1.6.6" data-path="html.html"><a href="html.html#font-formatting"><i class="fa fa-check"></i><b>1.6.6</b> Font formatting</a></li>
<li class="chapter" data-level="1.6.7" data-path="html.html"><a href="html.html#spacing"><i class="fa fa-check"></i><b>1.6.7</b> Spacing</a></li>
<li class="chapter" data-level="1.6.8" data-path="html.html"><a href="html.html#html-lists"><i class="fa fa-check"></i><b>1.6.8</b> Lists</a></li>
<li class="chapter" data-level="1.6.9" data-path="html.html"><a href="html.html#html-links"><i class="fa fa-check"></i><b>1.6.9</b> Links</a></li>
<li class="chapter" data-level="1.6.10" data-path="html.html"><a href="html.html#images"><i class="fa fa-check"></i><b>1.6.10</b> Images</a></li>
<li class="chapter" data-level="1.6.11" data-path="html.html"><a href="html.html#tables"><i class="fa fa-check"></i><b>1.6.11</b> Tables</a></li>
<li class="chapter" data-level="1.6.12" data-path="html.html"><a href="html.html#grouping"><i class="fa fa-check"></i><b>1.6.12</b> Grouping</a></li>
<li class="chapter" data-level="1.6.13" data-path="html.html"><a href="html.html#input-elements"><i class="fa fa-check"></i><b>1.6.13</b> Input elements</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="html.html"><a href="html.html#id-class-and-style-attributes"><i class="fa fa-check"></i><b>1.7</b> <code>id</code>, <code>class</code>, and <code>style</code> attributes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="html.html"><a href="html.html#overview-id-class-and-style-attributes"><i class="fa fa-check"></i><b>1.7.1</b> Overview</a></li>
<li class="chapter" data-level="1.7.2" data-path="html.html"><a href="html.html#id"><i class="fa fa-check"></i><b>1.7.2</b> <code>id</code></a></li>
<li class="chapter" data-level="1.7.3" data-path="html.html"><a href="html.html#html-class"><i class="fa fa-check"></i><b>1.7.3</b> <code>class</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="html.html"><a href="html.html#style-2"><i class="fa fa-check"></i><b>1.7.4</b> <code>style</code></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="html.html"><a href="html.html#code-layout"><i class="fa fa-check"></i><b>1.8</b> Code layout</a></li>
<li class="chapter" data-level="1.9" data-path="html.html"><a href="html.html#inspecting-elements"><i class="fa fa-check"></i><b>1.9</b> Inspecting elements</a></li>
<li class="chapter" data-level="1.10" data-path="html.html"><a href="html.html#exercise"><i class="fa fa-check"></i><b>1.10</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>2</b> CSS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="css.html"><a href="css.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="css.html"><a href="css.html#what-is-css"><i class="fa fa-check"></i><b>2.2</b> What is CSS?</a></li>
<li class="chapter" data-level="2.3" data-path="css.html"><a href="css.html#css-rules"><i class="fa fa-check"></i><b>2.3</b> CSS rules</a></li>
<li class="chapter" data-level="2.4" data-path="css.html"><a href="css.html#css-selectors"><i class="fa fa-check"></i><b>2.4</b> CSS selectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="css.html"><a href="css.html#overview-css-selectors"><i class="fa fa-check"></i><b>2.4.1</b> Overview</a></li>
<li class="chapter" data-level="2.4.2" data-path="css.html"><a href="css.html#type-selector"><i class="fa fa-check"></i><b>2.4.2</b> Type selector</a></li>
<li class="chapter" data-level="2.4.3" data-path="css.html"><a href="css.html#class-selector"><i class="fa fa-check"></i><b>2.4.3</b> Class selector</a></li>
<li class="chapter" data-level="2.4.4" data-path="css.html"><a href="css.html#id-selector"><i class="fa fa-check"></i><b>2.4.4</b> ID selector</a></li>
<li class="chapter" data-level="2.4.5" data-path="css.html"><a href="css.html#descendant-selector"><i class="fa fa-check"></i><b>2.4.5</b> Descendant selector</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="css.html"><a href="css.html#css-conflicts"><i class="fa fa-check"></i><b>2.5</b> CSS conflicts</a></li>
<li class="chapter" data-level="2.6" data-path="css.html"><a href="css.html#css-inheritance"><i class="fa fa-check"></i><b>2.6</b> CSS inheritance</a></li>
<li class="chapter" data-level="2.7" data-path="css.html"><a href="css.html#linking-css-to-html"><i class="fa fa-check"></i><b>2.7</b> Linking CSS to HTML</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="css.html"><a href="css.html#methods-for-linking-css"><i class="fa fa-check"></i><b>2.7.1</b> Methods for linking CSS</a></li>
<li class="chapter" data-level="2.7.2" data-path="css.html"><a href="css.html#inline-css"><i class="fa fa-check"></i><b>2.7.2</b> Inline CSS</a></li>
<li class="chapter" data-level="2.7.3" data-path="css.html"><a href="css.html#embedded-css"><i class="fa fa-check"></i><b>2.7.3</b> Embedded CSS</a></li>
<li class="chapter" data-level="2.7.4" data-path="css.html"><a href="css.html#external-css"><i class="fa fa-check"></i><b>2.7.4</b> External CSS</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="css.html"><a href="css.html#css-properties"><i class="fa fa-check"></i><b>2.8</b> CSS properties</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="css.html"><a href="css.html#overview-css-properties"><i class="fa fa-check"></i><b>2.8.1</b> Overview</a></li>
<li class="chapter" data-level="2.8.2" data-path="css.html"><a href="css.html#color"><i class="fa fa-check"></i><b>2.8.2</b> Color</a></li>
<li class="chapter" data-level="2.8.3" data-path="css.html"><a href="css.html#text"><i class="fa fa-check"></i><b>2.8.3</b> Text</a></li>
<li class="chapter" data-level="2.8.4" data-path="css.html"><a href="css.html#boxes"><i class="fa fa-check"></i><b>2.8.4</b> Boxes</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="css.html"><a href="css.html#hurricane-scale"><i class="fa fa-check"></i><b>2.9</b> Hurricane scale example</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="css.html"><a href="css.html#html-contents"><i class="fa fa-check"></i><b>2.9.1</b> HTML contents</a></li>
<li class="chapter" data-level="2.9.2" data-path="css.html"><a href="css.html#css-styling"><i class="fa fa-check"></i><b>2.9.2</b> CSS styling</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="css.html"><a href="css.html#example-map-description"><i class="fa fa-check"></i><b>2.10</b> Map description example</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="css.html"><a href="css.html#html-contents-1"><i class="fa fa-check"></i><b>2.10.1</b> HTML contents</a></li>
<li class="chapter" data-level="2.10.2" data-path="css.html"><a href="css.html#example-map-description-box-position"><i class="fa fa-check"></i><b>2.10.2</b> CSS styling: box position</a></li>
<li class="chapter" data-level="2.10.3" data-path="css.html"><a href="css.html#css-styling-final-touches"><i class="fa fa-check"></i><b>2.10.3</b> CSS styling: final touches</a></li>
<li class="chapter" data-level="2.10.4" data-path="css.html"><a href="css.html#adding-map-in-the-background"><i class="fa fa-check"></i><b>2.10.4</b> Adding map in the background</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="css.html"><a href="css.html#exercise-1"><i class="fa fa-check"></i><b>2.11</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="javascript-basics.html"><a href="javascript-basics.html"><i class="fa fa-check"></i><b>3</b> JavaScript Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="javascript-basics.html"><a href="javascript-basics.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="javascript-basics.html"><a href="javascript-basics.html#what-is-javascript-1"><i class="fa fa-check"></i><b>3.2</b> What is JavaScript?</a></li>
<li class="chapter" data-level="3.3" data-path="javascript-basics.html"><a href="javascript-basics.html#client-side-vs.-server-side"><i class="fa fa-check"></i><b>3.3</b> Client-side vs. server-side</a></li>
<li class="chapter" data-level="3.4" data-path="javascript-basics.html"><a href="javascript-basics.html#the-javascript-console"><i class="fa fa-check"></i><b>3.4</b> The JavaScript console</a></li>
<li class="chapter" data-level="3.5" data-path="javascript-basics.html"><a href="javascript-basics.html#assignment"><i class="fa fa-check"></i><b>3.5</b> Assignment</a></li>
<li class="chapter" data-level="3.6" data-path="javascript-basics.html"><a href="javascript-basics.html#data-types"><i class="fa fa-check"></i><b>3.6</b> Data types</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="javascript-basics.html"><a href="javascript-basics.html#overview-data-types"><i class="fa fa-check"></i><b>3.6.1</b> Overview</a></li>
<li class="chapter" data-level="3.6.2" data-path="javascript-basics.html"><a href="javascript-basics.html#primitive-data-types"><i class="fa fa-check"></i><b>3.6.2</b> Primitive data types</a></li>
<li class="chapter" data-level="3.6.3" data-path="javascript-basics.html"><a href="javascript-basics.html#objects-data-type"><i class="fa fa-check"></i><b>3.6.3</b> Objects</a></li>
<li class="chapter" data-level="3.6.4" data-path="javascript-basics.html"><a href="javascript-basics.html#checking-type-of-variables"><i class="fa fa-check"></i><b>3.6.4</b> Checking type of variables</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="javascript-basics.html"><a href="javascript-basics.html#functions"><i class="fa fa-check"></i><b>3.7</b> Functions</a></li>
<li class="chapter" data-level="3.8" data-path="javascript-basics.html"><a href="javascript-basics.html#methods"><i class="fa fa-check"></i><b>3.8</b> Methods</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="javascript-basics.html"><a href="javascript-basics.html#what-are-methods"><i class="fa fa-check"></i><b>3.8.1</b> What are methods?</a></li>
<li class="chapter" data-level="3.8.2" data-path="javascript-basics.html"><a href="javascript-basics.html#array-methods"><i class="fa fa-check"></i><b>3.8.2</b> Array methods</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="javascript-basics.html"><a href="javascript-basics.html#scope"><i class="fa fa-check"></i><b>3.9</b> Scope</a></li>
<li class="chapter" data-level="3.10" data-path="javascript-basics.html"><a href="javascript-basics.html#flow-control"><i class="fa fa-check"></i><b>3.10</b> Flow control</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="javascript-basics.html"><a href="javascript-basics.html#what-is-flow-control"><i class="fa fa-check"></i><b>3.10.1</b> What is flow control?</a></li>
<li class="chapter" data-level="3.10.2" data-path="javascript-basics.html"><a href="javascript-basics.html#conditionals"><i class="fa fa-check"></i><b>3.10.2</b> Conditionals</a></li>
<li class="chapter" data-level="3.10.3" data-path="javascript-basics.html"><a href="javascript-basics.html#loops"><i class="fa fa-check"></i><b>3.10.3</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="javascript-basics.html"><a href="javascript-basics.html#javascript-object-notation-json"><i class="fa fa-check"></i><b>3.11</b> JavaScript Object Notation (JSON)</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="javascript-basics.html"><a href="javascript-basics.html#javascript-json"><i class="fa fa-check"></i><b>3.11.1</b> JSON</a></li>
<li class="chapter" data-level="3.11.2" data-path="javascript-basics.html"><a href="javascript-basics.html#geojson"><i class="fa fa-check"></i><b>3.11.2</b> GeoJSON</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="javascript-basics.html"><a href="javascript-basics.html#exercise-2"><i class="fa fa-check"></i><b>3.12</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html"><i class="fa fa-check"></i><b>4</b> JavaScript Interactivity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#the-document-object-model"><i class="fa fa-check"></i><b>4.2</b> The Document Object Model (DOM)</a></li>
<li class="chapter" data-level="4.3" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#accessing-and-modifying-elements"><i class="fa fa-check"></i><b>4.3</b> Accessing and modifying elements</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#overview-accessing-and_modifying"><i class="fa fa-check"></i><b>4.3.1</b> Overview</a></li>
<li class="chapter" data-level="4.3.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#accessing-elements"><i class="fa fa-check"></i><b>4.3.2</b> Accessing elements</a></li>
<li class="chapter" data-level="4.3.3" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#getting-element-properties"><i class="fa fa-check"></i><b>4.3.3</b> Getting element properties</a></li>
<li class="chapter" data-level="4.3.4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#modifying-elements"><i class="fa fa-check"></i><b>4.3.4</b> Modifying elements</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-listeners"><i class="fa fa-check"></i><b>4.4</b> Event listeners</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-types"><i class="fa fa-check"></i><b>4.4.1</b> Event types</a></li>
<li class="chapter" data-level="4.4.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#binding-event-listeners"><i class="fa fa-check"></i><b>4.4.2</b> Binding event listeners</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#hello-example"><i class="fa fa-check"></i><b>4.5</b> Hello example</a></li>
<li class="chapter" data-level="4.6" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#poles-example"><i class="fa fa-check"></i><b>4.6</b> Poles example</a></li>
<li class="chapter" data-level="4.7" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#operating-on-selection"><i class="fa fa-check"></i><b>4.7</b> Operating on multiple selections</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#example-page"><i class="fa fa-check"></i><b>4.7.1</b> Example page</a></li>
<li class="chapter" data-level="4.7.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#making-multiple-selections"><i class="fa fa-check"></i><b>4.7.2</b> Making multiple selections</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#getting-and-setting-input-values"><i class="fa fa-check"></i><b>4.8</b> Getting and setting input values</a></li>
<li class="chapter" data-level="4.9" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#multiple-event-listeners"><i class="fa fa-check"></i><b>4.9</b> Multiple event listeners</a></li>
<li class="chapter" data-level="4.10" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#the-event-object"><i class="fa fa-check"></i><b>4.10</b> The event object</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-object-properties"><i class="fa fa-check"></i><b>4.10.1</b> Event object properties</a></li>
<li class="chapter" data-level="4.10.2" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#event-target"><i class="fa fa-check"></i><b>4.10.2</b> The <code>.target</code> property</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#modifying-page-based-on-data"><i class="fa fa-check"></i><b>4.11</b> Modifying page based on data</a></li>
<li class="chapter" data-level="4.12" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#working-with-user-input"><i class="fa fa-check"></i><b>4.12</b> Calculator example</a></li>
<li class="chapter" data-level="4.13" data-path="javascript-interactivity.html"><a href="javascript-interactivity.html#exercise-3"><i class="fa fa-check"></i><b>4.13</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-servers-1.html"><a href="web-servers-1.html"><i class="fa fa-check"></i><b>5</b> Web Servers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="web-servers-1.html"><a href="web-servers-1.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="web-servers-1.html"><a href="web-servers-1.html#web-servers-2"><i class="fa fa-check"></i><b>5.2</b> Web servers</a></li>
<li class="chapter" data-level="5.3" data-path="web-servers-1.html"><a href="web-servers-1.html#communicating-through-http"><i class="fa fa-check"></i><b>5.3</b> Communicating through HTTP</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="web-servers-1.html"><a href="web-servers-1.html#web-protocols-and-http"><i class="fa fa-check"></i><b>5.3.1</b> Web protocols and HTTP</a></li>
<li class="chapter" data-level="5.3.2" data-path="web-servers-1.html"><a href="web-servers-1.html#http-methods"><i class="fa fa-check"></i><b>5.3.2</b> HTTP methods</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="web-servers-1.html"><a href="web-servers-1.html#static-vs-dynamic-servers"><i class="fa fa-check"></i><b>5.4</b> Static vs. dynamic servers</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="web-servers-1.html"><a href="web-servers-1.html#overview"><i class="fa fa-check"></i><b>5.4.1</b> Overview</a></li>
<li class="chapter" data-level="5.4.2" data-path="web-servers-1.html"><a href="web-servers-1.html#static-servers"><i class="fa fa-check"></i><b>5.4.2</b> Static servers</a></li>
<li class="chapter" data-level="5.4.3" data-path="web-servers-1.html"><a href="web-servers-1.html#dynamic-servers"><i class="fa fa-check"></i><b>5.4.3</b> Dynamic servers</a></li>
<li class="chapter" data-level="5.4.4" data-path="web-servers-1.html"><a href="web-servers-1.html#software-1"><i class="fa fa-check"></i><b>5.4.4</b> Software</a></li>
<li class="chapter" data-level="5.4.5" data-path="web-servers-1.html"><a href="web-servers-1.html#practical-considerations"><i class="fa fa-check"></i><b>5.4.5</b> Practical considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="web-servers-1.html"><a href="web-servers-1.html#urls-and-file-structure"><i class="fa fa-check"></i><b>5.5</b> URLs and file structure</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="web-servers-1.html"><a href="web-servers-1.html#urls-and-index-html"><i class="fa fa-check"></i><b>5.5.1</b> URLs and <code>index.html</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="web-servers-1.html"><a href="web-servers-1.html#file-structure"><i class="fa fa-check"></i><b>5.5.2</b> File structure</a></li>
<li class="chapter" data-level="5.5.3" data-path="web-servers-1.html"><a href="web-servers-1.html#relative-paths"><i class="fa fa-check"></i><b>5.5.3</b> Relative paths</a></li>
<li class="chapter" data-level="5.5.4" data-path="web-servers-1.html"><a href="web-servers-1.html#css-and-javasccript"><i class="fa fa-check"></i><b>5.5.4</b> CSS and JavaScript</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="web-servers-1.html"><a href="web-servers-1.html#running-a-static-server"><i class="fa fa-check"></i><b>5.6</b> Running a static server</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="web-servers-1.html"><a href="web-servers-1.html#overview-running-static-server"><i class="fa fa-check"></i><b>5.6.1</b> Overview</a></li>
<li class="chapter" data-level="5.6.2" data-path="web-servers-1.html"><a href="web-servers-1.html#local-with-python"><i class="fa fa-check"></i><b>5.6.2</b> Local with Python</a></li>
<li class="chapter" data-level="5.6.3" data-path="web-servers-1.html"><a href="web-servers-1.html#remote-with-github-pages"><i class="fa fa-check"></i><b>5.6.3</b> Remote with GitHub Pages</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Web Mapping with Leaflet</b></span></li>
<li class="chapter" data-level="6" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>6</b> Leaflet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="leaflet.html"><a href="leaflet.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="leaflet.html"><a href="leaflet.html#what-is-web-map"><i class="fa fa-check"></i><b>6.2</b> What is a web map?</a></li>
<li class="chapter" data-level="6.3" data-path="leaflet.html"><a href="leaflet.html#what-is-leaflet"><i class="fa fa-check"></i><b>6.3</b> What is Leaflet?</a></li>
<li class="chapter" data-level="6.4" data-path="leaflet.html"><a href="leaflet.html#alternatives-to-leaflet"><i class="fa fa-check"></i><b>6.4</b> Alternatives to Leaflet</a></li>
<li class="chapter" data-level="6.5" data-path="leaflet.html"><a href="leaflet.html#creating-a-basic-web-map"><i class="fa fa-check"></i><b>6.5</b> Creating a basic web map</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="leaflet.html"><a href="leaflet.html#overview-creating-a-basic-web-map"><i class="fa fa-check"></i><b>6.5.1</b> Overview</a></li>
<li class="chapter" data-level="6.5.2" data-path="leaflet.html"><a href="leaflet.html#web-page-setup"><i class="fa fa-check"></i><b>6.5.2</b> Web page setup</a></li>
<li class="chapter" data-level="6.5.3" data-path="leaflet.html"><a href="leaflet.html#javascript-libraries"><i class="fa fa-check"></i><b>6.5.3</b> JavaScript libraries</a></li>
<li class="chapter" data-level="6.5.4" data-path="leaflet.html"><a href="leaflet.html#including-a-library"><i class="fa fa-check"></i><b>6.5.4</b> Including a library</a></li>
<li class="chapter" data-level="6.5.5" data-path="leaflet.html"><a href="leaflet.html#loading-a-local-script"><i class="fa fa-check"></i><b>6.5.5</b> Loading a local script</a></li>
<li class="chapter" data-level="6.5.6" data-path="leaflet.html"><a href="leaflet.html#loading-a-remote-script"><i class="fa fa-check"></i><b>6.5.6</b> Loading a remote script</a></li>
<li class="chapter" data-level="6.5.7" data-path="leaflet.html"><a href="leaflet.html#including-leaflet-css-js"><i class="fa fa-check"></i><b>6.5.7</b> Including Leaflet CSS and JavaScript</a></li>
<li class="chapter" data-level="6.5.8" data-path="leaflet.html"><a href="leaflet.html#adding-map-div"><i class="fa fa-check"></i><b>6.5.8</b> Adding map <code>&lt;div&gt;</code></a></li>
<li class="chapter" data-level="6.5.9" data-path="leaflet.html"><a href="leaflet.html#creating-map-object"><i class="fa fa-check"></i><b>6.5.9</b> Creating a map object</a></li>
<li class="chapter" data-level="6.5.10" data-path="leaflet.html"><a href="leaflet.html#what-are-tile-layers"><i class="fa fa-check"></i><b>6.5.10</b> What are tile layers?</a></li>
<li class="chapter" data-level="6.5.11" data-path="leaflet.html"><a href="leaflet.html#adding-a-tile-layer"><i class="fa fa-check"></i><b>6.5.11</b> Adding a tile layer</a></li>
<li class="chapter" data-level="6.5.12" data-path="leaflet.html"><a href="leaflet.html#tile-layer-providers"><i class="fa fa-check"></i><b>6.5.12</b> Tile layer providers</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="leaflet.html"><a href="leaflet.html#adding-vector-layers"><i class="fa fa-check"></i><b>6.6</b> Adding vector layers</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="leaflet.html"><a href="leaflet.html#overview-adding-vector-layers"><i class="fa fa-check"></i><b>6.6.1</b> Overview</a></li>
<li class="chapter" data-level="6.6.2" data-path="leaflet.html"><a href="leaflet.html#adding-markers"><i class="fa fa-check"></i><b>6.6.2</b> Adding markers</a></li>
<li class="chapter" data-level="6.6.3" data-path="leaflet.html"><a href="leaflet.html#adding-lines"><i class="fa fa-check"></i><b>6.6.3</b> Adding lines</a></li>
<li class="chapter" data-level="6.6.4" data-path="leaflet.html"><a href="leaflet.html#adding-polygons"><i class="fa fa-check"></i><b>6.6.4</b> Adding polygons</a></li>
<li class="chapter" data-level="6.6.5" data-path="leaflet.html"><a href="leaflet.html#other-layer-types"><i class="fa fa-check"></i><b>6.6.5</b> Other layer types</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="leaflet.html"><a href="leaflet.html#adding-popups"><i class="fa fa-check"></i><b>6.7</b> Adding popups</a></li>
<li class="chapter" data-level="6.8" data-path="leaflet.html"><a href="leaflet.html#adding-a-description"><i class="fa fa-check"></i><b>6.8</b> Adding a description</a></li>
<li class="chapter" data-level="6.9" data-path="leaflet.html"><a href="leaflet.html#introducing-map-events"><i class="fa fa-check"></i><b>6.9</b> Introducing map events</a></li>
<li class="chapter" data-level="6.10" data-path="leaflet.html"><a href="leaflet.html#exercise-06"><i class="fa fa-check"></i><b>6.10</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geojson-1.html"><a href="geojson-1.html"><i class="fa fa-check"></i><b>7</b> GeoJSON</a>
<ul>
<li class="chapter" data-level="7.1" data-path="geojson-1.html"><a href="geojson-1.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="geojson-1.html"><a href="geojson-1.html#what-is-geojson"><i class="fa fa-check"></i><b>7.2</b> What is GeoJSON?</a></li>
<li class="chapter" data-level="7.3" data-path="geojson-1.html"><a href="geojson-1.html#geojson-structure"><i class="fa fa-check"></i><b>7.3</b> GeoJSON structure</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="geojson-1.html"><a href="geojson-1.html#overview-geojson"><i class="fa fa-check"></i><b>7.3.1</b> Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="geojson-1.html"><a href="geojson-1.html#geometries"><i class="fa fa-check"></i><b>7.3.2</b> Geometries</a></li>
<li class="chapter" data-level="7.3.3" data-path="geojson-1.html"><a href="geojson-1.html#features"><i class="fa fa-check"></i><b>7.3.3</b> Features</a></li>
<li class="chapter" data-level="7.3.4" data-path="geojson-1.html"><a href="geojson-1.html#feature-collections"><i class="fa fa-check"></i><b>7.3.4</b> Feature collections</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="geojson-1.html"><a href="geojson-1.html#editing-geojson"><i class="fa fa-check"></i><b>7.4</b> Editing GeoJSON</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="geojson-1.html"><a href="geojson-1.html#geojson-io"><i class="fa fa-check"></i><b>7.4.1</b> geojson.io</a></li>
<li class="chapter" data-level="7.4.2" data-path="geojson-1.html"><a href="geojson-1.html#mapshaper"><i class="fa fa-check"></i><b>7.4.2</b> mapshaper</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="geojson-1.html"><a href="geojson-1.html#adding-geojson-to-leaflet-map"><i class="fa fa-check"></i><b>7.5</b> Adding GeoJSON to Leaflet map</a></li>
<li class="chapter" data-level="7.6" data-path="geojson-1.html"><a href="geojson-1.html#geojson-viewer"><i class="fa fa-check"></i><b>7.6</b> GeoJSON viewer example</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="geojson-1.html"><a href="geojson-1.html#viewer-structure"><i class="fa fa-check"></i><b>7.6.1</b> Viewer structure</a></li>
<li class="chapter" data-level="7.6.2" data-path="geojson-1.html"><a href="geojson-1.html#viewer-html-and-css"><i class="fa fa-check"></i><b>7.6.2</b> HTML and CSS</a></li>
<li class="chapter" data-level="7.6.3" data-path="geojson-1.html"><a href="geojson-1.html#base-map"><i class="fa fa-check"></i><b>7.6.3</b> Base map</a></li>
<li class="chapter" data-level="7.6.4" data-path="geojson-1.html"><a href="geojson-1.html#adding-an-event-listener"><i class="fa fa-check"></i><b>7.6.4</b> Adding an event listener</a></li>
<li class="chapter" data-level="7.6.5" data-path="geojson-1.html"><a href="geojson-1.html#using-layer-groups"><i class="fa fa-check"></i><b>7.6.5</b> Using layer groups</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="geojson-1.html"><a href="geojson-1.html#ajax"><i class="fa fa-check"></i><b>7.7</b> Ajax and the <code>fetch</code> API</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="geojson-1.html"><a href="geojson-1.html#overview-ajax"><i class="fa fa-check"></i><b>7.7.1</b> What is Ajax?</a></li>
<li class="chapter" data-level="7.7.2" data-path="geojson-1.html"><a href="geojson-1.html#ajax-examples"><i class="fa fa-check"></i><b>7.7.2</b> Ajax examples</a></li>
<li class="chapter" data-level="7.7.3" data-path="geojson-1.html"><a href="geojson-1.html#making-ajax-requests-with-fetch"><i class="fa fa-check"></i><b>7.7.3</b> The <code>fetch</code> API</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="geojson-1.html"><a href="geojson-1.html#loading-geojson-files"><i class="fa fa-check"></i><b>7.8</b> Loading GeoJSON files</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="geojson-1.html"><a href="geojson-1.html#loading-local-files"><i class="fa fa-check"></i><b>7.8.1</b> Loading local files</a></li>
<li class="chapter" data-level="7.8.2" data-path="geojson-1.html"><a href="geojson-1.html#loading-remote-files"><i class="fa fa-check"></i><b>7.8.2</b> Loading remote files</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="geojson-1.html"><a href="geojson-1.html#exercise-4"><i class="fa fa-check"></i><b>7.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html"><i class="fa fa-check"></i><b>8</b> Symbology and Interactivity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#l-geojson-options"><i class="fa fa-check"></i><b>8.2</b> <code>L.geoJSON</code> options</a></li>
<li class="chapter" data-level="8.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#constant-style"><i class="fa fa-check"></i><b>8.3</b> Constant style</a></li>
<li class="chapter" data-level="8.4" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#varying-style"><i class="fa fa-check"></i><b>8.4</b> Varying style</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#setting-varying-style"><i class="fa fa-check"></i><b>8.4.1</b> Setting varying style</a></li>
<li class="chapter" data-level="8.4.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#states-example"><i class="fa fa-check"></i><b>8.4.2</b> States example</a></li>
<li class="chapter" data-level="8.4.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#towns-example"><i class="fa fa-check"></i><b>8.4.3</b> Towns example</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#constructing-popups-from-data"><i class="fa fa-check"></i><b>8.5</b> Constructing popups from data</a></li>
<li class="chapter" data-level="8.6" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#adding-a-legend"><i class="fa fa-check"></i><b>8.6</b> Adding a legend</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#setting-legend-contents-with-l.control"><i class="fa fa-check"></i><b>8.6.1</b> Setting legend contents with <code>L.control</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#using-css-to-style-the-legend"><i class="fa fa-check"></i><b>8.6.2</b> Using CSS to style the legend</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#dynamic-style"><i class="fa fa-check"></i><b>8.7</b> Dynamic style</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#styling-in-response-to-events"><i class="fa fa-check"></i><b>8.7.1</b> Styling in response to events</a></li>
<li class="chapter" data-level="8.7.2" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#dynamic-control-contents"><i class="fa fa-check"></i><b>8.7.2</b> Dynamic control contents</a></li>
<li class="chapter" data-level="8.7.3" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#linked-views"><i class="fa fa-check"></i><b>8.7.3</b> Linked views</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="symbology-and-interactivity.html"><a href="symbology-and-interactivity.html#exercise-08"><i class="fa fa-check"></i><b>8.8</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>III Databases</b></span></li>
<li class="chapter" data-level="9" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>9</b> Databases</a>
<ul>
<li class="chapter" data-level="9.1" data-path="databases.html"><a href="databases.html#introduction-databases"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="databases.html"><a href="databases.html#what-is-carto"><i class="fa fa-check"></i><b>9.2</b> What is CARTO?</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="databases.html"><a href="databases.html#the-carto-platform"><i class="fa fa-check"></i><b>9.2.1</b> The CARTO platform</a></li>
<li class="chapter" data-level="9.2.2" data-path="databases.html"><a href="databases.html#alternatives-to-carto"><i class="fa fa-check"></i><b>9.2.2</b> Alternatives to CARTO</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="databases.html"><a href="databases.html#databases-1"><i class="fa fa-check"></i><b>9.3</b> Databases</a></li>
<li class="chapter" data-level="9.4" data-path="databases.html"><a href="databases.html#spatial-databases"><i class="fa fa-check"></i><b>9.4</b> Spatial databases</a></li>
<li class="chapter" data-level="9.5" data-path="databases.html"><a href="databases.html#what-is-postgis"><i class="fa fa-check"></i><b>9.5</b> What is PostGIS?</a></li>
<li class="chapter" data-level="9.6" data-path="databases.html"><a href="databases.html#what-is-sql"><i class="fa fa-check"></i><b>9.6</b> What is SQL?</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="databases.html"><a href="databases.html#overview-sql"><i class="fa fa-check"></i><b>9.6.1</b> Overview</a></li>
<li class="chapter" data-level="9.6.2" data-path="databases.html"><a href="databases.html#non-spatial-queries"><i class="fa fa-check"></i><b>9.6.2</b> Non-spatial queries</a></li>
<li class="chapter" data-level="9.6.3" data-path="databases.html"><a href="databases.html#the-geometry-column"><i class="fa fa-check"></i><b>9.6.3</b> The geometry column</a></li>
<li class="chapter" data-level="9.6.4" data-path="databases.html"><a href="databases.html#spatial-queries"><i class="fa fa-check"></i><b>9.6.4</b> Spatial queries</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="databases.html"><a href="databases.html#the-carto-sql-api"><i class="fa fa-check"></i><b>9.7</b> The CARTO SQL API</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="databases.html"><a href="databases.html#api-usage"><i class="fa fa-check"></i><b>9.7.1</b> API usage</a></li>
<li class="chapter" data-level="9.7.2" data-path="databases.html"><a href="databases.html#query-example"><i class="fa fa-check"></i><b>9.7.2</b> Query example</a></li>
<li class="chapter" data-level="9.7.3" data-path="databases.html"><a href="databases.html#uploading-your-data"><i class="fa fa-check"></i><b>9.7.3</b> Uploading your data</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="databases.html"><a href="databases.html#carto-and-leaflet"><i class="fa fa-check"></i><b>9.8</b> CARTO and Leaflet</a></li>
<li class="chapter" data-level="9.9" data-path="databases.html"><a href="databases.html#exercise-09"><i class="fa fa-check"></i><b>9.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html"><i class="fa fa-check"></i><b>10</b> Non-spatial Queries</a>
<ul>
<li class="chapter" data-level="10.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#subsetting-with-sql"><i class="fa fa-check"></i><b>10.2</b> Subsetting with SQL</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#filtering-based-on-attributes"><i class="fa fa-check"></i><b>10.2.1</b> Filtering based on attributes</a></li>
<li class="chapter" data-level="10.2.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#displaying-on-a-map"><i class="fa fa-check"></i><b>10.2.2</b> Displaying on a map</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#creating-a-dropdown-menu"><i class="fa fa-check"></i><b>10.3</b> Creating a dropdown menu</a></li>
<li class="chapter" data-level="10.4" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#populating-dropdown-options"><i class="fa fa-check"></i><b>10.4</b> Populating dropdown options</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#how-many-species-do-we-have"><i class="fa fa-check"></i><b>10.4.1</b> How many species do we have?</a></li>
<li class="chapter" data-level="10.4.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#dropdown-menu-placeholder"><i class="fa fa-check"></i><b>10.4.2</b> Dropdown menu placeholder</a></li>
<li class="chapter" data-level="10.4.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#finding-unique-values"><i class="fa fa-check"></i><b>10.4.3</b> Finding unique values</a></li>
<li class="chapter" data-level="10.4.4" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#adding-options"><i class="fa fa-check"></i><b>10.4.4</b> Adding the options</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#updating-the-map"><i class="fa fa-check"></i><b>10.5</b> Updating the map</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#overview-updating-map"><i class="fa fa-check"></i><b>10.5.1</b> Overview</a></li>
<li class="chapter" data-level="10.5.2" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#manual-example"><i class="fa fa-check"></i><b>10.5.2</b> Manual example</a></li>
<li class="chapter" data-level="10.5.3" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#automatic-updating"><i class="fa fa-check"></i><b>10.5.3</b> Automatic updating</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#rearranging-the-code"><i class="fa fa-check"></i><b>10.6</b> Refactoring the code</a></li>
<li class="chapter" data-level="10.7" data-path="non-spatial-queries-1.html"><a href="non-spatial-queries-1.html#exercise-10"><i class="fa fa-check"></i><b>10.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html"><i class="fa fa-check"></i><b>11</b> Spatial Queries</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-marker-on-click"><i class="fa fa-check"></i><b>11.2</b> Adding markers on click</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#getting-click-coordinates"><i class="fa fa-check"></i><b>11.2.1</b> Getting click coordinates</a></li>
<li class="chapter" data-level="11.2.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-custom-marker"><i class="fa fa-check"></i><b>11.2.2</b> Adding a custom marker</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#spatial-postgis-operators"><i class="fa fa-check"></i><b>11.3</b> Spatial PostGIS operators</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#overview-postgis-operators"><i class="fa fa-check"></i><b>11.3.1</b> Overview</a></li>
<li class="chapter" data-level="11.3.2" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#geographical-distance"><i class="fa fa-check"></i><b>11.3.2</b> Geographical distance</a></li>
<li class="chapter" data-level="11.3.3" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#sphere-vs-spheroid"><i class="fa fa-check"></i><b>11.3.3</b> Sphere vs. spheroid</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#adding-nearest-points-to-map"><i class="fa fa-check"></i><b>11.4</b> Adding nearest points to map</a></li>
<li class="chapter" data-level="11.5" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#drawing-line-connectors"><i class="fa fa-check"></i><b>11.5</b> Drawing line connectors</a></li>
<li class="chapter" data-level="11.6" data-path="spatial-queries-1.html"><a href="spatial-queries-1.html#exercise-5"><i class="fa fa-check"></i><b>11.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>IV Advanced Topics</b></span></li>
<li class="chapter" data-level="12" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html"><i class="fa fa-check"></i><b>12</b> Client-side Geoprocessing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#geoprocessing-with-turfjs"><i class="fa fa-check"></i><b>12.2</b> Geoprocessing with Turf.js</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-turfjs"><i class="fa fa-check"></i><b>12.2.1</b> Overview</a></li>
<li class="chapter" data-level="12.2.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#including-the-turf-js-library"><i class="fa fa-check"></i><b>12.2.2</b> Including the Turf.js library</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#great-circle-line"><i class="fa fa-check"></i><b>12.3</b> Great Circle line</a></li>
<li class="chapter" data-level="12.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#continuously-updated-tin"><i class="fa fa-check"></i><b>12.4</b> Continuously updated TIN</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-continuous-tin"><i class="fa fa-check"></i><b>12.4.1</b> Overview</a></li>
<li class="chapter" data-level="12.4.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#generating-random-points"><i class="fa fa-check"></i><b>12.4.2</b> Generating random points</a></li>
<li class="chapter" data-level="12.4.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#adding-a-tin-layer"><i class="fa fa-check"></i><b>12.4.3</b> Adding a TIN layer</a></li>
<li class="chapter" data-level="12.4.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#draggable-circle-markers"><i class="fa fa-check"></i><b>12.4.4</b> Draggable circle markers</a></li>
<li class="chapter" data-level="12.4.5" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#continuous-updating"><i class="fa fa-check"></i><b>12.4.5</b> Continuous updating</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#clustering"><i class="fa fa-check"></i><b>12.5</b> Clustering</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#overview-clustering"><i class="fa fa-check"></i><b>12.5.1</b> Overview</a></li>
<li class="chapter" data-level="12.5.2" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#processing-sets-of-features"><i class="fa fa-check"></i><b>12.5.2</b> Processing sets of features</a></li>
<li class="chapter" data-level="12.5.3" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#adding-a-convex-hull"><i class="fa fa-check"></i><b>12.5.3</b> Adding a Convex Hull</a></li>
<li class="chapter" data-level="12.5.4" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#dbscan-clustering"><i class="fa fa-check"></i><b>12.5.4</b> DBSCAN clustering</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#heatmaps-with-leafletheat"><i class="fa fa-check"></i><b>12.6</b> Heatmaps with Leaflet.heat</a></li>
<li class="chapter" data-level="12.7" data-path="client-side-geoprocessing.html"><a href="client-side-geoprocessing.html#exercise-6"><i class="fa fa-check"></i><b>12.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html"><i class="fa fa-check"></i><b>13</b> Collaborative Mapping</a>
<ul>
<li class="chapter" data-level="13.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#crowdsourcing"><i class="fa fa-check"></i><b>13.2</b> Crowdsourcing</a></li>
<li class="chapter" data-level="13.3" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#the-drawing-control"><i class="fa fa-check"></i><b>13.3</b> The drawing control</a></li>
<li class="chapter" data-level="13.4" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#working-with-drawn-items"><i class="fa fa-check"></i><b>13.4</b> Working with drawn items</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#printing-drawn-items-geojson"><i class="fa fa-check"></i><b>13.4.1</b> Printing drawn items GeoJSON</a></li>
<li class="chapter" data-level="13.4.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#expanded-geojson-viewer"><i class="fa fa-check"></i><b>13.4.2</b> Expanded GeoJSON viewer</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#submission-form"><i class="fa fa-check"></i><b>13.5</b> Submission form</a></li>
<li class="chapter" data-level="13.6" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#sending-features-to-the-database"><i class="fa fa-check"></i><b>13.6</b> Sending features to the database</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#setting-database-permissions"><i class="fa fa-check"></i><b>13.6.1</b> Setting database permissions</a></li>
<li class="chapter" data-level="13.6.2" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#adding-draw-control"><i class="fa fa-check"></i><b>13.6.2</b> Adding the drawing control</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="collaborative-mapping.html"><a href="collaborative-mapping.html#exercise-7"><i class="fa fa-check"></i><b>13.7</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>V Appendices</b></span></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="associated-files.html"><a href="associated-files.html"><i class="fa fa-check"></i><b>A</b> Associated Files</a></li>
<li class="chapter" data-level="B" data-path="list-of-examples.html"><a href="list-of-examples.html"><i class="fa fa-check"></i><b>B</b> List of Examples</a>
<ul>
<li class="chapter" data-level="B.1" data-path="list-of-examples.html"><a href="list-of-examples.html#main"><i class="fa fa-check"></i><b>B.1</b> Main</a></li>
<li class="chapter" data-level="B.2" data-path="list-of-examples.html"><a href="list-of-examples.html#additional"><i class="fa fa-check"></i><b>B.2</b> Additional</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="list-of-examples.html"><a href="list-of-examples.html#html-and-css"><i class="fa fa-check"></i><b>B.2.1</b> HTML and CSS</a></li>
<li class="chapter" data-level="B.2.2" data-path="list-of-examples.html"><a href="list-of-examples.html#javascript"><i class="fa fa-check"></i><b>B.2.2</b> JavaScript</a></li>
<li class="chapter" data-level="B.2.3" data-path="list-of-examples.html"><a href="list-of-examples.html#leaflet-1"><i class="fa fa-check"></i><b>B.2.3</b> Leaflet</a></li>
<li class="chapter" data-level="B.2.4" data-path="list-of-examples.html"><a href="list-of-examples.html#geo-processing"><i class="fa fa-check"></i><b>B.2.4</b> Geo-processing</a></li>
<li class="chapter" data-level="B.2.5" data-path="list-of-examples.html"><a href="list-of-examples.html#d-maps"><i class="fa fa-check"></i><b>B.2.5</b> 2.5D Maps</a></li>
<li class="chapter" data-level="B.2.6" data-path="list-of-examples.html"><a href="list-of-examples.html#d-maps-1"><i class="fa fa-check"></i><b>B.2.6</b> 3D maps</a></li>
<li class="chapter" data-level="B.2.7" data-path="list-of-examples.html"><a href="list-of-examples.html#animation"><i class="fa fa-check"></i><b>B.2.7</b> Animation</a></li>
<li class="chapter" data-level="B.2.8" data-path="list-of-examples.html"><a href="list-of-examples.html#real-time-data"><i class="fa fa-check"></i><b>B.2.8</b> Real-time data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="list-of-exercise-solutions.html"><a href="list-of-exercise-solutions.html"><i class="fa fa-check"></i><b>C</b> List of Exercise Solutions</a></li>
<li class="chapter" data-level="D" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html"><i class="fa fa-check"></i><b>D</b> BGU course 2021</a>
<ul>
<li class="chapter" data-level="D.1" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#place-and-time"><i class="fa fa-check"></i><b>D.1</b> Place and Time</a></li>
<li class="chapter" data-level="D.2" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#lecture-plan"><i class="fa fa-check"></i><b>D.2</b> Lecture plan</a></li>
<li class="chapter" data-level="D.3" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#project-submission-dates"><i class="fa fa-check"></i><b>D.3</b> Project submission dates</a></li>
<li class="chapter" data-level="D.4" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#additional-resources"><i class="fa fa-check"></i><b>D.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#html-css"><i class="fa fa-check"></i><b>D.4.1</b> HTML &amp; CSS</a></li>
<li class="chapter" data-level="D.4.2" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#javascript-1"><i class="fa fa-check"></i><b>D.4.2</b> JavaScript</a></li>
<li class="chapter" data-level="D.4.3" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#web-mapping"><i class="fa fa-check"></i><b>D.4.3</b> Web mapping</a></li>
<li class="chapter" data-level="D.4.4" data-path="bgu-course-2021.html"><a href="bgu-course-2021.html#postgis"><i class="fa fa-check"></i><b>D.4.4</b> PostGIS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>E</b> Projects</a>
<ul>
<li class="chapter" data-level="E.1" data-path="projects.html"><a href="projects.html#overview-3"><i class="fa fa-check"></i><b>E.1</b> Overview</a></li>
<li class="chapter" data-level="E.2" data-path="projects.html"><a href="projects.html#carto-account"><i class="fa fa-check"></i><b>E.2</b> CARTO Account</a></li>
<li class="chapter" data-level="E.3" data-path="projects.html"><a href="projects.html#data"><i class="fa fa-check"></i><b>E.3</b> Data</a></li>
<li class="chapter" data-level="E.4" data-path="projects.html"><a href="projects.html#project-requirements"><i class="fa fa-check"></i><b>E.4</b> Project requirements</a>
<ul>
<li class="chapter" data-level="E.4.1" data-path="projects.html"><a href="projects.html#project-01"><i class="fa fa-check"></i><b>E.4.1</b> Project 01</a></li>
<li class="chapter" data-level="E.4.2" data-path="projects.html"><a href="projects.html#project-02"><i class="fa fa-check"></i><b>E.4.2</b> Project 02</a></li>
<li class="chapter" data-level="E.4.3" data-path="projects.html"><a href="projects.html#project-03"><i class="fa fa-check"></i><b>E.4.3</b> Project 03</a></li>
</ul></li>
<li class="chapter" data-level="E.5" data-path="projects.html"><a href="projects.html#submission"><i class="fa fa-check"></i><b>E.5</b> Submission</a></li>
<li class="chapter" data-level="E.6" data-path="projects.html"><a href="projects.html#grading"><i class="fa fa-check"></i><b>E.6</b> Grading</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="exam.html"><a href="exam.html"><i class="fa fa-check"></i><b>F</b> Exam</a>
<ul>
<li class="chapter" data-level="F.1" data-path="exam.html"><a href="exam.html#topics"><i class="fa fa-check"></i><b>F.1</b> Topics</a></li>
<li class="chapter" data-level="F.2" data-path="exam.html"><a href="exam.html#sample-questions"><i class="fa fa-check"></i><b>F.2</b> Sample questions</a>
<ul>
<li class="chapter" data-level="F.2.1" data-path="exam.html"><a href="exam.html#question-1"><i class="fa fa-check"></i><b>F.2.1</b> Question 1</a></li>
<li class="chapter" data-level="F.2.3" data-path="exam.html"><a href="exam.html#question-3"><i class="fa fa-check"></i><b>F.2.3</b> Question 3</a></li>
<li class="chapter" data-level="F.2.4" data-path="exam.html"><a href="exam.html#question-4"><i class="fa fa-check"></i><b>F.2.4</b> Question 4</a></li>
<li class="chapter" data-level="F.2.5" data-path="exam.html"><a href="exam.html#question-5"><i class="fa fa-check"></i><b>F.2.5</b> Question 5</a></li>
<li class="chapter" data-level="F.2.6" data-path="exam.html"><a href="exam.html#question-6"><i class="fa fa-check"></i><b>F.2.6</b> Question 6</a></li>
<li class="chapter" data-level="F.2.7" data-path="exam.html"><a href="exam.html#question-7"><i class="fa fa-check"></i><b>F.2.7</b> Question 7</a></li>
<li class="chapter" data-level="F.2.8" data-path="exam.html"><a href="exam.html#question-8"><i class="fa fa-check"></i><b>F.2.8</b> Question 8</a></li>
<li class="chapter" data-level="F.2.9" data-path="exam.html"><a href="exam.html#question-9"><i class="fa fa-check"></i><b>F.2.9</b> Question 9</a></li>
<li class="chapter" data-level="F.2.10" data-path="exam.html"><a href="exam.html#question-10"><i class="fa fa-check"></i><b>F.2.10</b> Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="additional-questions.html"><a href="additional-questions.html"><i class="fa fa-check"></i><b>G</b> Additional Questions</a>
<ul>
<li class="chapter" data-level="G.1" data-path="additional-questions.html"><a href="additional-questions.html#chapter-3"><i class="fa fa-check"></i><b>G.1</b> Chapter 3</a>
<ul>
<li class="chapter" data-level="G.1.1" data-path="additional-questions.html"><a href="additional-questions.html#modifying-global-variable"><i class="fa fa-check"></i><b>G.1.1</b> Modifying global variable</a></li>
<li class="chapter" data-level="G.1.2" data-path="additional-questions.html"><a href="additional-questions.html#insertingremoving-array-element"><i class="fa fa-check"></i><b>G.1.2</b> Inserting/removing array element</a></li>
<li class="chapter" data-level="G.1.3" data-path="additional-questions.html"><a href="additional-questions.html#object-oriented-language"><i class="fa fa-check"></i><b>G.1.3</b> Object Oriented language</a></li>
</ul></li>
<li class="chapter" data-level="G.2" data-path="additional-questions.html"><a href="additional-questions.html#chapter-4"><i class="fa fa-check"></i><b>G.2</b> Chapter 4</a>
<ul>
<li class="chapter" data-level="G.2.1" data-path="additional-questions.html"><a href="additional-questions.html#removing-collection-of-html-elements"><i class="fa fa-check"></i><b>G.2.1</b> Removing collection of HTML elements</a></li>
<li class="chapter" data-level="G.2.2" data-path="additional-questions.html"><a href="additional-questions.html#constraining-event-listener-frequency"><i class="fa fa-check"></i><b>G.2.2</b> Constraining event listener frequency</a></li>
<li class="chapter" data-level="G.2.3" data-path="additional-questions.html"><a href="additional-questions.html#saving-.getelementbyid-method-in-variable"><i class="fa fa-check"></i><b>G.2.3</b> Saving <code>.getElementById</code> method in variable</a></li>
</ul></li>
<li class="chapter" data-level="G.3" data-path="additional-questions.html"><a href="additional-questions.html#chapter-6"><i class="fa fa-check"></i><b>G.3</b> Chapter 6</a>
<ul>
<li class="chapter" data-level="G.3.1" data-path="additional-questions.html"><a href="additional-questions.html#routing"><i class="fa fa-check"></i><b>G.3.1</b> Routing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="H" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html"><i class="fa fa-check"></i><b>H</b> Setting up an SQL API</a>
<ul>
<li class="chapter" data-level="H.1" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#introduction-12"><i class="fa fa-check"></i><b>H.1</b> Introduction</a></li>
<li class="chapter" data-level="H.2" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#computer-with-fixed-ip-address"><i class="fa fa-check"></i><b>H.2</b> Computer with fixed IP address</a></li>
<li class="chapter" data-level="H.3" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#installing-postgresql-postgis"><i class="fa fa-check"></i><b>H.3</b> Installing PostgreSQL and PostGIS</a></li>
<li class="chapter" data-level="H.4" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#loading-data-into-the-database"><i class="fa fa-check"></i><b>H.4</b> Loading data into the database</a></li>
<li class="chapter" data-level="H.5" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#adding-read-only-database-user"><i class="fa fa-check"></i><b>H.5</b> Adding a read-only database user</a></li>
<li class="chapter" data-level="H.6" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#installing-nodejs-and-required-modules"><i class="fa fa-check"></i><b>H.6</b> Installing Node.js and required modules</a></li>
<li class="chapter" data-level="H.7" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#creating-a-service"><i class="fa fa-check"></i><b>H.7</b> Creating a service</a></li>
<li class="chapter" data-level="H.8" data-path="setting-up-an-sql-api.html"><a href="setting-up-an-sql-api.html#testing-the-sql-api"><i class="fa fa-check"></i><b>H.8</b> Testing the SQL API</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html"><i class="fa fa-check"></i><b>I</b> Setting up a static server using R</a>
<ul>
<li class="chapter" data-level="I.1" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#introduction-13"><i class="fa fa-check"></i><b>I.1</b> Introduction</a></li>
<li class="chapter" data-level="I.2" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#installing-r"><i class="fa fa-check"></i><b>I.2</b> Installing R</a></li>
<li class="chapter" data-level="I.3" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#installing-the-servr-package"><i class="fa fa-check"></i><b>I.3</b> Installing the <code>servr</code> package</a></li>
<li class="chapter" data-level="I.4" data-path="setting-up-a-static-server-using-r.html"><a href="setting-up-a-static-server-using-r.html#starting-the-server"><i class="fa fa-check"></i><b>I.4</b> Starting the server</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="index-2.html">Introduction to Web Mapping</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="setting-up-an-sql-api" class="section level1" number="21">
<h1><span class="header-section-number">H</span> Setting up an SQL API</h1>
<p><i>Last updated: 2021-08-24 14:54:59 </i></p>
<div id="introduction-12" class="section level2" number="21.1">
<h2><span class="header-section-number">H.1</span> Introduction</h2>
<p>This tutorial summarizes the steps for setting up an SQL API service as an alternative to the commercial CARTO service (Section <a href="databases.html#alternatives-to-carto">9.2.2</a>). The SQL API exposes a PostGIS database through HTTP, which makes it possible to get subsets of spatial layers and display them on a Leaflet map (Chapters <a href="databases.html#databases">9</a>–<a href="spatial-queries-1.html#spatial-queries-1">11</a>) or to submit drawn layers for permanent storage (Chapter <a href="collaborative-mapping.html#collaborative-mapping">13</a>).</p>
<p>Setting up the SQL API requires going through the following steps:</p>
<ul>
<li>Having a computer with a fixed IP address (Section <a href="setting-up-an-sql-api.html#computer-with-fixed-ip-address">H.2</a>)</li>
<li>Installing PostgreSQL and PostGIS (Section <a href="setting-up-an-sql-api.html#installing-postgresql-postgis">H.3</a>)</li>
<li>Loading data into the database (Section <a href="setting-up-an-sql-api.html#loading-data-into-the-database">H.4</a>)</li>
<li>Adding a read-only database user (Section <a href="setting-up-an-sql-api.html#adding-read-only-database-user">H.5</a>)</li>
<li>Installing Node.js and required modules (Section <a href="setting-up-an-sql-api.html#installing-nodejs-and-required-modules">H.6</a>)</li>
<li>Testing the SQL API (Section <a href="setting-up-an-sql-api.html#testing-the-sql-api">H.8</a>)</li>
</ul>
<p>These instructions are more advanced than the material given in the main part of the book. If you are not familiar with the software components being used, be prepared for some amount of trial and error, which is part of the learning process.</p>
</div>
<div id="computer-with-fixed-ip-address" class="section level2" number="21.2">
<h2><span class="header-section-number">H.2</span> Computer with fixed IP address</h2>
<p>The first thing we need to take care of is having a computer with a fixed IP address, where the SQL API will run and clients will send their requests to. You can use a physical machine for this, though the simplest is to use a cloud service.</p>
<p>One of the simplest to use cloud solutions, which we are using in this tutorial is <a href="https://www.digitalocean.com/">DigitalOcean</a>. We can launch the smallest <strong>virtual machine</strong>, or <em>droplet</em> in DigitalOcean terminology, for as little as 5$ a month. The machine will have just 1 processor core and 1GB of RAM, which is enough for demonstration purposes (Figure <a href="setting-up-an-sql-api.html#fig:digitalocean-droplet-size">H.1</a>). The default operating system—Ubuntu 18.04 at the time of writing—can be used.</p>
<div class="figure" style="text-align: center"><span id="fig:digitalocean-droplet-size"></span>
<img src="images/digitalocean_droplet.png" alt="Selecting DigitalOcean droplet size" width="100%" />
<p class="caption">
FIGURE H.1: Selecting DigitalOcean droplet size
</p>
</div>
<p>Once the droplet is initiated, you need to write down its <strong>IP address</strong>. From now on you need to connect to the droplet through <a href="https://en.wikipedia.org/wiki/Secure_Shell"><strong>SSH</strong></a> to log into the computer and gain access to its command line interface. Everything from now on is done through the command line.</p>
<p>Connecting through SSH will look as follows:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb506-1"><a href="setting-up-an-sql-api.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> root@157.230.21.4</span></code></pre></div>
<p>where <code>157.230.21.4</code> is the droplet/server IP address. You will be prompted for a password which you can get by e-mail when resetting the password through the DigitalOcean web interface.</p>
<p>The first thing to do is create a new user other than <code>root</code>:</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb507-1"><a href="setting-up-an-sql-api.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="ex">adduser</span> michael</span></code></pre></div>
<p>And add it to the <code>sudo</code> group:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb508-1"><a href="setting-up-an-sql-api.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="ex">usermod</span> -aG sudo michael</span></code></pre></div>
<p>Afterwards you can connect with the new user through SSH (Figure <a href="setting-up-an-sql-api.html#fig:digitalocean-ubuntu-log-in">H.2</a>):</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb509-1"><a href="setting-up-an-sql-api.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> michael@157.230.21.4</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:digitalocean-ubuntu-log-in"></span>
<img src="images/digitalocean_ubuntu_login.png" alt="PostGIS database query example" width="100%" />
<p class="caption">
FIGURE H.2: PostGIS database query example
</p>
</div>
</div>
<div id="installing-postgresql-postgis" class="section level2" number="21.3">
<h2><span class="header-section-number">H.3</span> Installing PostgreSQL and PostGIS</h2>
<p>The first step is to install the <strong>PostgreSQL</strong> database and enable the <strong>PostGIS</strong> extension. The instructions for installing <strong>PostgreSQL</strong> are based on the following tutorials for Ubuntu 20.04:</p>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-postgresql-on-ubuntu-20-04-quickstart" class="uri">https://www.digitalocean.com/community/tutorials/how-to-install-postgresql-on-ubuntu-20-04-quickstart</a></li>
</ul>
<p>First, we install the required package:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb510-1"><a href="setting-up-an-sql-api.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install postgresql postgresql-contrib</span>
<span id="cb510-2"><a href="setting-up-an-sql-api.html#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install postgis postgresql-12-postgis-3</span></code></pre></div>
<p>Log in to the database as <code>postgres</code> user:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb511-1"><a href="setting-up-an-sql-api.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> -u postgres psql</span></code></pre></div>
<p>Enable “adminpack”:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb512-1"><a href="setting-up-an-sql-api.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> EXTENSION adminpack;</span>
<span id="cb512-2"><a href="setting-up-an-sql-api.html#cb512-2" aria-hidden="true" tabindex="-1"></a>\q</span></code></pre></div>
<p>Log in once again:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb513-1"><a href="setting-up-an-sql-api.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> -u postgres psql</span></code></pre></div>
<p>Create a database named <code>gisdb</code> and enable extensions:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb514-1"><a href="setting-up-an-sql-api.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> gisdb;</span>
<span id="cb514-2"><a href="setting-up-an-sql-api.html#cb514-2" aria-hidden="true" tabindex="-1"></a>\<span class="kw">connect</span> gisdb;</span>
<span id="cb514-3"><a href="setting-up-an-sql-api.html#cb514-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-4"><a href="setting-up-an-sql-api.html#cb514-4" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">SCHEMA</span> postgis;</span>
<span id="cb514-5"><a href="setting-up-an-sql-api.html#cb514-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">DATABASE</span> gisdb <span class="kw">SET</span> search_path<span class="op">=</span><span class="kw">public</span>, postgis, contrib;</span>
<span id="cb514-6"><a href="setting-up-an-sql-api.html#cb514-6" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> EXTENSION postgis <span class="kw">SCHEMA</span> postgis;</span>
<span id="cb514-7"><a href="setting-up-an-sql-api.html#cb514-7" aria-hidden="true" tabindex="-1"></a>\q</span></code></pre></div>
<p>To enable remote connections to the database we need to do the following.</p>
<p>Log in:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb515-1"><a href="setting-up-an-sql-api.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> -u postgres psql</span></code></pre></div>
<p>then:</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb516-1"><a href="setting-up-an-sql-api.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">SYSTEM</span> <span class="kw">SET</span> listen_addresses<span class="op">=</span><span class="st">&#39;*&#39;</span>;</span>
<span id="cb516-2"><a href="setting-up-an-sql-api.html#cb516-2" aria-hidden="true" tabindex="-1"></a>\q</span></code></pre></div>
<p>Edit the <code>pg_hba.conf</code> file:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb517-1"><a href="setting-up-an-sql-api.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/postgresql/12/main/pg_hba.conf</span></code></pre></div>
<p>Scroll to the bottom of the <code>pg_hba.conf</code> file and add a line like this (right after the local rules):</p>
<pre class="text"><code>hostssl    all             all             0.0.0.0/0               md5</code></pre>
<p>Press <strong>Ctrl+X</strong> to save your changes, then <strong>Y</strong> to write them to the file, and <strong>Enter</strong> to exit.</p>
<p>Restart PostgreSQL:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb519-1"><a href="setting-up-an-sql-api.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> service postgresql restart </span></code></pre></div>
<p>Log in:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb520-1"><a href="setting-up-an-sql-api.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> -u postgres psql</span></code></pre></div>
<p>Create a superuser:</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb521-1"><a href="setting-up-an-sql-api.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">ROLE</span> mysuperuser LOGIN <span class="kw">PASSWORD</span> <span class="st">&#39;whatever&#39;</span> SUPERUSER;</span>
<span id="cb521-2"><a href="setting-up-an-sql-api.html#cb521-2" aria-hidden="true" tabindex="-1"></a>\q</span></code></pre></div>
<p>Log in as the new user:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb522-1"><a href="setting-up-an-sql-api.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="ex">psql</span> -h localhost -U mysuperuser gisdb</span></code></pre></div>
<p>And setup PostGIS:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb523-1"><a href="setting-up-an-sql-api.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="ex">CREATE</span> EXTENSION postgis<span class="kw">;</span></span></code></pre></div>
<p>Try running a spatial query to see if PostGIS is operational:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb524-1"><a href="setting-up-an-sql-api.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb524-2"><a href="setting-up-an-sql-api.html#cb524-2" aria-hidden="true" tabindex="-1"></a>  (ST_SetSRID(ST_MakePoint(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">4326</span>):<span class="ch">:geography</span> <span class="op">&lt;-&gt;</span></span>
<span id="cb524-3"><a href="setting-up-an-sql-api.html#cb524-3" aria-hidden="true" tabindex="-1"></a>  ST_SetSRID(ST_MakePoint(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">4326</span>):<span class="ch">:geography</span>) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb524-4"><a href="setting-up-an-sql-api.html#cb524-4" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span> dist_km;</span></code></pre></div>
</div>
<div id="loading-data-into-the-database" class="section level2" number="21.4">
<h2><span class="header-section-number">H.4</span> Loading data into the database</h2>
<p>Now that the database is set, you need to add some data. There are many ways to do that. We will use <a href="https://www.r-project.org/">R</a>.</p>
<p>Assuming R is installed, open the R console on a <em>different</em> computer, the one with data you want to insert into the database:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb525-1"><a href="setting-up-an-sql-api.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span></span></code></pre></div>
<p>Read the <code>plants.geojson</code> file (<a href="examples/data/plants.geojson" download>download</a>) and import it to the database from R using the following script:</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="setting-up-an-sql-api.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb526-2"><a href="setting-up-an-sql-api.html#cb526-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RPostgreSQL) </span>
<span id="cb526-3"><a href="setting-up-an-sql-api.html#cb526-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-4"><a href="setting-up-an-sql-api.html#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect</span></span>
<span id="cb526-5"><a href="setting-up-an-sql-api.html#cb526-5" aria-hidden="true" tabindex="-1"></a>con <span class="ot">=</span> <span class="fu">dbConnect</span>(</span>
<span id="cb526-6"><a href="setting-up-an-sql-api.html#cb526-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PostgreSQL</span>(), </span>
<span id="cb526-7"><a href="setting-up-an-sql-api.html#cb526-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbname =</span> <span class="st">&quot;gisdb&quot;</span>, </span>
<span id="cb526-8"><a href="setting-up-an-sql-api.html#cb526-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">host =</span> <span class="st">&quot;157.230.21.4&quot;</span>, </span>
<span id="cb526-9"><a href="setting-up-an-sql-api.html#cb526-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">port =</span> <span class="dv">5432</span>, </span>
<span id="cb526-10"><a href="setting-up-an-sql-api.html#cb526-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">user =</span> <span class="st">&quot;mysuperuser&quot;</span>, </span>
<span id="cb526-11"><a href="setting-up-an-sql-api.html#cb526-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">password =</span> <span class="st">&quot;whatever&quot;</span></span>
<span id="cb526-12"><a href="setting-up-an-sql-api.html#cb526-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb526-13"><a href="setting-up-an-sql-api.html#cb526-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-14"><a href="setting-up-an-sql-api.html#cb526-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Import table to database</span></span>
<span id="cb526-15"><a href="setting-up-an-sql-api.html#cb526-15" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">&quot;plants.geojson&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb526-16"><a href="setting-up-an-sql-api.html#cb526-16" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> dat, <span class="at">dsn =</span> con, <span class="at">layer =</span> <span class="st">&quot;plants&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb526-17"><a href="setting-up-an-sql-api.html#cb526-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-18"><a href="setting-up-an-sql-api.html#cb526-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Disconnect</span></span>
<span id="cb526-19"><a href="setting-up-an-sql-api.html#cb526-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code></pre></div>
<p>Let’s test if the database works properly.</p>
<p>Log in to the database:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb527-1"><a href="setting-up-an-sql-api.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="ex">psql</span> -h localhost -U mysuperuser gisdb</span></code></pre></div>
<p>Then run the following query:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb528-1"><a href="setting-up-an-sql-api.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">id</span>, name_lat, ST_AsText(geometry) <span class="kw">FROM</span> plants <span class="kw">LIMIT</span> <span class="dv">5</span>;</span></code></pre></div>
<p>If all works well, you should see a result such as the following (Figure <a href="setting-up-an-sql-api.html#fig:digitalocean-check-database">H.3</a>):</p>
<pre class="text"><code>   id   |    name_lat    |         st_astext          
--------+----------------+----------------------------
 321432 | Iris haynei    | POINT(35.679761 32.770133)
 321433 | Iris haynei    | POINT(35.654005 32.741372)
 321456 | Iris atrofusca | POINT(35.193367 31.44711)
 321457 | Iris atrofusca | POINT(35.189142 31.514754)
 321459 | Iris vartanii  | POINT(35.139696 31.474149)
(5 rows)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:digitalocean-check-database"></span>
<img src="images/digitalocean_check_database.png" alt="PostGIS database query example" width="100%" />
<p class="caption">
FIGURE H.3: PostGIS database query example
</p>
</div>
</div>
<div id="adding-read-only-database-user" class="section level2" number="21.5">
<h2><span class="header-section-number">H.5</span> Adding a read-only database user</h2>
<p>To make sure users cannot do harmful changes in the database through the SQL API, it is useful to create a read-only user.</p>
<p>Log in to database:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb530-1"><a href="setting-up-an-sql-api.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="ex">psql</span> -h localhost -U mysuperuser gisdb</span></code></pre></div>
<div class="sourceCode" id="cb531"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb531-1"><a href="setting-up-an-sql-api.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">ROLE</span> readonlyuser <span class="kw">WITH</span> LOGIN <span class="kw">PASSWORD</span> <span class="st">&#39;whatever2&#39;</span> </span>
<span id="cb531-2"><a href="setting-up-an-sql-api.html#cb531-2" aria-hidden="true" tabindex="-1"></a>NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE NOREPLICATION VALID <span class="kw">UNTIL</span> <span class="st">&#39;infinity&#39;</span>;</span></code></pre></div>
<p>Assign permission to this read only user:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb532-1"><a href="setting-up-an-sql-api.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">CONNECT</span> <span class="kw">ON</span> <span class="kw">DATABASE</span> gisdb <span class="kw">TO</span> readonlyuser;</span>
<span id="cb532-2"><a href="setting-up-an-sql-api.html#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">USAGE</span> <span class="kw">ON</span> <span class="kw">SCHEMA</span> <span class="kw">public</span> <span class="kw">TO</span> readonlyuser;</span>
<span id="cb532-3"><a href="setting-up-an-sql-api.html#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">ALL</span> <span class="kw">TABLES</span> <span class="kw">IN</span> <span class="kw">SCHEMA</span> <span class="kw">public</span> <span class="kw">TO</span> readonlyuser;</span>
<span id="cb532-4"><a href="setting-up-an-sql-api.html#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">ALL</span> SEQUENCES <span class="kw">IN</span> <span class="kw">SCHEMA</span> <span class="kw">public</span> <span class="kw">TO</span> readonlyuser;</span></code></pre></div>
<p>Possibly need to <a href="https://serverfault.com/questions/60500/crate-a-new-read-only-user-in-postgres">update search path</a>:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb533-1"><a href="setting-up-an-sql-api.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> e.extname,n.<span class="op">*</span> </span>
<span id="cb533-2"><a href="setting-up-an-sql-api.html#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> pg_extension e, pg_namespace n </span>
<span id="cb533-3"><a href="setting-up-an-sql-api.html#cb533-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> e.extnamespace <span class="op">=</span> n.<span class="kw">oid</span> <span class="kw">and</span> e.extname<span class="op">=</span><span class="st">&#39;postgis&#39;</span>;</span></code></pre></div>
<div class="sourceCode" id="cb534"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb534-1"><a href="setting-up-an-sql-api.html#cb534-1" aria-hidden="true" tabindex="-1"></a>show search_path;</span></code></pre></div>
<div class="sourceCode" id="cb535"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb535-1"><a href="setting-up-an-sql-api.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="fu">USER</span> readonlyuser <span class="kw">SET</span> search_path <span class="kw">TO</span> <span class="ot">&quot;$user&quot;</span>, <span class="kw">public</span>, postgis;</span></code></pre></div>
<p>And/or <a href="https://postgis.net/2017/11/07/tip-move-postgis-schema/">move</a> the postgis extension to schema <code>postgis</code>:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb536-1"><a href="setting-up-an-sql-api.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">DATABASE</span> gisdb <span class="kw">SET</span> <span class="ot">&quot;search_path&quot;</span> <span class="op">=</span> <span class="kw">public</span>,postgis;</span>
<span id="cb536-2"><a href="setting-up-an-sql-api.html#cb536-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-3"><a href="setting-up-an-sql-api.html#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> EXTENSION postgis <span class="kw">SET</span> <span class="kw">SCHEMA</span> postgis;</span>
<span id="cb536-4"><a href="setting-up-an-sql-api.html#cb536-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-5"><a href="setting-up-an-sql-api.html#cb536-5" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> pg_extension <span class="kw">SET</span> extrelocatable <span class="op">=</span> <span class="kw">TRUE</span> <span class="kw">WHERE</span> extname <span class="op">=</span> <span class="st">&#39;postgis&#39;</span>;</span>
<span id="cb536-6"><a href="setting-up-an-sql-api.html#cb536-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb536-7"><a href="setting-up-an-sql-api.html#cb536-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> EXTENSION postgis <span class="kw">SET</span> <span class="kw">SCHEMA</span> <span class="kw">public</span>;</span>
<span id="cb536-8"><a href="setting-up-an-sql-api.html#cb536-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-9"><a href="setting-up-an-sql-api.html#cb536-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">USAGE</span> <span class="kw">ON</span> <span class="kw">SCHEMA</span> postgis <span class="kw">TO</span> readonlyuser;</span>
<span id="cb536-10"><a href="setting-up-an-sql-api.html#cb536-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-11"><a href="setting-up-an-sql-api.html#cb536-11" aria-hidden="true" tabindex="-1"></a>\q</span></code></pre></div>
<p>Now, connect as the new user:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb537-1"><a href="setting-up-an-sql-api.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="ex">psql</span> -h localhost -U readonlyuser gisdb</span></code></pre></div>
<p>and try:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb538-1"><a href="setting-up-an-sql-api.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> plants;</span></code></pre></div>
<p>If all works well, you should see an error:</p>
<pre class="text"><code>ERROR:  must be owner of relation plants</code></pre>
<p>Also try:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb540-1"><a href="setting-up-an-sql-api.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> plants <span class="kw">WHERE</span> name_lat<span class="op">=</span><span class="st">&#39;Iris haynei&#39;</span>;</span></code></pre></div>
<p>And you should see:</p>
<pre class="text"><code>ERROR:  permission denied for relation plants</code></pre>
</div>
<div id="installing-nodejs-and-required-modules" class="section level2" number="21.6">
<h2><span class="header-section-number">H.6</span> Installing Node.js and required modules</h2>
<p>Next, we need to install <strong>Node.js</strong>. The DigitalOcean <a href="https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-ubuntu-18-04"><strong>tutorial</strong></a> can be consulted.</p>
<p>Run the following commands to get the required packages:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb542-1"><a href="setting-up-an-sql-api.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span>
<span id="cb542-2"><a href="setting-up-an-sql-api.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install nodejs</span>
<span id="cb542-3"><a href="setting-up-an-sql-api.html#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install npm</span></code></pre></div>
<p>Check that Node.js is installed with the following command, which should print the installed version:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb543-1"><a href="setting-up-an-sql-api.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="ex">nodejs</span> -v</span></code></pre></div>
<p>We will use a Node.js script to create an SQL API for our database.</p>
<p>This is based on the <a href="https://chriswhong.com/data-visualization/introducing-postgis-preview/"><strong>postgis-preview example</strong></a>.</p>
<p>Create a new folder for your server app. Run the following commands to initialize the server and download the required dependencies:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb544-1"><a href="setting-up-an-sql-api.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> node</span>
<span id="cb544-2"><a href="setting-up-an-sql-api.html#cb544-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> node</span></code></pre></div>
<div class="sourceCode" id="cb545"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb545-1"><a href="setting-up-an-sql-api.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> init</span>
<span id="cb545-2"><a href="setting-up-an-sql-api.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install express --save</span>
<span id="cb545-3"><a href="setting-up-an-sql-api.html#cb545-3" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install pg-promise --save</span>
<span id="cb545-4"><a href="setting-up-an-sql-api.html#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install dbgeo --save</span></code></pre></div>
<p>Now, inside the directory create a new file named <code>index.js</code> with:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb546-1"><a href="setting-up-an-sql-api.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> index.js</span></code></pre></div>
<p>Then paste the following Node.js script for the SQL API inside it:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb547-1"><a href="setting-up-an-sql-api.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dependencies</span></span>
<span id="cb547-2"><a href="setting-up-an-sql-api.html#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">,</span></span>
<span id="cb547-3"><a href="setting-up-an-sql-api.html#cb547-3" aria-hidden="true" tabindex="-1"></a>    pgp <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;pg-promise&quot;</span>)()<span class="op">,</span></span>
<span id="cb547-4"><a href="setting-up-an-sql-api.html#cb547-4" aria-hidden="true" tabindex="-1"></a>    dbgeo <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;dbgeo&quot;</span>)<span class="op">;</span></span>
<span id="cb547-5"><a href="setting-up-an-sql-api.html#cb547-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb547-6"><a href="setting-up-an-sql-api.html#cb547-6" aria-hidden="true" tabindex="-1"></a><span class="co">// CORS</span></span>
<span id="cb547-7"><a href="setting-up-an-sql-api.html#cb547-7" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> allowCrossDomain <span class="op">=</span> <span class="kw">function</span>(req<span class="op">,</span> res<span class="op">,</span> next) {</span>
<span id="cb547-8"><a href="setting-up-an-sql-api.html#cb547-8" aria-hidden="true" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">header</span>(<span class="st">&quot;Access-Control-Allow-Origin&quot;</span><span class="op">,</span> <span class="st">&quot;*&quot;</span>)<span class="op">;</span></span>
<span id="cb547-9"><a href="setting-up-an-sql-api.html#cb547-9" aria-hidden="true" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">header</span>(<span class="st">&quot;Access-Control-Allow-Methods&quot;</span><span class="op">,</span> <span class="st">&quot;GET&quot;</span>)<span class="op">;</span></span>
<span id="cb547-10"><a href="setting-up-an-sql-api.html#cb547-10" aria-hidden="true" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">header</span>(<span class="st">&quot;Access-Control-Allow-Headers&quot;</span><span class="op">,</span> <span class="st">&quot;Content-Type&quot;</span>)<span class="op">;</span></span>
<span id="cb547-11"><a href="setting-up-an-sql-api.html#cb547-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb547-12"><a href="setting-up-an-sql-api.html#cb547-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb547-13"><a href="setting-up-an-sql-api.html#cb547-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-14"><a href="setting-up-an-sql-api.html#cb547-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Create express app and prepare db connection</span></span>
<span id="cb547-15"><a href="setting-up-an-sql-api.html#cb547-15" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> app <span class="op">=</span> <span class="fu">express</span>()<span class="op">;</span></span>
<span id="cb547-16"><a href="setting-up-an-sql-api.html#cb547-16" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> port <span class="op">=</span> <span class="dv">4000</span><span class="op">;</span></span>
<span id="cb547-17"><a href="setting-up-an-sql-api.html#cb547-17" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> connectionString <span class="op">=</span> <span class="st">&quot;postgres://readonlyuser:whatever2@localhost:5432/gisdb&quot;</span><span class="op">;</span></span>
<span id="cb547-18"><a href="setting-up-an-sql-api.html#cb547-18" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> db <span class="op">=</span> <span class="fu">pgp</span>(connectionString)<span class="op">;</span></span>
<span id="cb547-19"><a href="setting-up-an-sql-api.html#cb547-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-20"><a href="setting-up-an-sql-api.html#cb547-20" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(allowCrossDomain)<span class="op">;</span></span>
<span id="cb547-21"><a href="setting-up-an-sql-api.html#cb547-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-22"><a href="setting-up-an-sql-api.html#cb547-22" aria-hidden="true" tabindex="-1"></a><span class="co">// Expose sql endpoint, grab query as URL parameter and send it to the database</span></span>
<span id="cb547-23"><a href="setting-up-an-sql-api.html#cb547-23" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">get</span>(<span class="st">&quot;/sql&quot;</span><span class="op">,</span> <span class="kw">function</span> (req<span class="op">,</span> res) {</span>
<span id="cb547-24"><a href="setting-up-an-sql-api.html#cb547-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> sql <span class="op">=</span> req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">q</span><span class="op">;</span></span>
<span id="cb547-25"><a href="setting-up-an-sql-api.html#cb547-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Executing SQL: &quot;</span> <span class="op">+</span> sql)<span class="op">;</span></span>
<span id="cb547-26"><a href="setting-up-an-sql-api.html#cb547-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-27"><a href="setting-up-an-sql-api.html#cb547-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//query using pg-promise</span></span>
<span id="cb547-28"><a href="setting-up-an-sql-api.html#cb547-28" aria-hidden="true" tabindex="-1"></a>    db<span class="op">.</span><span class="fu">any</span>(sql)</span>
<span id="cb547-29"><a href="setting-up-an-sql-api.html#cb547-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span> (data) { <span class="co">//use dbgeo to convert WKB from PostGIS into topojson</span></span>
<span id="cb547-30"><a href="setting-up-an-sql-api.html#cb547-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">dbGeoParse</span>(data)<span class="op">;</span></span>
<span id="cb547-31"><a href="setting-up-an-sql-api.html#cb547-31" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb547-32"><a href="setting-up-an-sql-api.html#cb547-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span> (data) {</span>
<span id="cb547-33"><a href="setting-up-an-sql-api.html#cb547-33" aria-hidden="true" tabindex="-1"></a>            res<span class="op">.</span><span class="fu">send</span>(data)<span class="op">;</span></span>
<span id="cb547-34"><a href="setting-up-an-sql-api.html#cb547-34" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb547-35"><a href="setting-up-an-sql-api.html#cb547-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">catch</span>(<span class="kw">function</span> (err) { <span class="co">//send the error message if the query didn&#39;t work</span></span>
<span id="cb547-36"><a href="setting-up-an-sql-api.html#cb547-36" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> msg <span class="op">=</span> err<span class="op">.</span><span class="at">message</span> <span class="op">||</span> err<span class="op">;</span></span>
<span id="cb547-37"><a href="setting-up-an-sql-api.html#cb547-37" aria-hidden="true" tabindex="-1"></a>            <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;ERROR:&quot;</span><span class="op">,</span> msg)<span class="op">;</span></span>
<span id="cb547-38"><a href="setting-up-an-sql-api.html#cb547-38" aria-hidden="true" tabindex="-1"></a>            res<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb547-39"><a href="setting-up-an-sql-api.html#cb547-39" aria-hidden="true" tabindex="-1"></a>                <span class="dt">error</span><span class="op">:</span> msg</span>
<span id="cb547-40"><a href="setting-up-an-sql-api.html#cb547-40" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb547-41"><a href="setting-up-an-sql-api.html#cb547-41" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb547-42"><a href="setting-up-an-sql-api.html#cb547-42" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb547-43"><a href="setting-up-an-sql-api.html#cb547-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-44"><a href="setting-up-an-sql-api.html#cb547-44" aria-hidden="true" tabindex="-1"></a><span class="co">// Parse to GeoJSON</span></span>
<span id="cb547-45"><a href="setting-up-an-sql-api.html#cb547-45" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dbGeoParse</span>(data) {</span>
<span id="cb547-46"><a href="setting-up-an-sql-api.html#cb547-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>(<span class="kw">function</span> (resolve<span class="op">,</span> reject) {</span>
<span id="cb547-47"><a href="setting-up-an-sql-api.html#cb547-47" aria-hidden="true" tabindex="-1"></a>        dbgeo<span class="op">.</span><span class="fu">parse</span>(data<span class="op">,</span> {</span>
<span id="cb547-48"><a href="setting-up-an-sql-api.html#cb547-48" aria-hidden="true" tabindex="-1"></a>            <span class="dt">outputFormat</span><span class="op">:</span> <span class="st">&quot;geojson&quot;</span></span>
<span id="cb547-49"><a href="setting-up-an-sql-api.html#cb547-49" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> result) {</span>
<span id="cb547-50"><a href="setting-up-an-sql-api.html#cb547-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(err) {</span>
<span id="cb547-51"><a href="setting-up-an-sql-api.html#cb547-51" aria-hidden="true" tabindex="-1"></a>                <span class="fu">reject</span>(err)<span class="op">;</span></span>
<span id="cb547-52"><a href="setting-up-an-sql-api.html#cb547-52" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb547-53"><a href="setting-up-an-sql-api.html#cb547-53" aria-hidden="true" tabindex="-1"></a>                <span class="fu">resolve</span>(result)<span class="op">;</span></span>
<span id="cb547-54"><a href="setting-up-an-sql-api.html#cb547-54" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb547-55"><a href="setting-up-an-sql-api.html#cb547-55" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb547-56"><a href="setting-up-an-sql-api.html#cb547-56" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb547-57"><a href="setting-up-an-sql-api.html#cb547-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb547-58"><a href="setting-up-an-sql-api.html#cb547-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-59"><a href="setting-up-an-sql-api.html#cb547-59" aria-hidden="true" tabindex="-1"></a><span class="co">// Start the server</span></span>
<span id="cb547-60"><a href="setting-up-an-sql-api.html#cb547-60" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> server <span class="op">=</span> app<span class="op">.</span><span class="fu">listen</span>(port<span class="op">,</span> <span class="st">&quot;0.0.0.0&quot;</span><span class="op">,</span> <span class="kw">function</span> () {</span>
<span id="cb547-61"><a href="setting-up-an-sql-api.html#cb547-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> host <span class="op">=</span> server<span class="op">.</span><span class="fu">address</span>()<span class="op">.</span><span class="at">address</span><span class="op">;</span></span>
<span id="cb547-62"><a href="setting-up-an-sql-api.html#cb547-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> port <span class="op">=</span> server<span class="op">.</span><span class="fu">address</span>()<span class="op">.</span><span class="at">port</span><span class="op">;</span></span>
<span id="cb547-63"><a href="setting-up-an-sql-api.html#cb547-63" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;App listening at http://%s:%s&quot;</span><span class="op">,</span> host<span class="op">,</span> port)<span class="op">;</span></span>
<span id="cb547-64"><a href="setting-up-an-sql-api.html#cb547-64" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>While still inside the directory, type the following command to start the server:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb548-1"><a href="setting-up-an-sql-api.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> index.js</span></code></pre></div>
</div>
<div id="creating-a-service" class="section level2" number="21.7">
<h2><span class="header-section-number">H.7</span> Creating a service</h2>
<p>To run the server indefinitely, forcing startup when errors are raised or when the server reboots, you need to create a <em>service</em>. This can be done using <code>systemd</code>, which is installed by default on Ubuntu. First create a service file, such as <code>index.service</code>, with contents such as follows:</p>
<pre class="text"><code>[Service]
ExecStart=/usr/bin/node /home/michael/index.js
Restart=always
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=index
User=michael
Group=nogroup
Environment=NODE_ENV=production
WorkingDirectory=/home/michael/

[Install]
WantedBy=multi-user.target</code></pre>
<p>Note that <code>ExecStart</code> is composed of the <code>node</code> executable and the path to the application <code>.js</code> file.</p>
<p>Copy the <code>index.service</code> file to <code>/etc/systemd/system/</code>:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb550-1"><a href="setting-up-an-sql-api.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> cp index.service /etc/systemd/system/</span></code></pre></div>
<p>Then, start the service:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb551-1"><a href="setting-up-an-sql-api.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> enable index</span>
<span id="cb551-2"><a href="setting-up-an-sql-api.html#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start index</span></code></pre></div>
<p>You can check the service status with:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb552-1"><a href="setting-up-an-sql-api.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> status index</span></code></pre></div>
<p>and print the logs with:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb553-1"><a href="setting-up-an-sql-api.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="ex">journalctl</span> -u index</span></code></pre></div>
</div>
<div id="testing-the-sql-api" class="section level2" number="21.8">
<h2><span class="header-section-number">H.8</span> Testing the SQL API</h2>
<p>Enter the following URL in your browser:</p>
<pre><code>http://157.230.21.4:4000/sql?q=select id, name_lat, geometry AS geom from plants limit 2</code></pre>
<p>If the SQL API is working properly, you should see the following GeoJSON content in the response (Figure <a href="setting-up-an-sql-api.html#fig:digitalocean-testing-api-in-browser">H.4</a>). At the same time you should see a message in the Node.js server log (Figure <a href="setting-up-an-sql-api.html#fig:digitalocean-node-server-log">H.5</a>).</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb555-1"><a href="setting-up-an-sql-api.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb555-2"><a href="setting-up-an-sql-api.html#cb555-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;FeatureCollection&quot;</span><span class="fu">,</span></span>
<span id="cb555-3"><a href="setting-up-an-sql-api.html#cb555-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;features&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb555-4"><a href="setting-up-an-sql-api.html#cb555-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb555-5"><a href="setting-up-an-sql-api.html#cb555-5" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;Feature&quot;</span><span class="fu">,</span></span>
<span id="cb555-6"><a href="setting-up-an-sql-api.html#cb555-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;geometry&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb555-7"><a href="setting-up-an-sql-api.html#cb555-7" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;Point&quot;</span><span class="fu">,</span></span>
<span id="cb555-8"><a href="setting-up-an-sql-api.html#cb555-8" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;coordinates&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb555-9"><a href="setting-up-an-sql-api.html#cb555-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">35.679761</span><span class="ot">,</span></span>
<span id="cb555-10"><a href="setting-up-an-sql-api.html#cb555-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">32.770133</span></span>
<span id="cb555-11"><a href="setting-up-an-sql-api.html#cb555-11" aria-hidden="true" tabindex="-1"></a>                <span class="ot">]</span></span>
<span id="cb555-12"><a href="setting-up-an-sql-api.html#cb555-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">},</span></span>
<span id="cb555-13"><a href="setting-up-an-sql-api.html#cb555-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb555-14"><a href="setting-up-an-sql-api.html#cb555-14" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">321432</span><span class="fu">,</span></span>
<span id="cb555-15"><a href="setting-up-an-sql-api.html#cb555-15" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;name_lat&quot;</span><span class="fu">:</span> <span class="st">&quot;Iris haynei&quot;</span></span>
<span id="cb555-16"><a href="setting-up-an-sql-api.html#cb555-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">}</span></span>
<span id="cb555-17"><a href="setting-up-an-sql-api.html#cb555-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb555-18"><a href="setting-up-an-sql-api.html#cb555-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb555-19"><a href="setting-up-an-sql-api.html#cb555-19" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;Feature&quot;</span><span class="fu">,</span></span>
<span id="cb555-20"><a href="setting-up-an-sql-api.html#cb555-20" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;geometry&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb555-21"><a href="setting-up-an-sql-api.html#cb555-21" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;Point&quot;</span><span class="fu">,</span></span>
<span id="cb555-22"><a href="setting-up-an-sql-api.html#cb555-22" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;coordinates&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb555-23"><a href="setting-up-an-sql-api.html#cb555-23" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">35.654005</span><span class="ot">,</span></span>
<span id="cb555-24"><a href="setting-up-an-sql-api.html#cb555-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">32.741372</span></span>
<span id="cb555-25"><a href="setting-up-an-sql-api.html#cb555-25" aria-hidden="true" tabindex="-1"></a>                <span class="ot">]</span></span>
<span id="cb555-26"><a href="setting-up-an-sql-api.html#cb555-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">},</span></span>
<span id="cb555-27"><a href="setting-up-an-sql-api.html#cb555-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb555-28"><a href="setting-up-an-sql-api.html#cb555-28" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">321433</span><span class="fu">,</span></span>
<span id="cb555-29"><a href="setting-up-an-sql-api.html#cb555-29" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&quot;name_lat&quot;</span><span class="fu">:</span> <span class="st">&quot;Iris haynei&quot;</span></span>
<span id="cb555-30"><a href="setting-up-an-sql-api.html#cb555-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">}</span></span>
<span id="cb555-31"><a href="setting-up-an-sql-api.html#cb555-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb555-32"><a href="setting-up-an-sql-api.html#cb555-32" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb555-33"><a href="setting-up-an-sql-api.html#cb555-33" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:digitalocean-testing-api-in-browser"></span>
<img src="images/digitalocean_testing_api_in_browser.png" alt="Testing the SQL API in the browser" width="100%" />
<p class="caption">
FIGURE H.4: Testing the SQL API in the browser
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:digitalocean-node-server-log"></span>
<img src="images/digitalocean_node_server_log.png" alt="Node.js server log" width="100%" />
<p class="caption">
FIGURE H.5: Node.js server log
</p>
</div>
<p>This setup is sufficient to reproduce the examples from Chapters <a href="databases.html#databases">9</a>–<a href="spatial-queries-1.html#spatial-queries-1">11</a>, where the SQL API is being used to query the <code>plants</code> table from within a Leaflet map in several ways.</p>
<p>For reproducing the examples in Chapter <a href="collaborative-mapping.html#collaborative-mapping">13</a>, you need to create the additional table <code>beer_sheva</code> as instructed in Section <a href="collaborative-mapping.html#setting-database-permissions">13.6.1</a>, with few modifications:</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb556-1"><a href="setting-up-an-sql-api.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> beer_sheva(</span>
<span id="cb556-2"><a href="setting-up-an-sql-api.html#cb556-2" aria-hidden="true" tabindex="-1"></a>    geom geometry,</span>
<span id="cb556-3"><a href="setting-up-an-sql-api.html#cb556-3" aria-hidden="true" tabindex="-1"></a>    description text,</span>
<span id="cb556-4"><a href="setting-up-an-sql-api.html#cb556-4" aria-hidden="true" tabindex="-1"></a>    name text</span>
<span id="cb556-5"><a href="setting-up-an-sql-api.html#cb556-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb556-6"><a href="setting-up-an-sql-api.html#cb556-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-7"><a href="setting-up-an-sql-api.html#cb556-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">INSERT</span> (geom, description, name) </span>
<span id="cb556-8"><a href="setting-up-an-sql-api.html#cb556-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> beer_sheva </span>
<span id="cb556-9"><a href="setting-up-an-sql-api.html#cb556-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">TO</span> readonlyuser;</span>
<span id="cb556-10"><a href="setting-up-an-sql-api.html#cb556-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-11"><a href="setting-up-an-sql-api.html#cb556-11" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> beer_sheva <span class="kw">TO</span> readonlyuser;</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="additional-questions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="setting-up-a-static-server-using-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 2,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "../../mathjax.rstudio.com/2.7.2/MathJaxb198.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>


<!-- Mirrored from 132.72.155.230:3838/js/setting-up-an-sql-api.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Jan 2022 07:01:34 GMT -->
</html>
